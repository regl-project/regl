var $jscomp={scope:{},getGlobal:function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global?global:b}};$jscomp.global=$jscomp.getGlobal(this);$jscomp.initSymbol=function(){$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol);$jscomp.initSymbol=function(){}};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(b){return"jscomp_symbol_"+b+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();$jscomp.global.Symbol.iterator||($jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));$jscomp.initSymbolIterator=function(){}};$jscomp.makeIterator=function(b){$jscomp.initSymbolIterator();if(b[$jscomp.global.Symbol.iterator])return b[$jscomp.global.Symbol.iterator]();var h=0;return{next:function(){return h==b.length?{done:!0}:{done:!1,value:b[h++]}}}};
$jscomp.arrayFromIterator=function(b){for(var h,q=[];!(h=b.next()).done;)q.push(h.value);return q};$jscomp.arrayFromIterable=function(b){return b instanceof Array?b:$jscomp.arrayFromIterator($jscomp.makeIterator(b))};
$jscomp.inherits=function(b,h){function q(){}q.prototype=h.prototype;b.prototype=new q;b.prototype.constructor=b;for(var t in h)if($jscomp.global.Object.defineProperties){var r=$jscomp.global.Object.getOwnPropertyDescriptor(h,t);r&&$jscomp.global.Object.defineProperty(b,t,r)}else b[t]=h[t]};$jscomp.array=$jscomp.array||{};$jscomp.array.done_=function(){return{done:!0,value:void 0}};
$jscomp.array.arrayIterator_=function(b,h){b instanceof String&&(b=String(b));var q=0;$jscomp.initSymbol();$jscomp.initSymbolIterator();var t={},r=(t.next=function(){if(q<b.length){var e=q++;return{value:h(e,b[e]),done:!1}}r.next=$jscomp.array.done_;return $jscomp.array.done_()},t[Symbol.iterator]=function(){return r},t);return r};
$jscomp.array.findInternal_=function(b,h,q){b instanceof String&&(b=String(b));for(var t=b.length,r=0;r<t;r++){var e=b[r];if(h.call(q,e,r,b))return{i:r,v:e}}return{i:-1,v:void 0}};
$jscomp.array.from=function(b,h,q){h=void 0===h?function(e){return e}:h;var t=[];$jscomp.initSymbol();$jscomp.initSymbolIterator();if(b[Symbol.iterator]){$jscomp.initSymbol();$jscomp.initSymbolIterator();b=b[Symbol.iterator]();for(var r;!(r=b.next()).done;)t.push(h.call(q,r.value))}else{r=b.length;for(var e=0;e<r;e++)t.push(h.call(q,b[e]))}return t};$jscomp.array.of=function(b){for(var h=[],q=0;q<arguments.length;++q)h[q-0]=arguments[q];return $jscomp.array.from(h)};
$jscomp.array.entries=function(){return $jscomp.array.arrayIterator_(this,function(b,h){return[b,h]})};$jscomp.array.entries$install=function(){Array.prototype.entries||(Array.prototype.entries=$jscomp.array.entries)};$jscomp.array.keys=function(){return $jscomp.array.arrayIterator_(this,function(b){return b})};$jscomp.array.keys$install=function(){Array.prototype.keys||(Array.prototype.keys=$jscomp.array.keys)};$jscomp.array.values=function(){return $jscomp.array.arrayIterator_(this,function(b,h){return h})};
$jscomp.array.values$install=function(){Array.prototype.values||(Array.prototype.values=$jscomp.array.values)};$jscomp.array.copyWithin=function(b,h,q){var t=this.length;b=Number(b);h=Number(h);q=Number(null!=q?q:t);if(b<h)for(q=Math.min(q,t);h<q;)h in this?this[b++]=this[h++]:(delete this[b++],h++);else for(q=Math.min(q,t+h-b),b+=q-h;q>h;)--q in this?this[--b]=this[q]:delete this[b];return this};$jscomp.array.copyWithin$install=function(){Array.prototype.copyWithin||(Array.prototype.copyWithin=$jscomp.array.copyWithin)};
$jscomp.array.fill=function(b,h,q){null!=q&&b.length||(q=this.length||0);q=Number(q);for(h=Number((void 0===h?0:h)||0);h<q;h++)this[h]=b;return this};$jscomp.array.fill$install=function(){Array.prototype.fill||(Array.prototype.fill=$jscomp.array.fill)};$jscomp.array.find=function(b,h){return $jscomp.array.findInternal_(this,b,h).v};$jscomp.array.find$install=function(){Array.prototype.find||(Array.prototype.find=$jscomp.array.find)};
$jscomp.array.findIndex=function(b,h){return $jscomp.array.findInternal_(this,b,h).i};$jscomp.array.findIndex$install=function(){Array.prototype.findIndex||(Array.prototype.findIndex=$jscomp.array.findIndex)};$jscomp.Map=function(b){b=void 0===b?[]:b;this.data_={};this.head_=$jscomp.Map.createHead_();this.size=0;if(b){b=$jscomp.makeIterator(b);for(var h=b.next();!h.done;h=b.next())h=h.value,this.set(h[0],h[1])}};
$jscomp.Map.checkBrowserConformance_=function(){var b=$jscomp.global.Map;if(!b||!b.prototype.entries||!Object.seal)return!1;try{var h=Object.seal({x:4}),q=new b($jscomp.makeIterator([[h,"s"]]));if("s"!=q.get(h)||1!=q.size||q.get({x:4})||q.set({x:4},"t")!=q||2!=q.size)return!1;var t=q.entries(),r=t.next();if(r.done||r.value[0]!=h||"s"!=r.value[1])return!1;r=t.next();return r.done||4!=r.value[0].x||"t"!=r.value[1]||!t.next().done?!1:!0}catch(e){return!1}};
$jscomp.Map.createHead_=function(){var b={};return b.previous=b.next=b.head=b};$jscomp.Map.getId_=function(b){if(!(b instanceof Object))return String(b);$jscomp.Map.key_ in b||b instanceof Object&&Object.isExtensible&&Object.isExtensible(b)&&$jscomp.Map.defineProperty_(b,$jscomp.Map.key_,++$jscomp.Map.index_);return $jscomp.Map.key_ in b?b[$jscomp.Map.key_]:" "+b};
$jscomp.Map.prototype.set=function(b,h){var q=this.maybeGetEntry_(b),t=q.id,r=q.list,q=q.entry;r||(r=this.data_[t]=[]);q?q.value=h:(q={next:this.head_,previous:this.head_.previous,head:this.head_,key:b,value:h},r.push(q),this.head_.previous.next=q,this.head_.previous=q,this.size++);return this};
$jscomp.Map.prototype["delete"]=function(b){var h=this.maybeGetEntry_(b);b=h.id;var q=h.list,t=h.index;return(h=h.entry)&&q?(q.splice(t,1),q.length||delete this.data_[b],h.previous.next=h.next,h.next.previous=h.previous,h.head=null,this.size--,!0):!1};$jscomp.Map.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=$jscomp.Map.createHead_();this.size=0};$jscomp.Map.prototype.has=function(b){return!!this.maybeGetEntry_(b).entry};
$jscomp.Map.prototype.get=function(b){return(b=this.maybeGetEntry_(b).entry)&&b.value};$jscomp.Map.prototype.maybeGetEntry_=function(b){var h=$jscomp.Map.getId_(b),q=this.data_[h];if(q)for(var t=0;t<q.length;t++){var r=q[t];if(b!==b&&r.key!==r.key||b===r.key)return{id:h,list:q,index:t,entry:r}}return{id:h,list:q,index:-1,entry:void 0}};$jscomp.Map.prototype.entries=function(){return this.iter_(function(b){return[b.key,b.value]})};$jscomp.Map.prototype.keys=function(){return this.iter_(function(b){return b.key})};
$jscomp.Map.prototype.values=function(){return this.iter_(function(b){return b.value})};$jscomp.Map.prototype.forEach=function(b,h){for(var q=$jscomp.makeIterator(this.entries()),t=q.next();!t.done;t=q.next())t=t.value,b.call(h,t[1],t[0],this)};
$jscomp.Map.prototype.iter_=function(b){var h=this,q=this.head_;$jscomp.initSymbol();$jscomp.initSymbolIterator();var t={};return t.next=function(){if(q){for(;q.head!=h.head_;)q=q.previous;for(;q.next!=q.head;)return q=q.next,{done:!1,value:b(q)};q=null}return{done:!0,value:void 0}},t[Symbol.iterator]=function(){return this},t};$jscomp.Map.index_=0;$jscomp.Map.defineProperty_=Object.defineProperty?function(b,h,q){Object.defineProperty(b,h,{value:String(q)})}:function(b,h,q){b[h]=String(q)};
$jscomp.Map.Entry_=function(){};$jscomp.Map.ASSUME_NO_NATIVE=!1;$jscomp.Map$install=function(){$jscomp.initSymbol();$jscomp.initSymbolIterator();!$jscomp.Map.ASSUME_NO_NATIVE&&$jscomp.Map.checkBrowserConformance_()?$jscomp.Map=$jscomp.global.Map:($jscomp.initSymbol(),$jscomp.initSymbolIterator(),$jscomp.Map.prototype[Symbol.iterator]=$jscomp.Map.prototype.entries,$jscomp.initSymbol(),$jscomp.Map.key_=Symbol("map-id-key"));$jscomp.Map$install=function(){}};$jscomp.math=$jscomp.math||{};
$jscomp.math.clz32=function(b){b=Number(b)>>>0;if(0===b)return 32;var h=0;0===(b&4294901760)&&(b<<=16,h+=16);0===(b&4278190080)&&(b<<=8,h+=8);0===(b&4026531840)&&(b<<=4,h+=4);0===(b&3221225472)&&(b<<=2,h+=2);0===(b&2147483648)&&h++;return h};$jscomp.math.imul=function(b,h){b=Number(b);h=Number(h);var q=b&65535,t=h&65535;return q*t+((b>>>16&65535)*t+q*(h>>>16&65535)<<16>>>0)|0};$jscomp.math.sign=function(b){b=Number(b);return 0===b||isNaN(b)?b:0<b?1:-1};
$jscomp.math.log10=function(b){return Math.log(b)/Math.LN10};$jscomp.math.log2=function(b){return Math.log(b)/Math.LN2};$jscomp.math.log1p=function(b){b=Number(b);if(.25>b&&-.25<b){for(var h=b,q=1,t=b,r=0,e=1;r!=t;)h*=b,e*=-1,t=(r=t)+e*h/++q;return t}return Math.log(1+b)};$jscomp.math.expm1=function(b){b=Number(b);if(.25>b&&-.25<b){for(var h=b,q=1,t=b,r=0;r!=t;)h*=b/++q,t=(r=t)+h;return t}return Math.exp(b)-1};$jscomp.math.cosh=function(b){b=Number(b);return(Math.exp(b)+Math.exp(-b))/2};
$jscomp.math.sinh=function(b){b=Number(b);return 0===b?b:(Math.exp(b)-Math.exp(-b))/2};$jscomp.math.tanh=function(b){b=Number(b);if(0===b)return b;var h=Math.exp(2*-Math.abs(b)),h=(1-h)/(1+h);return 0>b?-h:h};$jscomp.math.acosh=function(b){b=Number(b);return Math.log(b+Math.sqrt(b*b-1))};$jscomp.math.asinh=function(b){b=Number(b);if(0===b)return b;var h=Math.log(Math.abs(b)+Math.sqrt(b*b+1));return 0>b?-h:h};
$jscomp.math.atanh=function(b){b=Number(b);return($jscomp.math.log1p(b)-$jscomp.math.log1p(-b))/2};
$jscomp.math.hypot=function(b,h,q){for(var t=[],r=2;r<arguments.length;++r)t[r-2]=arguments[r];b=Number(b);h=Number(h);for(var e=Math.max(Math.abs(b),Math.abs(h)),a=$jscomp.makeIterator(t),r=a.next();!r.done;r=a.next())e=Math.max(e,Math.abs(r.value));if(1E100<e||1E-100>e){b/=e;h/=e;a=b*b+h*h;t=$jscomp.makeIterator(t);for(r=t.next();!r.done;r=t.next())r=r.value,r=Number(r)/e,a+=r*r;return Math.sqrt(a)*e}e=b*b+h*h;t=$jscomp.makeIterator(t);for(r=t.next();!r.done;r=t.next())r=r.value,r=Number(r),e+=
r*r;return Math.sqrt(e)};$jscomp.math.trunc=function(b){b=Number(b);if(isNaN(b)||Infinity===b||-Infinity===b||0===b)return b;var h=Math.floor(Math.abs(b));return 0>b?-h:h};$jscomp.math.cbrt=function(b){if(0===b)return b;b=Number(b);var h=Math.pow(Math.abs(b),1/3);return 0>b?-h:h};$jscomp.number=$jscomp.number||{};$jscomp.number.isFinite=function(b){return"number"!==typeof b?!1:!isNaN(b)&&Infinity!==b&&-Infinity!==b};
$jscomp.number.isInteger=function(b){return $jscomp.number.isFinite(b)?b===Math.floor(b):!1};$jscomp.number.isNaN=function(b){return"number"===typeof b&&isNaN(b)};$jscomp.number.isSafeInteger=function(b){return $jscomp.number.isInteger(b)&&Math.abs(b)<=$jscomp.number.MAX_SAFE_INTEGER};$jscomp.number.EPSILON=Math.pow(2,-52);$jscomp.number.MAX_SAFE_INTEGER=9007199254740991;$jscomp.number.MIN_SAFE_INTEGER=-9007199254740991;$jscomp.object=$jscomp.object||{};
$jscomp.object.assign=function(b,h){for(var q=[],t=1;t<arguments.length;++t)q[t-1]=arguments[t];q=$jscomp.makeIterator(q);for(t=q.next();!t.done;t=q.next())if(t=t.value)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(b[r]=t[r]);return b};$jscomp.object.is=function(b,h){return b===h?0!==b||1/b===1/h:b!==b&&h!==h};$jscomp.Set=function(b){b=void 0===b?[]:b;this.map_=new $jscomp.Map;if(b){b=$jscomp.makeIterator(b);for(var h=b.next();!h.done;h=b.next())this.add(h.value)}this.size=this.map_.size};
$jscomp.Set.checkBrowserConformance_=function(){var b=$jscomp.global.Set;if(!b||!b.prototype.entries||!Object.seal)return!1;var h=Object.seal({x:4}),b=new b($jscomp.makeIterator([h]));if(b.has(h)||1!=b.size||b.add(h)!=b||1!=b.size||b.add({x:4})!=b||2!=b.size)return!1;var b=b.entries(),q=b.next();if(q.done||q.value[0]!=h||q.value[1]!=h)return!1;q=b.next();return q.done||q.value[0]==h||4!=q.value[0].x||q.value[1]!=q.value[0]?!1:b.next().done};
$jscomp.Set.prototype.add=function(b){this.map_.set(b,b);this.size=this.map_.size;return this};$jscomp.Set.prototype["delete"]=function(b){b=this.map_["delete"](b);this.size=this.map_.size;return b};$jscomp.Set.prototype.clear=function(){this.map_.clear();this.size=0};$jscomp.Set.prototype.has=function(b){return this.map_.has(b)};$jscomp.Set.prototype.entries=function(){return this.map_.entries()};$jscomp.Set.prototype.values=function(){return this.map_.values()};
$jscomp.Set.prototype.forEach=function(b,h){var q=this;this.map_.forEach(function(t){return b.call(h,t,t,q)})};$jscomp.Set.ASSUME_NO_NATIVE=!1;$jscomp.Set$install=function(){!$jscomp.Set.ASSUME_NO_NATIVE&&$jscomp.Set.checkBrowserConformance_()?$jscomp.Set=$jscomp.global.Set:($jscomp.Map$install(),$jscomp.initSymbol(),$jscomp.initSymbolIterator(),$jscomp.Set.prototype[Symbol.iterator]=$jscomp.Set.prototype.values);$jscomp.Set$install=function(){}};$jscomp.string=$jscomp.string||{};
$jscomp.string.noRegExp_=function(b,h){if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+h+" must not be a regular expression");};
$jscomp.string.fromCodePoint=function(b){for(var h=[],q=0;q<arguments.length;++q)h[q-0]=arguments[q];for(var q="",h=$jscomp.makeIterator(h),t=h.next();!t.done;t=h.next()){t=t.value;t=+t;if(0>t||1114111<t||t!==Math.floor(t))throw new RangeError("invalid_code_point "+t);65535>=t?q+=String.fromCharCode(t):(t-=65536,q+=String.fromCharCode(t>>>10&1023|55296),q+=String.fromCharCode(t&1023|56320))}return q};
$jscomp.string.repeat=function(b){var h=this.toString();if(0>b||1342177279<b)throw new RangeError("Invalid count value");b|=0;for(var q="";b;)if(b&1&&(q+=h),b>>>=1)h+=h;return q};$jscomp.string.repeat$install=function(){String.prototype.repeat||(String.prototype.repeat=$jscomp.string.repeat)};
$jscomp.string.codePointAt=function(b){var h=this.toString(),q=h.length;b=Number(b)||0;if(0<=b&&b<q){b|=0;var t=h.charCodeAt(b);if(55296>t||56319<t||b+1===q)return t;b=h.charCodeAt(b+1);return 56320>b||57343<b?t:1024*(t-55296)+b+9216}};$jscomp.string.codePointAt$install=function(){String.prototype.codePointAt||(String.prototype.codePointAt=$jscomp.string.codePointAt)};
$jscomp.string.includes=function(b,h){h=void 0===h?0:h;$jscomp.string.noRegExp_(b,"includes");return-1!==this.toString().indexOf(b,h)};$jscomp.string.includes$install=function(){String.prototype.includes||(String.prototype.includes=$jscomp.string.includes)};
$jscomp.string.startsWith=function(b,h){h=void 0===h?0:h;$jscomp.string.noRegExp_(b,"startsWith");var q=this.toString();b+="";for(var t=q.length,r=b.length,e=Math.max(0,Math.min(h|0,q.length)),a=0;a<r&&e<t;)if(q[e++]!=b[a++])return!1;return a>=r};$jscomp.string.startsWith$install=function(){String.prototype.startsWith||(String.prototype.startsWith=$jscomp.string.startsWith)};
$jscomp.string.endsWith=function(b,h){$jscomp.string.noRegExp_(b,"endsWith");var q=this.toString();b+="";void 0===h&&(h=q.length);for(var t=Math.max(0,Math.min(h|0,q.length)),r=b.length;0<r&&0<t;)if(q[--t]!=b[--r])return!1;return 0>=r};$jscomp.string.endsWith$install=function(){String.prototype.endsWith||(String.prototype.endsWith=$jscomp.string.endsWith)};
(function e$$0(h,q,t){function r(a,k){if(!q[a]){if(!h[a]){var l="function"==typeof require&&require;if(!k&&l)return l(a,!0);if(e)return e(a,!0);l=Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l;}l=q[a]={exports:{}};h[a][0].call(l.exports,function(e){var l=h[a][1][e];return r(l?l:e)},l,l.exports,e$$0,h,q,t)}return q[a].exports}for(var e="function"==typeof require&&require,a=0;a<t.length;a++)r(t[a]);return r})({1:[function(b,h,q){h=b("../regl")();q=b("vectorize-text");var t=b("gl-mat4/perspective"),
r=b("gl-mat4/lookAt");b=q("hello regl!",{textAlign:"center",textBaseline:"middle"});var e=h.texture({copy:!0,min:"linear",mag:"linear"}),a=h({frag:"\n  precision mediump float;\n  uniform sampler2D texture;\n  uniform float t;\n  varying vec2 uv;\n  void main () {\n    vec2 warp = uv + 0.01 * sin(t) * vec2(0.5 - uv.y, uv.x - 0.5)\n      - 0.01 * (uv - 0.5);\n    gl_FragColor = vec4(0.98 * texture2D(texture, warp).rgb, 1);\n  }",vert:"\n  precision mediump float;\n  attribute vec2 position;\n  varying vec2 uv;\n  void main () {\n    uv = position;\n    gl_Position = vec4(2.0 * position - 1.0, 0, 1);\n  }",
attributes:{position:[-2,0,0,-2,2,2]},uniforms:{texture:e,t:function(a){return.001*a.tick}},depth:{enable:!1},count:3}),n=h({frag:"\n  precision mediump float;\n  uniform float t;\n  void main () {\n    gl_FragColor = vec4(\n      1.0 + cos(2.0 * t),\n      1.0 + cos(2.1 * t + 1.0),\n      1.0 + cos(2.2 * t + 2.0),\n      1);\n  }",vert:"\n  attribute vec2 position;\n  uniform mat4 projection, view;\n  void main () {\n    gl_Position = projection * view * vec4(position, 0, 1);\n  }",attributes:{position:b.positions},
elements:b.edges,uniforms:{t:function(a){return.01*a.tick},view:function(a){a=.01*a.tick;return r([],[5*Math.sin(a),0,-5*Math.cos(a)],[0,0,0],[0,-1,0])},projection:function(a){return t([],Math.PI/4,a.viewportWidth/a.viewportHeight,.01,1E3)}},depth:{enable:!1}});h.frame(function(){a();n();e({copy:!0,min:"linear",mag:"linear"})})},{"../regl":130,"gl-mat4/lookAt":82,"gl-mat4/perspective":83,"vectorize-text":126}],2:[function(b,h,q){function t(){this.w=this.z=this.y=this.x=this.state=0;this.buffer=null;
this.size=0;this.normalized=!1;this.type=5126;this.divisor=this.stride=this.offset=0}h.exports=function(b,e,a,n,k){b=a.maxAttributes;e=Array(b);for(a=0;a<b;++a)e[a]=new t;return{Record:t,scope:{},state:e}}},{}],3:[function(b,h,q){function t(a){return m[Object.prototype.toString.call(a)]|0}function r(a,e){for(var d=0;d<e.length;++d)a[d]=e[d]}function e(a,e,d,f,c,g,l){for(var n=0,k=0;k<d;++k)for(var b=0;b<f;++b)a[n++]=e[c*k+g*b+l]}var a=b("./util/check"),n=b("./util/is-typed-array"),k=b("./util/is-ndarray"),
l=b("./util/values"),A=b("./util/pool");q=b("./util/flatten");var v=q.flatten,u=q.shape,m=b("./constants/arraytypes.json"),g=b("./constants/dtypes.json"),d=b("./constants/usage.json"),f=[];f[5120]=1;f[5122]=2;f[5124]=4;f[5121]=1;f[5123]=2;f[5125]=4;f[5126]=4;h.exports=function(p,b,m){function C(c){this.id=B++;this.buffer=p.createBuffer();this.type=c;this.usage=35044;this.byteLength=0;this.dimension=1;this.dtype=5121;this.persistentData=null;m.profile&&(this.stats={size:0})}function c(c,a,e){c.byteLength=
a.byteLength;p.bufferData(c.type,a,e)}function y(d,f,g,p,l,b){d.usage=g;if(Array.isArray(f)){if(d.dtype=p||5126,0<f.length)if(Array.isArray(f[0])){l=u(f);for(var m=p=1;m<l.length;++m)p*=l[m];d.dimension=p;f=v(f,l,d.dtype);c(d,f,g);b?d.persistentData=f:A.freeType(f)}else"number"===typeof f[0]?(d.dimension=l,l=A.allocType(d.dtype,f.length),r(l,f),c(d,l,g),b?d.persistentData=l:A.freeType(l)):n(f[0])?(d.dimension=f[0].length,d.dtype=p||t(f[0])||5126,f=v(f,[f.length,f[0].length],d.dtype),c(d,f,g),b?d.persistentData=
f:A.freeType(f)):a.raise("invalid buffer data")}else if(n(f))d.dtype=p||t(f),d.dimension=l,c(d,f,g),b&&(d.persistentData=new Uint8Array(new Uint8Array(f.buffer)));else if(k(f)){l=f.shape;var y=f.stride,m=f.offset,x=0,w=0,B=0,z=0;1===l.length?(x=l[0],w=1,B=y[0],z=0):2===l.length?(x=l[0],w=l[1],B=y[0],z=y[1]):a.raise("invalid shape");d.dtype=p||t(f.data)||5126;d.dimension=w;l=A.allocType(d.dtype,x*w);e(l,f.data,x,w,B,z,m);c(d,l,g);b?d.persistentData=l:A.freeType(l)}else a.raise("invalid buffer data")}
function D(c){b.bufferCount--;var e=c.buffer;a(e,"buffer must not be deleted already");p.deleteBuffer(e);c.buffer=null;delete w[c.id]}var B=0,w={};C.prototype.bind=function(){p.bindBuffer(this.type,this.buffer)};C.prototype.destroy=function(){D(this)};var E=[];m.profile&&(b.getTotalBufferSize=function(){var c=0;Object.keys(w).forEach(function(a){c+=w[a].stats.size});return c});return{create:function(c,l,B,E){function h(c){var e=35044,l=null,b=0,x=0,w=1;Array.isArray(c)||n(c)||k(c)?l=c:"number"===
typeof c?b=c|0:c&&(a.type(c,"object","buffer arguments must be an object, a number or an array"),"data"in c&&(a(null===l||Array.isArray(l)||n(l)||k(l),"invalid data for buffer"),l=c.data),"usage"in c&&(a.parameter(c.usage,d,"invalid buffer usage"),e=d[c.usage]),"type"in c&&(a.parameter(c.type,g,"invalid buffer type"),x=g[c.type]),"dimension"in c&&(a.type(c.dimension,"number","invalid dimension"),w=c.dimension|0),"length"in c&&(a.nni(b,"buffer length must be a nonnegative integer"),b=c.length|0));
J.bind();l?y(J,l,e,x,w,E):(p.bufferData(J.type,b,e),J.dtype=x||5121,J.usage=e,J.dimension=w,J.byteLength=b);m.profile&&(J.stats.size=J.byteLength*f[J.dtype]);return h}function q(c,e){a(e+c.byteLength<=J.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+c.byteLength+" starting from offset "+e+" to a buffer of size "+J.byteLength);p.bufferSubData(J.type,e,c)}b.bufferCount++;var J=new C(l);w[J.id]=J;B||h(c);h._reglType="buffer";h._buffer=J;h.subdata=function(c,
d){var f=(d||0)|0,g;J.bind();if(Array.isArray(c)){if(0<c.length)if("number"===typeof c[0]){var l=A.allocType(J.dtype,c.length);r(l,c);q(l,f);A.freeType(l)}else Array.isArray(c[0])||n(c[0])?(g=u(c),l=v(c,g,J.dtype),q(l,f),A.freeType(l)):a.raise("invalid buffer data")}else if(n(c))q(c,f);else if(k(c)){g=c.shape;var p=c.stride,b=l=0,m=0,y=0;1===g.length?(l=g[0],b=1,m=p[0],y=0):2===g.length?(l=g[0],b=g[1],m=p[0],y=p[1]):a.raise("invalid shape");g=Array.isArray(c.data)?J.dtype:t(c.data);g=A.allocType(g,
l*b);e(g,c.data,l,b,m,y,c.offset);q(g,f);A.freeType(g)}else a.raise("invalid data for buffer subdata");return h};m.profile&&(h.stats=J.stats);h.destroy=function(){D(J)};return h},createStream:function(c,a){var e=E.pop();e||(e=new C(c));e.bind();y(e,a,35040,0,1,!1);return e},destroyStream:function(c){E.push(c)},clear:function(){l(w).forEach(D);E.forEach(D)},getBuffer:function(c){return c&&c._buffer instanceof C?c._buffer:null},restore:function(){l(w).forEach(function(c){c.buffer=p.createBuffer();p.bindBuffer(c.type,
c.buffer);p.bufferData(c.type,c.persistentData||c.byteLength,c.usage)})},_initBuffer:y}}},{"./constants/arraytypes.json":4,"./constants/dtypes.json":5,"./constants/usage.json":7,"./util/check":21,"./util/flatten":25,"./util/is-ndarray":27,"./util/is-typed-array":28,"./util/pool":30,"./util/values":33}],4:[function(b,h,q){h.exports={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,
"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121}},{}],5:[function(b,h,q){h.exports={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,"float":5126,float32:5126}},{}],6:[function(b,h,q){h.exports={points:0,point:0,lines:1,line:1,"line loop":2,"line strip":3,triangles:4,triangle:4,"triangle strip":5,"triangle fan":6}},{}],7:[function(b,h,q){h.exports={"static":35044,dynamic:35048,stream:35040}},{}],8:[function(b,h,q){function t(c){return Array.isArray(c)||
u(c)||m(c)}function r(c){return c.sort(function(c,a){return"viewport"===c?-1:"viewport"===a?1:c<a?-1:1})}function e(c,a,e,d){this.thisDep=c;this.contextDep=a;this.propDep=e;this.append=d}function a(c){return c&&!(c.thisDep||c.contextDep||c.propDep)}function n(c){return new e(!1,!1,!1,c)}function k(c,a){var d=c.type;return 0===d?(d=c.data.length,new e(!0,1<=d,2<=d,a)):4===d?(d=c.data,new e(d.thisDep,d.contextDep,d.propDep,a)):new e(3===d,2===d,1===d,a)}var l=b("./util/check"),A=b("./util/codegen"),
v=b("./util/loop"),u=b("./util/is-typed-array"),m=b("./util/is-ndarray"),g=b("./util/is-array-like"),d=b("./dynamic"),f=b("./constants/primitives.json"),p=b("./constants/dtypes.json"),x=["x","y","z","w"],z="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),C={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,
"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},c="constant color, constant alpha;one minus constant color, constant alpha;constant color, one minus constant alpha;one minus constant color, one minus constant alpha;constant alpha, constant color;constant alpha, one minus constant color;one minus constant alpha, constant color;one minus constant alpha, one minus constant color".split(";"),
y={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},D={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},B={frag:35632,vert:35633},w={cw:2304,ccw:2305},E=new e(!1,!1,!1,function(){});h.exports=function(b,m,u,h,q,K,J,L,H,Q,I,U,Z,aa,X){function T(c){return c.replace(".","_")}function O(c,a,e){var d=T(c);Ba.push(c);
Ca[d]=ua[d]=!!e;va[d]=a}function P(c,a,e){var d=T(c);Ba.push(c);Array.isArray(e)?(ua[d]=e.slice(),Ca[d]=e.slice()):ua[d]=Ca[d]=e;wa[d]=a}function W(){var a=A(),e=a.link,d=a.global;a.id=La++;a.batchId="0";var f=e(Ja),g=a.shared={props:"a0"};Object.keys(Ja).forEach(function(c){g[c]=d.def(f,".",c)});l.optional(function(){a.CHECK=e(l);a.commandStr=l.guessCommand();a.command=e(a.commandStr);a.assert=function(c,a,d){c("if(!(",a,"))",this.CHECK,".commandRaise(",e(d),",",this.command,");")};Da.invalidBlendCombinations=
c});var p=a.next={},b=a.current={};Object.keys(wa).forEach(function(c){Array.isArray(ua[c])&&(p[c]=d.def(g.next,".",c),b[c]=d.def(g.current,".",c))});var n=a.constants={};Object.keys(Da).forEach(function(c){n[c]=d.def(JSON.stringify(Da[c]))});a.invoke=function(c,d){switch(d.type){case 0:var f=["this",g.context,g.props,a.batchId];return c.def(e(d.data),".call(",f.slice(0,Math.max(d.data.length+1,4)),")");case 1:return c.def(g.props,d.data);case 2:return c.def(g.context,d.data);case 3:return c.def("this",
d.data);case 4:return d.data.append(a,c),d.data.ref}};a.attribCache={};var k={};a.scopeAttrib=function(c){c=m.id(c);if(c in k)return k[c];var a=Q.scope[c];a||(a=Q.scope[c]=new pa);return k[c]=e(a)};return a}function S(c){var a=c["static"];c=c.dynamic;var d;if("profile"in a){var e=!!a.profile;d=n(function(c,a){return e});d.enable=e}else if("profile"in c){var f=c.profile;d=k(f,function(c,a){return c.invoke(a,f)})}return d}function da(c,a){var d=c["static"],e=c.dynamic;if("framebuffer"in d){var f=d.framebuffer;
return f?(f=L.getFramebuffer(f),l.command(f,"invalid framebuffer object"),n(function(c,a){var d=c.link(f),e=c.shared;a.set(e.framebuffer,".next",d);e=e.context;a.set(e,".framebufferWidth",d+".width");a.set(e,".framebufferHeight",d+".height");return d})):n(function(c,a){var d=c.shared;a.set(d.framebuffer,".next","null");d=d.context;a.set(d,".framebufferWidth",d+".drawingBufferWidth");a.set(d,".framebufferHeight",d+".drawingBufferHeight");return"null"})}if("framebuffer"in e){var g=e.framebuffer;return k(g,
function(c,a){var d=c.invoke(a,g),e=c.shared,f=e.framebuffer,p=a.def(f,".getFramebuffer(",d,")");l.optional(function(){c.assert(a,"!"+d+"||"+p,"invalid framebuffer object")});a.set(f,".next",p);e=e.context;a.set(e,".framebufferWidth",p+"?"+p+".width:"+e+".drawingBufferWidth");a.set(e,".framebufferHeight",p+"?"+p+".height:"+e+".drawingBufferHeight");return p})}return null}function Y(c,a,d){function f(c){if(c in g){var b=g[c];l.commandType(b,"object","invalid "+c,d.commandStr);var n=!0,m=b.x|0,y=b.y|
0,x,w;"width"in b?(x=b.width|0,l.command(0<=x,"invalid "+c,d.commandStr)):n=!1;"height"in b?(w=b.height|0,l.command(0<=w,"invalid "+c,d.commandStr)):n=!1;return new e(!n&&a&&a.thisDep,!n&&a&&a.contextDep,!n&&a&&a.propDep,function(c,a){var d=c.shared.context,e=x;"width"in b||(e=a.def(d,".","framebufferWidth","-",m));var f=w;"height"in b||(f=a.def(d,".","framebufferHeight","-",y));return[m,y,e,f]})}if(c in p){var B=p[c],n=k(B,function(a,d){var e=a.invoke(d,B);l.optional(function(){a.assert(d,e+"&&typeof "+
e+'==="object"',"invalid "+c)});var f=a.shared.context,g=d.def(e,".x|0"),p=d.def(e,".y|0"),n=d.def('"width" in ',e,"?",e,".width|0:","(",f,".","framebufferWidth","-",g,")"),b=d.def('"height" in ',e,"?",e,".height|0:","(",f,".","framebufferHeight","-",p,")");l.optional(function(){a.assert(d,n+">=0&&"+b+">=0","invalid "+c)});return[g,p,n,b]});a&&(n.thisDep=n.thisDep||a.thisDep,n.contextDep=n.contextDep||a.contextDep,n.propDep=n.propDep||a.propDep);return n}return a?new e(a.thisDep,a.contextDep,a.propDep,
function(c,a){var d=c.shared.context;return[0,0,a.def(d,".","framebufferWidth"),a.def(d,".","framebufferHeight")]}):null}var g=c["static"],p=c.dynamic;if(c=f("viewport")){var b=c;c=new e(c.thisDep,c.contextDep,c.propDep,function(c,a){var d=b.append(c,a),e=c.shared.context;a.set(e,".viewportWidth",d[2]);a.set(e,".viewportHeight",d[3]);return d})}return{viewport:c,scissor_box:f("scissor.box")}}function ha(c){function d(c){if(c in f){var a=m.id(f[c]);l.optional(function(){I.shader(B[c],a,l.guessCommand())});
var e=n(function(){return a});e.id=a;return e}if(c in g){var p=g[c];return k(p,function(a,d){var e=a.invoke(d,p),f=d.def(a.shared.strings,".id(",e,")");l.optional(function(){d(a.shared.shader,".shader(",B[c],",",f,",",a.command,");")});return f})}return null}var f=c["static"],g=c.dynamic,p=d("frag"),b=d("vert"),y=null;a(p)&&a(b)?(y=I.program(b.id,p.id),c=n(function(c,a){return c.link(y)})):c=new e(p&&p.thisDep||b&&b.thisDep,p&&p.contextDep||b&&b.contextDep,p&&p.propDep||b&&b.propDep,function(c,a){var d=
c.shared.shader,e;e=p?p.append(c,a):a.def(d,".","frag");var f;f=b?b.append(c,a):a.def(d,".","vert");var g=d+".program("+f+","+e;l.optional(function(){g+=","+c.command});return a.def(g+")")});return{frag:p,vert:b,progVar:c,program:y}}function la(c,d){function g(c,a){if(c in p){var e=p[c]|0;l.command(!a||0<=e,"invalid "+c,d.commandStr);return n(function(c,d){a&&(c.OFFSET=e);return e})}if(c in b){var f=b[c];return k(f,function(d,e){var g=d.invoke(e,f);a&&(d.OFFSET=g,l.optional(function(){d.assert(e,
g+">=0","invalid "+c)}));return g})}return a&&m?n(function(c,a){c.OFFSET="0";return 0}):null}var p=c["static"],b=c.dynamic,m=function(){if("elements"in p){var c=p.elements;t(c)?c=K.getElements(K.create(c,!0)):c&&(c=K.getElements(c),l.command(c,"invalid elements",d.commandStr));var a=n(function(a,d){if(c){var e=a.link(c);return a.ELEMENTS=e}return a.ELEMENTS=null});a.value=c;return a}if("elements"in b){var e=b.elements;return k(e,function(c,a){var d=c.shared,f=d.isBufferArgs,d=d.elements,g=c.invoke(a,
e),p=a.def("null"),f=a.def(f,"(",g,")"),b=c.cond(f).then(p,"=",d,".createStream(",g,");")["else"](p,"=",d,".getElements(",g,");");l.optional(function(){c.assert(b["else"],"!"+g+"||"+p,"invalid elements")});a.entry(b);a.exit(c.cond(f).then(d,".destroyStream(",p,");"));return c.ELEMENTS=p})}return null}(),y=g("offset",!0);return{elements:m,primitive:function(){if("primitive"in p){var c=p.primitive;l.commandParameter(c,f,"invalid primitve",d.commandStr);return n(function(a,d){return f[c]})}if("primitive"in
b){var g=b.primitive;return k(g,function(c,a){var d=c.constants.primTypes,e=c.invoke(a,g);l.optional(function(){c.assert(a,e+" in "+d,"invalid primitive, must be one of "+Object.keys(f))});return a.def(d,"[",e,"]")})}return m?a(m)?m.value?n(function(c,a){return a.def(c.ELEMENTS,".primType")}):n(function(){return 4}):new e(m.thisDep,m.contextDep,m.propDep,function(c,a){var d=c.ELEMENTS;return a.def(d,"?",d,".primType:",4)}):null}(),count:function(){if("count"in p){var c=p.count|0;l.command("number"===
typeof c&&0<=c,"invalid vertex count",d.commandStr);return n(function(){return c})}if("count"in b){var f=b.count;return k(f,function(c,a){var d=c.invoke(a,f);l.optional(function(){c.assert(a,"typeof "+d+'==="number"&&'+d+">=0&&"+d+"===("+d+"|0)","invalid vertex count")});return d})}if(m){if(a(m)){if(m)return y?new e(y.thisDep,y.contextDep,y.propDep,function(c,a){var d=a.def(c.ELEMENTS,".vertCount-",c.OFFSET);l.optional(function(){c.assert(a,d+">=0","invalid vertex offset/element buffer too small")});
return d}):n(function(c,a){return a.def(c.ELEMENTS,".vertCount")});var g=n(function(){return-1});l.optional(function(){g.MISSING=!0});return g}var x=new e(m.thisDep||y.thisDep,m.contextDep||y.contextDep,m.propDep||y.propDep,function(c,a){var d=c.ELEMENTS;return c.OFFSET?a.def(d,"?",d,".vertCount-",c.OFFSET,":-1"):a.def(d,"?",d,".vertCount:-1")});l.optional(function(){x.DYNAMIC=!0});return x}return null}(),instances:g("instances",!1),offset:y}}function ma(a,d){var e=a["static"],f=a.dynamic,p={};Ba.forEach(function(a){function b(c,
d){if(a in e){var g=c(e[a]);p[m]=n(function(){return g})}else if(a in f){var l=f[a];p[m]=k(l,function(c,a){return d(c,a,c.invoke(a,l))})}}var m=T(a);switch(a){case "cull.enable":case "blend.enable":case "dither":case "stencil.enable":case "depth.enable":case "scissor.enable":case "polygonOffset.enable":case "sample.alpha":case "sample.enable":case "depth.mask":return b(function(c){l.commandType(c,"boolean",a,d.commandStr);return c},function(c,d,e){l.optional(function(){c.assert(d,"typeof "+e+'==="boolean"',
"invalid flag "+a,c.commandStr)});return e});case "depth.func":return b(function(c){l.commandParameter(c,y,"invalid "+a,d.commandStr);return y[c]},function(c,d,e){var f=c.constants.compareFuncs;l.optional(function(){c.assert(d,e+" in "+f,"invalid "+a+", must be one of "+Object.keys(y))});return d.def(f,"[",e,"]")});case "depth.range":return b(function(c){l.command(g(c)&&2===c.length&&"number"===typeof c[0]&&"number"===typeof c[1]&&c[0]<=c[1],"depth range is 2d array",d.commandStr);return c},function(c,
a,d){l.optional(function(){c.assert(a,c.shared.isArrayLike+"("+d+")&&"+d+".length===2&&typeof "+d+'[0]==="number"&&typeof '+d+'[1]==="number"&&'+d+"[0]<="+d+"[1]","depth range must be a 2d array")});var e=a.def("+",d,"[0]"),f=a.def("+",d,"[1]");return[e,f]});case "blend.func":return b(function(a){l.commandType(a,"object","blend.func",d.commandStr);var e="srcRGB"in a?a.srcRGB:a.src,f="srcAlpha"in a?a.srcAlpha:a.src,g="dstRGB"in a?a.dstRGB:a.dst;a="dstAlpha"in a?a.dstAlpha:a.dst;l.commandParameter(e,
C,m+".srcRGB",d.commandStr);l.commandParameter(f,C,m+".srcAlpha",d.commandStr);l.commandParameter(g,C,m+".dstRGB",d.commandStr);l.commandParameter(a,C,m+".dstAlpha",d.commandStr);l.command(-1===c.indexOf(e+", "+g),"unallowed blending combination (srcRGB, dstRGB) = ("+e+", "+g+")",d.commandStr);return[C[e],C[g],C[f],C[a]]},function(c,d,e){function f(p,b){var n=d.def('"',p,b,'" in ',e,"?",e,".",p,b,":",e,".",p);l.optional(function(){c.assert(d,n+" in "+g,"invalid "+a+"."+p+b+", must be one of "+Object.keys(C))});
return n}var g=c.constants.blendFuncs;l.optional(function(){c.assert(d,e+"&&typeof "+e+'==="object"',"invalid blend func, must be an object")});var p=f("src","RGB"),b=f("dst","RGB");l.optional(function(){c.assert(d,c.constants.invalidBlendCombinations+".indexOf("+p+'+", "+'+b+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var n=d.def(g,"[",p,"]"),m=d.def(g,"[",f("src","Alpha"),"]"),k=d.def(g,"[",b,"]"),y=d.def(g,"[",f("dst","Alpha"),"]");return[n,k,m,y]});case "blend.equation":return b(function(c){if("string"===
typeof c)return l.commandParameter(c,ga,"invalid "+a,d.commandStr),[ga[c],ga[c]];if("object"===typeof c)return l.commandParameter(c.rgb,ga,a+".rgb",d.commandStr),l.commandParameter(c.alpha,ga,a+".alpha",d.commandStr),[ga[c.rgb],ga[c.alpha]];l.commandRaise("invalid blend.equation",d.commandStr)},function(c,d,e){var f=c.constants.blendEquations,g=d.def(),p=d.def(),b=c.cond("typeof ",e,'==="string"');l.optional(function(){function d(a,e,g){c.assert(a,g+" in "+f,"invalid "+e+", must be one of "+Object.keys(ga))}
d(b.then,a,e);c.assert(b["else"],e+"&&typeof "+e+'==="object"',"invalid "+a);d(b["else"],a+".rgb",e+".rgb");d(b["else"],a+".alpha",e+".alpha")});b.then(g,"=",p,"=",f,"[",e,"];");b["else"](g,"=",f,"[",e,".rgb];",p,"=",f,"[",e,".alpha];");d(b);return[g,p]});case "blend.color":return b(function(c){l.command(g(c)&&4===c.length,"blend.color must be a 4d array",d.commandStr);return v(4,function(a){return+c[a]})},function(c,a,d){l.optional(function(){c.assert(a,c.shared.isArrayLike+"("+d+")&&"+d+".length===4",
"blend.color must be a 4d array")});return v(4,function(c){return a.def("+",d,"[",c,"]")})});case "stencil.mask":return b(function(c){l.commandType(c,"number",m,d.commandStr);return c|0},function(c,a,d){l.optional(function(){c.assert(a,"typeof "+d+'==="number"',"invalid stencil.mask")});return a.def(d,"|0")});case "stencil.func":return b(function(c){l.commandType(c,"object",m,d.commandStr);var e=c.cmp||"keep",f=c.ref||0;c="mask"in c?c.mask:-1;l.commandParameter(e,y,a+".cmp",d.commandStr);l.commandType(f,
"number",a+".ref",d.commandStr);l.commandType(c,"number",a+".mask",d.commandStr);return[y[e],f,c]},function(c,a,d){var e=c.constants.compareFuncs;l.optional(function(){function f(){c.assert(a,Array.prototype.join.call(arguments,""),"invalid stencil.func")}f(d+"&&typeof ",d,'==="object"');f('!("cmp" in ',d,")||(",d,".cmp in ",e,")")});var f=a.def('"cmp" in ',d,"?",e,"[",d,".cmp]",":",7680),g=a.def(d,".ref|0"),p=a.def('"mask" in ',d,"?",d,".mask|0:-1");return[f,g,p]});case "stencil.opFront":case "stencil.opBack":return b(function(c){l.commandType(c,
"object",m,d.commandStr);var e=c.fail||"keep",f=c.zfail||"keep";c=c.zpass||"keep";l.commandParameter(e,D,a+".fail",d.commandStr);l.commandParameter(f,D,a+".zfail",d.commandStr);l.commandParameter(c,D,a+".zpass",d.commandStr);return["stencil.opBack"===a?1029:1028,D[e],D[f],D[c]]},function(c,d,e){function f(p){l.optional(function(){c.assert(d,'!("'+p+'" in '+e+")||("+e+"."+p+" in "+g+")","invalid "+a+"."+p+", must be one of "+Object.keys(D))});return d.def('"',p,'" in ',e,"?",g,"[",e,".",p,"]:",7680)}
var g=c.constants.stencilOps;l.optional(function(){c.assert(d,e+"&&typeof "+e+'==="object"',"invalid "+a)});return["stencil.opBack"===a?1029:1028,f("fail"),f("zfail"),f("zpass")]});case "polygonOffset.offset":return b(function(c){l.commandType(c,"object",m,d.commandStr);var a=c.factor|0;c=c.units|0;l.commandType(a,"number",m+".factor",d.commandStr);l.commandType(c,"number",m+".units",d.commandStr);return[a,c]},function(c,d,e){l.optional(function(){c.assert(d,e+"&&typeof "+e+'==="object"',"invalid "+
a)});var f=d.def(e,".factor|0"),g=d.def(e,".units|0");return[f,g]});case "cull.face":return b(function(c){var a=0;"front"===c?a=1028:"back"===c&&(a=1029);l.command(!!a,m,d.commandStr);return a},function(c,a,d){l.optional(function(){c.assert(a,d+'==="front"||'+d+'==="back"',"invalid cull.face")});return a.def(d,'==="front"?',1028,":",1029)});case "lineWidth":return b(function(c){l.command("number"===typeof c&&c>=h.lineWidthDims[0]&&c<=h.lineWidthDims[1],"invalid line width, must positive number between "+
h.lineWidthDims[0]+" and "+h.lineWidthDims[1],d.commandStr);return c},function(c,a,d){l.optional(function(){c.assert(a,"typeof "+d+'==="number"&&'+d+">="+h.lineWidthDims[0]+"&&"+d+"<="+h.lineWidthDims[1],"invalid line width")});return d});case "frontFace":return b(function(c){l.commandParameter(c,w,m,d.commandStr);return w[c]},function(c,a,d){l.optional(function(){c.assert(a,d+'==="cw"||'+d+'==="ccw"',"invalid frontFace, must be one of cw,ccw")});return a.def(d+'==="cw"?2304:2305')});case "colorMask":return b(function(c){l.command(g(c)&&
4===c.length,"color.mask must be length 4 array",d.commandStr);return c.map(function(c){return!!c})},function(c,a,d){l.optional(function(){c.assert(a,c.shared.isArrayLike+"("+d+")&&"+d+".length===4","invalid color.mask")});return v(4,function(c){return"!!"+d+"["+c+"]"})});case "sample.coverage":return b(function(c){l.command("object"===typeof c&&c,m,d.commandStr);var a="value"in c?c.value:1;c=!!c.invert;l.command("number"===typeof a&&0<=a&&1>=a,"sample.coverage.value must be a number between 0 and 1",
d.commandStr);return[a,c]},function(c,a,d){l.optional(function(){c.assert(a,d+"&&typeof "+d+'==="object"',"invalid sample.coverage")});var e=a.def('"value" in ',d,"?+",d,".value:1"),f=a.def("!!",d,".invert");return[e,f]})}});return p}function na(c,a){var d=c["static"],e=c.dynamic,f={};Object.keys(d).forEach(function(c){var e=d[c],p;if("number"===typeof e||"boolean"===typeof e)p=n(function(){return e});else if("function"===typeof e){var b=e._reglType;"texture2d"===b||"textureCube"===b?p=n(function(c){return c.link(e)}):
"framebuffer"===b||"framebufferCube"===b?(l.command(0<e.color.length,'missing color attachment for framebuffer sent to uniform "'+c+'"',a.commandStr),p=n(function(c){return c.link(e.color[0])})):l.commandRaise('invalid data for uniform "'+c+'"',a.commandStr)}else g(e)?p=n(function(a){return a.global.def("[",v(e.length,function(d){l.command("number"===typeof e[d]||"boolean"===typeof e[d],"invalid uniform "+c,a.commandStr);return e[d]}),"]")}):l.commandRaise('invalid or missing data for uniform "'+
c+'"',a.commandStr);p.value=e;f[c]=p});Object.keys(e).forEach(function(c){var a=e[c];f[c]=k(a,function(c,d){return c.invoke(d,a)})});return f}function oa(c,a){var d=c["static"],e=c.dynamic,f={};Object.keys(d).forEach(function(c){var e=d[c],b=m.id(c),k=new pa;if(t(e))k.state=1,k.buffer=q.getBuffer(q.create(e,34962,!1,!0)),k.type=0;else{var y=q.getBuffer(e);if(y)k.state=1,k.buffer=y,k.type=0;else if(l.command("object"===typeof e&&e,"invalid data for attribute "+c,a.commandStr),e.constant){var w=e.constant;
k.buffer="null";k.state=2;"number"===typeof w?k.x=w:(l.command(g(w)&&0<w.length&&4>=w.length,"invalid constant for attribute "+c,a.commandStr),x.forEach(function(c,a){a<w.length&&(k[c]=w[a])}))}else{y=t(e.buffer)?q.getBuffer(q.create(e.buffer,34962,!1,!0)):q.getBuffer(e.buffer);l.command(!!y,'missing buffer for attribute "'+c+'"',a.commandStr);var B=e.offset|0;l.command(0<=B,'invalid offset for attribute "'+c+'"',a.commandStr);var u=e.stride|0;l.command(0<=u&&256>u,'invalid stride for attribute "'+
c+'", must be integer betweeen [0, 255]',a.commandStr);var z=e.size|0;l.command(!("size"in e)||0<z&&4>=z,'invalid size for attribute "'+c+'", must be 1,2,3,4',a.commandStr);var r=!!e.normalized,v=0;"type"in e&&(l.commandParameter(e.type,p,"invalid type for attribute "+c,a.commandStr),v=p[e.type]);var H=e.divisor|0;"divisor"in e&&(l.command(0===H||za,'cannot specify divisor for attribute "'+c+'", instancing not supported',a.commandStr),l.command(0<=H,'invalid divisor for attribute "'+c+'"',a.commandStr));
l.optional(function(){var d=a.commandStr,f="buffer offset divisor normalized type size stride".split(" ");Object.keys(e).forEach(function(a){l.command(0<=f.indexOf(a),'unknown parameter "'+a+'" for attribute pointer "'+c+'" (valid parameters are '+f+")",d)})});k.buffer=y;k.state=1;k.size=z;k.normalized=r;k.type=v||y.dtype;k.offset=B;k.stride=u;k.divisor=H}}f[c]=n(function(c,a){var d=c.attribCache;if(b in d)return d[b];var e={isStream:!1};Object.keys(k).forEach(function(c){e[c]=k[c]});k.buffer&&(e.buffer=
c.link(k.buffer),e.type=e.type||e.buffer+".dtype");return d[b]=e})});Object.keys(e).forEach(function(c){var a=e[c];f[c]=k(a,function(d,e){function f(c){e(k[c],"=",g,".",c,"|0;")}var g=d.invoke(e,a),p=d.shared,b=p.isBufferArgs,n=p.buffer;l.optional(function(){d.assert(e,g+"&&(typeof "+g+'==="object"||typeof '+g+'==="function")&&('+b+"("+g+")||"+n+".getBuffer("+g+")||"+n+".getBuffer("+g+".buffer)||"+b+"("+g+'.buffer)||("constant" in '+g+"&&(typeof "+g+'.constant==="number"||'+p.isArrayLike+"("+g+".constant))))",
'invalid dynamic attribute "'+c+'"')});var k={isStream:e.def(!1)},m=new pa;m.state=1;Object.keys(m).forEach(function(c){k[c]=e.def(""+m[c])});var y=k.buffer,w=k.type;e("if(",b,"(",g,")){",k.isStream,"=true;",y,"=",n,".createStream(",34962,",",g,");",w,"=",y,".dtype;","}else{",y,"=",n,".getBuffer(",g,");","if(",y,"){",w,"=",y,".dtype;",'}else if("constant" in ',g,"){",k.state,"=",2,";","if(typeof "+g+'.constant === "number"){',k[x[0]],"=",g,".constant;",x.slice(1).map(function(c){return k[c]}).join("="),
"=0;","}else{",x.map(function(c,a){return k[c]+"="+g+".constant.length>="+a+"?"+g+".constant["+a+"]:0;"}).join(""),"}}else{","if(",b,"(",g,".buffer)){",y,"=",n,".createStream(",34962,",",g,".buffer);","}else{",y,"=",n,".getBuffer(",g,".buffer);","}",w,'="type" in ',g,"?",p.glTypes,"[",g,".type]:",y,".dtype;",k.normalized,"=!!",g,".normalized;");f("size");f("offset");f("stride");f("divisor");e("}}");e.exit("if(",k.isStream,"){",n,".destroyStream(",y,");","}");return k})});return f}function sa(c){var a=
c["static"],d=c.dynamic,e={};Object.keys(a).forEach(function(c){var d=a[c];e[c]=n(function(c,a){return"number"===typeof d||"boolean"===typeof d?""+d:c.link(d)})});Object.keys(d).forEach(function(c){var a=d[c];e[c]=k(a,function(c,d){return c.invoke(d,a)})});return e}function ca(c,a,d,e,f){function g(c){var a=k[c];a&&(y[c]=a)}var p=c["static"],b=c.dynamic;l.optional(function(){function c(d){Object.keys(d).forEach(function(c){l.command(0<=a.indexOf(c),'unknown parameter "'+c+'"',f.commandStr)})}var a=
"framebuffer vert frag elements primitive offset count instances profile".split(" ").concat(Ba);c(p);c(b)});var n=da(c,f),k=Y(c,n,f),m=la(c,f),y=ma(c,f),x=ha(c,f);g("viewport");g(T("scissor.box"));var w=0<Object.keys(y).length,n={framebuffer:n,draw:m,shader:x,state:y,dirty:w};n.profile=S(c,f);n.uniforms=na(d,f);n.attributes=oa(a,f);n.context=sa(e,f);return n}function ea(c,a,d){var e=c.shared.context,f=c.scope();Object.keys(d).forEach(function(g){a.save(e,"."+g);f(e,".",g,"=",d[g].append(c,a),";")});
a(f)}function ja(c,a,d,e){var f=c.shared,g=f.gl,p=f.framebuffer,b;Ga&&(b=a.def(f.extensions,".webgl_draw_buffers"));var l=c.constants,f=l.drawBuffer,l=l.backBuffer;c=d?d.append(c,a):a.def(p,".next");e||a("if(",c,"!==",p,".cur){");a("if(",c,"){",g,".bindFramebuffer(",36160,",",c,".framebuffer);");Ga&&a(b,".drawBuffersWEBGL(",f,"[",c,".colorAttachments.length]);");a("}else{",g,".bindFramebuffer(",36160,",null);");Ga&&a(b,".drawBuffersWEBGL(",l,");");a("}",p,".cur=",c,";");e||a("}")}function ba(c,a,
d){var e=c.shared,f=e.gl,g=c.current,p=c.next,b=e.current,l=e.next,n=c.cond(b,".dirty");Ba.forEach(function(a){a=T(a);if(!(a in d.state)){var e,k;if(a in p){e=p[a];k=g[a];var m=v(ua[a].length,function(c){return n.def(e,"[",c,"]")});n(c.cond(m.map(function(c,a){return c+"!=="+k+"["+a+"]"}).join("||")).then(f,".",wa[a],"(",m,");",m.map(function(c,a){return k+"["+a+"]="+c}).join(";"),";"))}else e=n.def(l,".",a),m=c.cond(e,"!==",b,".",a),n(m),a in va?m(c.cond(e).then(f,".enable(",va[a],");")["else"](f,
".disable(",va[a],");"),b,".",a,"=",e,";"):m(f,".",wa[a],"(",e,");",b,".",a,"=",e,";")}});0===Object.keys(d.state).length&&n(b,".dirty=false;");a(n)}function V(c,d,e,f){var p=c.shared,b=c.current,l=p.current,n=p.gl;r(Object.keys(e)).forEach(function(p){var k=e[p];if(!f||f(k)){var m=k.append(c,d);if(va[p]){var y=va[p];a(k)?m?d(n,".enable(",y,");"):d(n,".disable(",y,");"):d(c.cond(m).then(n,".enable(",y,");")["else"](n,".disable(",y,");"));d(l,".",p,"=",m,";")}else if(g(m)){var x=b[p];d(n,".",wa[p],
"(",m,");",m.map(function(c,a){return x+"["+a+"]="+c}).join(";"),";")}else d(n,".",wa[p],"(",m,");",l,".",p,"=",m,";")}})}function fa(c,a){za&&(c.instancing=a.def(c.shared.extensions,".angle_instanced_arrays"))}function ia(c,d,e,f,g){function p(){return"undefined"===typeof performance?"Date.now()":"performance.now()"}function b(c){w=d.def();c(w,"=",p(),";");"string"===typeof g?c(m,".count+=",g,";"):c(m,".count++;");aa&&(f?(B=d.def(),c(B,"=",x,".getNumPendingQueries();")):c(x,".beginQuery(",m,");"))}
function l(c){c(m,".cpuTime+=",p(),"-",w,";");aa&&(f?c(x,".pushScopeStats(",B,",",x,".getNumPendingQueries(),",m,");"):c(x,".endQuery();"))}function n(c){var a=d.def(y,".profile");d(y,".profile=",c,";");d.exit(y,".profile=",a,";")}var k=c.shared,m=c.stats,y=k.current,x=k.timer;e=e.profile;var w,B;if(e){if(a(e)){e.enable?(b(d),l(d.exit),n("true")):n("false");return}e=e.append(c,d);n(e)}else e=d.def(y,".profile");k=c.block();b(k);d("if(",e,"){",k,"}");c=c.block();l(c);d.exit("if(",e,"){",c,"}")}function ta(c,
a,d,e,f){function g(c){switch(c){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}function p(d,e,f){function g(){a("if(!",m,".buffer){",n,".enableVertexAttribArray(",k,");}");var d=f.type,p;p=f.size?a.def(f.size,"||",e):e;a("if(",m,".type!==",d,"||",m,".size!==",p,"||",B.map(function(c){return m+"."+c+"!=="+f[c]}).join("||"),"){",n,".bindBuffer(",34962,",",y,".buffer);",n,".vertexAttribPointer(",[k,p,d,
f.normalized,f.stride,f.offset],");",m,".type=",d,";",m,".size=",p,";",B.map(function(c){return m+"."+c+"="+f[c]+";"}).join(""),"}");za&&(d=f.divisor,a("if(",m,".divisor!==",d,"){",c.instancing,".vertexAttribDivisorANGLE(",[k,d],");",m,".divisor=",d,";}"))}function l(){a("if(",m,".buffer){",n,".disableVertexAttribArray(",k,");","}if(",x.map(function(c,a){return m+"."+c+"!=="+w[a]}).join("||"),"){",n,".vertexAttrib4f(",k,",",w,");",x.map(function(c,a){return m+"."+c+"="+w[a]+";"}).join(""),"}")}var n=
b.gl,k=a.def(d,".location"),m=a.def(b.attributes,"[",k,"]");d=f.state;var y=f.buffer,w=[f.x,f.y,f.z,f.w],B=["buffer","normalized","offset","stride"];1===d?g():2===d?l():(a("if(",d,"===",1,"){"),g(),a("}else{"),l(),a("}"))}var b=c.shared;e.forEach(function(e){var b=e.name,n=d.attributes[b],k;if(n){if(!f(n))return;k=n.append(c,a)}else{if(!f(E))return;var m=c.scopeAttrib(b);l.optional(function(){c.assert(a,m+".state","missing attribute "+b)});k={};Object.keys(new pa).forEach(function(c){k[c]=a.def(m,
".",c)})}p(c.link(e),g(e.info.type),k)})}function ka(c,d,e,f,p){for(var b=c.shared,n=b.gl,k,y=0;y<f.length;++y){var x=f[y],w=x.name,B=x.info.type,u=e.uniforms[w],x=c.link(x)+".location",z;if(u){if(!p(u))continue;if(a(u)){var r=u.value;l.command(null!==r&&"undefined"!==typeof r,'missing uniform "'+w+'"',c.commandStr);if(35678===B||35680===B)l.command("function"===typeof r&&(35678===B&&("texture2d"===r._reglType||"framebuffer"===r._reglType)||35680===B&&("textureCube"===r._reglType||"framebufferCube"===
r._reglType)),"invalid texture for uniform "+w,c.commandStr),u=c.link(r._texture||r.color[0]._texture),d(n,".uniform1i(",x,",",u+".bind());"),d.exit(u,".unbind();");else if(35674===B||35675===B||35676===B){l.optional(function(){l.command(g(r),"invalid matrix for uniform "+w,c.commandStr);l.command(35674===B&&4===r.length||35675===B&&9===r.length||35676===B&&16===r.length,"invalid length for matrix uniform "+w,c.commandStr)});var u=c.global.def("new Float32Array(["+Array.prototype.slice.call(r)+"])"),
H=2;35675===B?H=3:35676===B&&(H=4);d(n,".uniformMatrix",H,"fv(",x,",false,",u,");")}else{switch(B){case 5126:l.commandType(r,"number","uniform "+w,c.commandStr);k="1f";break;case 35664:l.command(g(r)&&2===r.length,"uniform "+w,c.commandStr);k="2f";break;case 35665:l.command(g(r)&&3===r.length,"uniform "+w,c.commandStr);k="3f";break;case 35666:l.command(g(r)&&4===r.length,"uniform "+w,c.commandStr);k="4f";break;case 35670:l.commandType(r,"boolean","uniform "+w,c.commandStr);k="1i";break;case 5124:l.commandType(r,
"number","uniform "+w,c.commandStr);k="1i";break;case 35671:l.command(g(r)&&2===r.length,"uniform "+w,c.commandStr);k="2i";break;case 35667:l.command(g(r)&&2===r.length,"uniform "+w,c.commandStr);k="2i";break;case 35672:l.command(g(r)&&3===r.length,"uniform "+w,c.commandStr);k="3i";break;case 35668:l.command(g(r)&&3===r.length,"uniform "+w,c.commandStr);k="3i";break;case 35673:l.command(g(r)&&4===r.length,"uniform "+w,c.commandStr);k="4i";break;case 35669:l.command(g(r)&&4===r.length,"uniform "+w,
c.commandStr),k="4i"}d(n,".uniform",k,"(",x,",",g(r)?Array.prototype.slice.call(r):r,");")}continue}else z=u.append(c,d)}else{if(!p(E))continue;z=d.def(b.uniforms,"[",m.id(w),"]")}35678===B?d("if(",z,"&&",z,'._reglType==="framebuffer"){',z,"=",z,".color[0];","}"):35680===B&&d("if(",z,"&&",z,'._reglType==="framebufferCube"){',z,"=",z,".color[0];","}");l.optional(function(){function a(e,f){c.assert(d,e,'bad data or missing for uniform "'+w+'".  '+f)}function e(c){a("typeof "+z+'==="'+c+'"',"invalid type, expected "+
c)}function f(d,e){a(b.isArrayLike+"("+z+")&&"+z+".length==="+d,"invalid vector, should have length "+d,c.commandStr)}function g(d){a("typeof "+z+'==="function"&&'+z+'._reglType==="texture'+(3553===d?"2d":"Cube")+'"',"invalid texture type",c.commandStr)}switch(B){case 5124:e("number");break;case 35667:f(2,"number");break;case 35668:f(3,"number");break;case 35669:f(4,"number");break;case 5126:e("number");break;case 35664:f(2,"number");break;case 35665:f(3,"number");break;case 35666:f(4,"number");break;
case 35670:e("boolean");break;case 35671:f(2,"boolean");break;case 35672:f(3,"boolean");break;case 35673:f(4,"boolean");break;case 35674:f(4,"number");break;case 35675:f(9,"number");break;case 35676:f(16,"number");break;case 35678:g(3553);break;case 35680:g(34067)}});u=1;switch(B){case 35678:case 35680:u=d.def(z,"._texture");d(n,".uniform1i(",x,",",u,".bind());");d.exit(u,".unbind();");continue;case 5124:case 35670:k="1i";break;case 35667:case 35671:k="2i";u=2;break;case 35668:case 35672:k="3i";u=
3;break;case 35669:case 35673:k="4i";u=4;break;case 5126:k="1f";break;case 35664:k="2f";u=2;break;case 35665:k="3f";u=3;break;case 35666:k="4f";u=4;break;case 35674:k="Matrix2fv";break;case 35675:k="Matrix3fv";break;case 35676:k="Matrix4fv"}d(n,".uniform",k,"(",x,",");if("M"===k.charAt(0)){var x=Math.pow(B-35674+2,2),t=c.global.def("new Float32Array(",x,")");d("false,(Array.isArray(",z,")||",z," instanceof Float32Array)?",z,":(",v(x,function(c){return t+"["+c+"]="+z+"["+c+"]"}),",",t,")")}else 1<
u?d(v(u,function(c){return z+"["+c+"]"})):d(z);d(");")}}function qa(c,d,e,f){function g(a){var p=y[a];return p?p.contextDep&&f.contextDynamic||p.propDep?p.append(c,e):p.append(c,d):d.def(m,".",a)}function p(){function c(){e(z,".drawElementsInstancedANGLE(",[x,r,H,B+"<<(("+H+"-5121)>>1)",u],");")}function a(){e(z,".drawArraysInstancedANGLE(",[x,B,r,u],");")}w?t?c():(e("if(",w,"){"),c(),e("}else{"),a(),e("}")):a()}function b(){function c(){e(k+".drawElements("+[x,r,H,B+"<<(("+H+"-5121)>>1)"]+");")}
function a(){e(k+".drawArrays("+[x,B,r]+");")}w?t?c():(e("if(",w,"){"),c(),e("}else{"),a(),e("}")):a()}var n=c.shared,k=n.gl,m=n.draw,y=f.draw,w=function(){var a=y.elements,g=d;if(a){if(a.contextDep&&f.contextDynamic||a.propDep)g=e;a=a.append(c,g)}else a=g.def(m,".","elements");a&&g("if("+a+")"+k+".bindBuffer(34963,"+a+".buffer.buffer);");return a}(),x=g("primitive"),B=g("offset"),r=function(){var a=y.count,g,p=d;if(a){if(a.contextDep&&f.contextDynamic||a.propDep)p=e;g=a.append(c,p);l.optional(function(){a.MISSING&&
c.assert(d,"false","missing vertex count");a.DYNAMIC&&c.assert(p,g+">=0","missing vertex count")})}else g=p.def(m,".","count"),l.optional(function(){c.assert(p,g+">=0","missing vertex count")});return g}();if("number"===typeof r){if(0===r)return}else e("if(",r,"){"),e.exit("}");var u,z;za&&(u=g("instances"),z=c.instancing);var H=w+".type",t=y.elements&&a(y.elements);za&&("number"!==typeof u||0<=u)?"string"===typeof u?(e("if(",u,">0){"),p(),e("}else if(",u,"<0){"),b(),e("}")):p():b()}function xa(c,
a,d,e,f){var g=W();f=g.proc("body",f);l.optional(function(){g.commandStr=a.commandStr;g.command=g.link(a.commandStr)});za&&(g.instancing=f.def(g.shared.extensions,".angle_instanced_arrays"));c(g,f,d,e);return g.compile().body}function Aa(c,a,d,e){fa(c,a);ta(c,a,d,e.attributes,function(){return!0});ka(c,a,d,e.uniforms,function(){return!0});qa(c,a,a,d)}function Ea(c,a){var d=c.proc("draw",1);fa(c,d);ea(c,d,a.context);ja(c,d,a.framebuffer);ba(c,d,a);V(c,d,a.state);ia(c,d,a,!1,!0);var e=a.shader.progVar.append(c,
d);d(c.shared.gl,".useProgram(",e,".program);");if(a.shader.program)Aa(c,d,a,a.shader.program);else{var f=c.global.def("{}"),g=d.def(e,".id"),p=d.def(f,"[",g,"]");d(c.cond(p).then(p,".call(this,a0);")["else"](p,"=",f,"[",g,"]=",c.link(function(d){return xa(Aa,c,a,d,1)}),"(",e,");",p,".call(this,a0);"))}0<Object.keys(a.state).length&&d(c.shared.current,".dirty=true;")}function ya(c,a,d,e){function f(){return!0}c.batchId="a1";fa(c,a);ta(c,a,d,e.attributes,f);ka(c,a,d,e.uniforms,f);qa(c,a,a,d)}function Fa(c,
a,d,e){function f(c){return c.contextDep&&p||c.propDep}function g(c){return!f(c)}fa(c,a);var p=d.contextDep,b=a.def(),n=a.def();c.shared.props=n;c.batchId=b;var k=c.scope(),l=c.scope();a(k.entry,"for(",b,"=0;",b,"<","a1",";++",b,"){",n,"=","a0","[",b,"];",l,"}",k.exit);d.needsContext&&ea(c,l,d.context);d.needsFramebuffer&&ja(c,l,d.framebuffer);V(c,l,d.state,f);d.profile&&f(d.profile)&&ia(c,l,d,!1,!0);e?(ta(c,k,d,e.attributes,g),ta(c,l,d,e.attributes,f),ka(c,k,d,e.uniforms,g),ka(c,l,d,e.uniforms,f),
qa(c,k,l,d)):(a=c.global.def("{}"),e=d.shader.progVar.append(c,l),n=l.def(e,".id"),k=l.def(a,"[",n,"]"),l(c.shared.gl,".useProgram(",e,".program);","if(!",k,"){",k,"=",a,"[",n,"]=",c.link(function(a){return xa(ya,c,d,a,2)}),"(",e,");}",k,".call(this,a0[",b,"],",b,");"))}function Ha(c,a){function d(c){return c.contextDep&&f||c.propDep}var e=c.proc("batch",2);c.batchId="0";fa(c,e);var f=!1,g=!0;Object.keys(a.context).forEach(function(c){f=f||a.context[c].propDep});f||(ea(c,e,a.context),g=!1);var p=
a.framebuffer,b=!1;p?(p.propDep?f=b=!0:p.contextDep&&f&&(b=!0),b||ja(c,e,p)):ja(c,e,null);a.state.viewport&&a.state.viewport.propDep&&(f=!0);ba(c,e,a);V(c,e,a.state,function(c){return!d(c)});a.profile&&d(a.profile)||ia(c,e,a,!1,"a1");a.contextDep=f;a.needsContext=g;a.needsFramebuffer=b;g=a.shader.progVar;if(g.contextDep&&f||g.propDep)Fa(c,e,a,null);else if(g=g.append(c,e),e(c.shared.gl,".useProgram(",g,".program);"),a.shader.program)Fa(c,e,a,a.shader.program);else{var p=c.global.def("{}"),b=e.def(g,
".id"),l=e.def(p,"[",b,"]");e(c.cond(l).then(l,".call(this,a0,a1);")["else"](l,"=",p,"[",b,"]=",c.link(function(d){return xa(Fa,c,a,d,2)}),"(",g,");",l,".call(this,a0,a1);"))}0<Object.keys(a.state).length&&e(c.shared.current,".dirty=true;")}function Ia(c,a){function d(g){var p=a.shader[g];p&&e.set(f.shader,"."+g,p.append(c,e))}var e=c.proc("scope",3);c.batchId="a2";var f=c.shared,p=f.current;ea(c,e,a.context);a.framebuffer&&a.framebuffer.append(c,e);r(Object.keys(a.state)).forEach(function(d){var p=
a.state[d].append(c,e);g(p)?p.forEach(function(a,f){e.set(c.next[d],"["+f+"]",a)}):e.set(f.next,"."+d,p)});ia(c,e,a,!0,!0);["elements","offset","count","instances","primitive"].forEach(function(d){var g=a.draw[d];g&&e.set(f.draw,"."+d,""+g.append(c,e))});Object.keys(a.uniforms).forEach(function(d){e.set(f.uniforms,"["+m.id(d)+"]",a.uniforms[d].append(c,e))});Object.keys(a.attributes).forEach(function(d){var f=a.attributes[d].append(c,e),g=c.scopeAttrib(d);Object.keys(new pa).forEach(function(c){e.set(g,
"."+c,f[c])})});d("vert");d("frag");0<Object.keys(a.state).length&&(e(p,".dirty=true;"),e.exit(p,".dirty=true;"));e("a1(",c.shared.context,",a0,",c.batchId,");")}function Ka(c){if("object"===typeof c&&!g(c)){for(var a=Object.keys(c),e=0;e<a.length;++e)if(d.isDynamic(c[a[e]]))return!0;return!1}}function ra(c,a,e){function f(c,a){b.forEach(function(e){var f=g[e];d.isDynamic(f)&&(f=c.invoke(a,f),a(y,".",e,"=",f,";"))})}var g=a["static"][e];if(g&&Ka(g)){var p=c.global,b=Object.keys(g),l=!1,n=!1,m=!1,
y=c.global.def("{}");b.forEach(function(a){var e=g[a];if(d.isDynamic(e))"function"===typeof e&&(e=g[a]=d.unbox(e)),a=k(e,null),l=l||a.thisDep,m=m||a.propDep,n=n||a.contextDep;else{p(y,".",a,"=");switch(typeof e){case "number":p(e);break;case "string":p('"',e,'"');break;case "object":Array.isArray(e)&&p("[",e.join(),"]");break;default:p(c.link(e))}p(";")}});a.dynamic[e]=new d.DynamicVariable(4,{thisDep:l,contextDep:n,propDep:m,ref:y,append:f});delete a["static"][e]}}var pa=Q.Record,ga={add:32774,subtract:32778,
"reverse subtract":32779};u.ext_blend_minmax&&(ga.min=32775,ga.max=32776);var za=u.angle_instanced_arrays,Ga=u.webgl_draw_buffers,ua={dirty:!0,profile:X.profile},Ca={},Ba=[],va={},wa={};O("dither",3024);O("blend.enable",3042);P("blend.color","blendColor",[0,0,0,0]);P("blend.equation","blendEquationSeparate",[32774,32774]);P("blend.func","blendFuncSeparate",[1,0,1,0]);O("depth.enable",2929,!0);P("depth.func","depthFunc",513);P("depth.range","depthRange",[0,1]);P("depth.mask","depthMask",!0);P("colorMask",
"colorMask",[!0,!0,!0,!0]);O("cull.enable",2884);P("cull.face","cullFace",1029);P("frontFace","frontFace",2305);P("lineWidth","lineWidth",1);O("polygonOffset.enable",32823);P("polygonOffset.offset","polygonOffset",[0,0]);O("sample.alpha",32926);O("sample.enable",32928);P("sample.coverage","sampleCoverage",[1,!1]);O("stencil.enable",2960);P("stencil.mask","stencilMask",-1);P("stencil.func","stencilFunc",[519,0,-1]);P("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]);P("stencil.opBack","stencilOpSeparate",
[1029,7680,7680,7680]);O("scissor.enable",3089);P("scissor.box","scissor",[0,0,b.drawingBufferWidth,b.drawingBufferHeight]);P("viewport","viewport",[0,0,b.drawingBufferWidth,b.drawingBufferHeight]);var Ja={gl:b,context:Z,strings:m,next:Ca,current:ua,draw:U,elements:K,buffer:q,shader:I,attributes:Q.state,uniforms:H,framebuffer:L,extensions:u,timer:aa,isBufferArgs:t},Da={primTypes:f,compareFuncs:y,blendFuncs:C,blendEquations:ga,stencilOps:D,glTypes:p,orientationType:w};l.optional(function(){Ja.isArrayLike=
g});Ga&&(Da.backBuffer=[1029],Da.drawBuffer=v(h.maxDrawbuffers,function(c){return 0===c?[0]:v(c,function(c){return 36064+c})}));var La=0;return{next:Ca,current:ua,procs:function(){var c=W(),a=c.proc("poll"),d=c.proc("refresh"),e=c.block();a(e);d(e);var f=c.shared,p=f.gl,l=f.next,n=f.current;e(n,".dirty=false;");ja(c,a);ja(c,d,null,!0);var k=b.getExtension("angle_instanced_arrays"),m;k&&(m=c.link(k));for(var y=0;y<h.maxAttributes;++y){var w=d.def(f.attributes,"[",y,"]"),x=c.cond(w,".buffer");x.then(p,
".enableVertexAttribArray(",y,");",p,".bindBuffer(",34962,",",w,".buffer.buffer);",p,".vertexAttribPointer(",y,",",w,".size,",w,".type,",w,".normalized,",w,".stride,",w,".offset);")["else"](p,".disableVertexAttribArray(",y,");",p,".vertexAttrib4f(",y,",",w,".x,",w,".y,",w,".z,",w,".w);",w,".buffer=null;");d(x);k&&d(m,".vertexAttribDivisorANGLE(",y,",",w,".divisor);")}Object.keys(va).forEach(function(f){var g=va[f],b=e.def(l,".",f),k=c.block();k("if(",b,"){",p,".enable(",g,")}else{",p,".disable(",
g,")}",n,".",f,"=",b,";");d(k);a("if(",b,"!==",n,".",f,"){",k,"}")});Object.keys(wa).forEach(function(f){var b=wa[f],k=ua[f],m,y,w=c.block();w(p,".",b,"(");g(k)?(b=k.length,m=c.global.def(l,".",f),y=c.global.def(n,".",f),w(v(b,function(c){return m+"["+c+"]"}),");",v(b,function(c){return y+"["+c+"]="+m+"["+c+"];"}).join("")),a("if(",v(b,function(c){return m+"["+c+"]!=="+y+"["+c+"]"}).join("||"),"){",w,"}")):(m=e.def(l,".",f),y=e.def(n,".",f),w(m,");",n,".",f,"=",m,";"),a("if(",m,"!==",y,"){",w,"}"));
d(w)});return c.compile()}(),compile:function(c,a,d,e,f){var g=W();g.stats=g.link(f);Object.keys(a["static"]).forEach(function(c){ra(g,a,c)});z.forEach(function(a){ra(g,c,a)});d=ca(c,a,d,e,g);Ea(g,d);Ia(g,d);Ha(g,d);return g.compile()}}}},{"./constants/dtypes.json":5,"./constants/primitives.json":6,"./dynamic":9,"./util/check":21,"./util/codegen":23,"./util/is-array-like":26,"./util/is-ndarray":27,"./util/is-typed-array":28,"./util/loop":29}],9:[function(b,h,q){function t(e,b){this.id=a++;this.type=
e;this.data=b}function r(a){if(0===a.length)return[];var e=a.charAt(0),b=a.charAt(a.length-1);if(1<a.length&&e===b&&('"'===e||"'"===e))return['"'+a.substr(1,a.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(e=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(a))return r(a.substr(0,e.index)).concat(r(e[1])).concat(r(a.substr(e.index+e[0].length)));e=a.split(".");if(1===e.length)return['"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];a=[];for(b=0;b<e.length;++b)a=a.concat(r(e[b]));return a}
function e(a){return"["+r(a).join("][")+"]"}var a=0;h.exports={DynamicVariable:t,define:function(a,b){return new t(a,e(b+""))},isDynamic:function(a){return"function"===typeof a&&!a._reglType||a instanceof t},unbox:function(a,e){return"function"===typeof a?new t(0,a):a},accessor:e}},{}],10:[function(b,h,q){var t=b("./util/check"),r=b("./util/is-typed-array"),e=b("./util/is-ndarray"),a=b("./util/values"),n=b("./constants/primitives.json"),k=b("./constants/usage.json");h.exports=function(b,A,v,u){function m(a){this.id=
p++;f[this.id]=this;this.buffer=a;this.primType=4;this.type=this.vertCount=0}function g(a,c,d,f,g,p,k){a.buffer.bind();if(c){var n=k;k||r(c)&&(!e(c)||r(c.data))||(n=A.oes_element_index_uint?5125:5123);v._initBuffer(a.buffer,c,d,n,3)}else b.bufferData(34963,p,d),a.buffer.dtype=n||5121,a.buffer.usage=d,a.buffer.dimension=3,a.buffer.byteLength=p;n=k;if(!k){switch(a.buffer.dtype){case 5121:case 5120:n=5121;break;case 5123:case 5122:n=5123;break;case 5125:case 5124:n=5125;break;default:t.raise("unsupported type for element array")}a.buffer.dtype=
n}a.type=n;t(5125!==n||!!A.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");c=g;0>c&&(c=a.buffer.byteLength,5123===n?c>>=1:5125===n&&(c>>=2));a.vertCount=c;c=f;0>f&&(c=4,f=a.buffer.dimension,1===f&&(c=0),2===f&&(c=1),3===f&&(c=4));a.primType=c}function d(a){u.elementsCount--;t(null!==a.buffer,"must not double destroy elements");delete f[a.id];a.buffer.destroy();a.buffer=null}var f={},p=0,x={uint8:5121,uint16:5123};A.oes_element_index_uint&&(x.uint32=
5125);m.prototype.bind=function(){this.buffer.bind()};var z=[];return{create:function(a,c){function f(c){if(c)if("number"===typeof c)p(c),b.primType=4,b.vertCount=c|0,b.type=5121;else{var a=null,d=35044,l=-1,m=-1,u=0,z=0;if(Array.isArray(c)||r(c)||e(c))a=c;else if(t.type(c,"object","invalid arguments for elements"),"data"in c&&(a=c.data,t(Array.isArray(a)||r(a)||e(a),"invalid data for element buffer")),"usage"in c&&(t.parameter(c.usage,k,"invalid element buffer usage"),d=k[c.usage]),"primitive"in
c&&(t.parameter(c.primitive,n,"invalid element buffer primitive"),l=n[c.primitive]),"count"in c&&(t("number"===typeof c.count&&0<=c.count,"invalid vertex count for elements"),m=c.count|0),"type"in c&&(t.parameter(c.type,x,"invalid buffer type"),z=x[c.type]),"length"in c)u=c.length|0;else if(u=m,5123===z||5122===z)u*=2;else if(5125===z||5124===z)u*=4;g(b,a,d,l,m,u,z)}else p(),b.primType=4,b.vertCount=0,b.type=5121;return f}var p=v.create(null,34963,!0),b=new m(p._buffer);u.elementsCount++;f(a);f._reglType=
"elements";f._elements=b;f.subdata=function(c,a){p.subdata(c,a);return f};f.destroy=function(){d(b)};return f},createStream:function(a){var c=z.pop();c||(c=new m(v.create(null,34963,!0,!1)._buffer));g(c,a,35040,-1,-1,0,0);return c},destroyStream:function(a){z.push(a)},getElements:function(a){return"function"===typeof a&&a._elements instanceof m?a._elements:null},clear:function(){a(f).forEach(d)}}}},{"./constants/primitives.json":6,"./constants/usage.json":7,"./util/check":21,"./util/is-ndarray":27,
"./util/is-typed-array":28,"./util/values":33}],11:[function(b,h,q){var t=b("./util/check");h.exports=function(b,e){function a(a){t.type(a,"string","extension name must be string");a=a.toLowerCase();var e;try{e=n[a]=b.getExtension(a)}catch(l){}return!!e}for(var n={},k=0;k<e.extensions.length;++k){var l=e.extensions[k];if(!a(l))return e.onDestroy(),e.onDone('"'+l+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}e.optionalExtensions.forEach(a);
return{extensions:n,restore:function(){Object.keys(n).forEach(function(e){if(!a(e))throw Error("(regl): error restoring extension "+e);})}}}},{"./util/check":21}],12:[function(b,h,q){var t=b("./util/check"),r=b("./util/values"),e=b("./util/extend"),a=[6408],n=[];n[6408]=4;var k=[];k[5121]=1;k[5126]=4;k[36193]=2;var l=[32854,32855,36194,35907,34842,34843,34836],A={36053:"complete",36054:"incomplete attachment",36057:"incomplete dimensions",36055:"incomplete, missing attachment",36061:"unsupported"};
h.exports=function(b,u,m,g,d,f){function p(c,a,d){this.target=c;this.texture=a;this.renderbuffer=d;var e=c=0;a?(c=a.width,e=a.height):d&&(c=d.width,e=d.height);this.width=c;this.height=e}function x(c){c&&(c.texture&&c.texture._texture.decRef(),c.renderbuffer&&c.renderbuffer._renderbuffer.decRef())}function z(c,a,d){if(c){if(c.texture){c=c.texture._texture;var e=Math.max(1,c.height);t(Math.max(1,c.width)===a&&e===d,"inconsistent width/height for supplied texture")}else c=c.renderbuffer._renderbuffer,
t(c.width===a&&c.height===d,"inconsistent width/height for renderbuffer");c.refCount+=1}}function C(c,a){a&&(a.texture?b.framebufferTexture2D(36160,c,a.target,a.texture._texture.texture,0):b.framebufferRenderbuffer(36160,c,36161,a.renderbuffer._renderbuffer.renderbuffer))}function c(c){var a=3553,d=null,e=null,f=c;"object"===typeof c&&(f=c.data,"target"in c&&(a=c.target|0));t.type(f,"function","invalid attachment data");c=f._reglType;"texture2d"===c?(d=f,t(3553===a)):"textureCube"===c?(d=f,t(34069<=
a&&34075>a,"invalid cube map target")):"renderbuffer"===c?(e=f,a=36161):t.raise("invalid regl object for attachment");return new p(a,d,e)}function y(c,a,e,f,b){if(e)return c=g.create2D({width:c,height:a,format:f,type:b}),c._texture.refCount=0,new p(3553,c,null);c=d.create({width:c,height:a,format:f});c._renderbuffer.refCount=0;return new p(36161,null,c)}function D(c){return c&&(c.texture||c.renderbuffer)}function B(c,a,d){c&&(c.texture?c.texture.resize(a,d):c.renderbuffer&&c.renderbuffer.resize(a,
d))}function w(){this.id=L++;H[this.id]=this;this.framebuffer=b.createFramebuffer();this.height=this.width=0;this.colorAttachments=[];this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function h(c){c.colorAttachments.forEach(x);x(c.depthAttachment);x(c.stencilAttachment);x(c.depthStencilAttachment)}function q(c){var a=c.framebuffer;t(a,"must not double destroy framebuffer");b.deleteFramebuffer(a);c.framebuffer=null;f.framebufferCount--;delete H[c.id]}function G(c){var a;
b.bindFramebuffer(36160,c.framebuffer);var d=c.colorAttachments;for(a=0;a<d.length;++a)C(36064+a,d[a]);for(a=d.length;a<m.maxColorAttachments;++a)b.framebufferTexture2D(36160,36064+a,3553,null,0);b.framebufferTexture2D(36160,33306,3553,null,0);b.framebufferTexture2D(36160,36096,3553,null,0);b.framebufferTexture2D(36160,36128,3553,null,0);C(36096,c.depthAttachment);C(36128,c.stencilAttachment);C(33306,c.depthStencilAttachment);c=b.checkFramebufferStatus(36160);36053!==c&&t.raise("framebuffer configuration not supported, status = "+
A[c]);b.bindFramebuffer(36160,R.next);R.cur=R.next;b.getError()}function F(d,g){function p(d,e){var f;t(R.next!==b,"can not update framebuffer which is currently in use");var g=u.webgl_draw_buffers,x=0,w=0,B=!0,r=!0;f=null;var H=!0,v="rgba",A="uint8",Q=1,C=null,I=null,q=null,F=!1;if("number"===typeof d)x=d|0,w=e|0||x;else if(d){t.type(d,"object","invalid arguments for framebuffer");"shape"in d?(w=d.shape,t(Array.isArray(w)&&2<=w.length,"invalid shape for framebuffer"),x=w[0],w=w[1]):("radius"in d&&
(x=w=d.radius),"width"in d&&(x=d.width),"height"in d&&(w=d.height));if("color"in d||"colors"in d)f=d.color||d.colors,Array.isArray(f)&&t(1===f.length||g,"multiple render targets not supported");if(!f){"colorCount"in d&&(Q=d.colorCount|0,t(0<Q,"invalid color buffer count"));"colorTexture"in d&&(H=!!d.colorTexture,v="rgba4");if("colorType"in d){A=d.colorType;if(H)t(u.oes_texture_float||!("float"===A||"float32"===A),"you must enable OES_texture_float in order to use floating point framebuffer objects"),
t(u.oes_texture_half_float||!("half float"===A||"float16"===A),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects");else if("half float"===A||"float16"===A)t(u.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),v="rgba16f";else if("float"===A||"float32"===A)t(u.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),v="rgba32f";t.oneOf(A,
J,"invalid color type")}if("colorFormat"in d)if(v=d.colorFormat,0<=M.indexOf(v))H=!0;else if(0<=K.indexOf(v))H=!1;else if(H)t.oneOf(d.colorFormat,M,"invalid color format for texture");else t.oneOf(d.colorFormat,K,"invalid color format for renderbuffer")}if("depthTexture"in d||"depthStencilTexture"in d)F=!(!d.depthTexture&&!d.depthStencilTexture),t(!F||u.webgl_depth_texture,"webgl_depth_texture extension not supported");"depth"in d&&("boolean"===typeof d.depth?B=d.depth:(C=d.depth,r=!1));"stencil"in
d&&("boolean"===typeof d.stencil?r=d.stencil:(I=d.stencil,B=!1));"depthStencil"in d&&("boolean"===typeof d.depthStencil?B=r=d.depthStencil:(q=d.depthStencil,r=B=!1))}else x=w=1;var N=g=null,L=null,ba=null;if(Array.isArray(f))g=f.map(c);else if(f)g=[c(f)];else for(g=Array(Q),f=0;f<Q;++f)g[f]=y(x,w,H,v,A);t(u.webgl_draw_buffers||1>=g.length,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers.");t(g.length<=m.maxColorAttachments,"too many color attachments, not supported");
x=x||g[0].width;w=w||g[0].height;C?N=c(C):B&&!r&&(N=y(x,w,F,"depth","uint32"));I?L=c(I):r&&!B&&(L=y(x,w,!1,"stencil","uint8"));q?ba=c(q):!C&&!I&&r&&B&&(ba=y(x,w,F,"depth stencil","depth stencil"));t(1>=!!C+!!I+!!q,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");B=null;for(f=0;f<g.length;++f)z(g[f],x,w),t(!g[f]||g[f].texture&&0<=a.indexOf(g[f].texture._texture.format)||g[f].renderbuffer&&0<=l.indexOf(g[f].renderbuffer._renderbuffer.format),"framebuffer color attachment "+
f+" is invalid"),g[f]&&g[f].texture&&(r=n[g[f].texture._texture.format]*k[g[f].texture._texture.type],null===B?B=r:t(B===r,"all color attachments much have the same number of bits per pixel."));z(N,x,w);t(!N||N.texture&&6402===N.texture._texture.format||N.renderbuffer&&33189===N.renderbuffer._renderbuffer.format,"invalid depth attachment for framebuffer object");z(L,x,w);t(!L||L.renderbuffer&&36168===L.renderbuffer._renderbuffer.format,"invalid stencil attachment for framebuffer object");z(ba,x,w);
t(!ba||ba.texture&&34041===ba.texture._texture.format||ba.renderbuffer&&34041===ba.renderbuffer._renderbuffer.format,"invalid depth-stencil attachment for framebuffer object");h(b);b.width=x;b.height=w;b.colorAttachments=g;b.depthAttachment=N;b.stencilAttachment=L;b.depthStencilAttachment=ba;p.color=g.map(D);p.depth=D(N);p.stencil=D(L);p.depthStencil=D(ba);p.width=b.width;p.height=b.height;G(b);return p}var b=new w;f.framebufferCount++;p(d,g);return e(p,{resize:function(c,a){t(R.next!==b,"can not resize a framebuffer which is currently in use");
var d=c|0,e=a|0||d;if(d===b.width&&e===b.height)return p;for(var f=b.colorAttachments,g=0;g<f.length;++g)B(f[g],d,e);B(b.depthAttachment,d,e);B(b.stencilAttachment,d,e);B(b.depthStencilAttachment,d,e);b.width=p.width=d;b.height=p.height=e;G(b);return p},_reglType:"framebuffer",_framebuffer:b,destroy:function(){q(b);h(b)},bind:function(c){R.setFBO({framebuffer:p},c)}})}var R={cur:null,next:null,dirty:!1,setFBO:null},M=["rgba"],K=["rgba4","rgb565","rgb5 a1"];u.ext_srgb&&K.push("srgba");u.ext_color_buffer_half_float&&
K.push("rgba16f","rgb16f");u.webgl_color_buffer_float&&K.push("rgba32f");var J=["uint8"];u.oes_texture_half_float&&J.push("half float","float16");u.oes_texture_float&&J.push("float","float32");var L=0,H={};return e(R,{getFramebuffer:function(c){return"function"===typeof c&&"framebuffer"===c._reglType&&(c=c._framebuffer,c instanceof w)?c:null},create:F,createCube:function(c){function a(c){var f;t(0>d.indexOf(R.next),"can not update framebuffer which is currently in use");var p=u.webgl_draw_buffers,
b={color:null},l=0,k=null;f="rgba";var n="uint8",m=1;if("number"===typeof c)l=c|0;else if(c){t.type(c,"object","invalid arguments for framebuffer");"shape"in c?(l=c.shape,t(Array.isArray(l)&&2<=l.length,"invalid shape for framebuffer"),t(l[0]===l[1],"cube framebuffer must be square"),l=l[0]):("radius"in c&&(l=c.radius|0),"width"in c?(l=c.width|0,"height"in c&&t(c.height===l,"must be square")):"height"in c&&(l=c.height|0));if("color"in c||"colors"in c)k=c.color||c.colors,Array.isArray(k)&&t(1===k.length||
p,"multiple render targets not supported");k||("colorCount"in c&&(m=c.colorCount|0,t(0<m,"invalid color buffer count")),"colorType"in c&&(t.oneOf(c.colorType,J,"invalid color type"),n=c.colorType),"colorFormat"in c&&(f=c.colorFormat,t.oneOf(c.colorFormat,M,"invalid color format for texture")));"depth"in c&&(b.depth=c.depth);"stencil"in c&&(b.stencil=c.stencil);"depthStencil"in c&&(b.depthStencil=c.depthStencil)}else l=1;if(k)if(Array.isArray(k))for(c=[],f=0;f<k.length;++f)c[f]=k[f];else c=[k];else for(c=
Array(m),k={radius:l,format:f,type:n},f=0;f<m;++f)c[f]=g.createCube(k);b.color=Array(c.length);for(f=0;f<c.length;++f)m=c[f],t("function"===typeof m&&"textureCube"===m._reglType,"invalid cube map"),l=l||m.width,t(m.width===l&&m.height===l,"invalid cube map shape"),b.color[f]={target:34069,data:c[f]};for(f=0;6>f;++f){for(m=0;m<c.length;++m)b.color[m].target=34069+f;0<f&&(b.depth=d[0].depth,b.stencil=d[0].stencil,b.depthStencil=d[0].depthStencil);if(d[f])d[f](b);else d[f]=F(b)}return e(a,{width:l,height:l,
color:c})}var d=Array(6);a(c);return e(a,{faces:d,resize:function(c){var e=c|0;t(0<e&&e<=m.maxCubeMapSize,"invalid radius for cube fbo");if(e===a.width)return a;var f=a.color;for(c=0;c<f.length;++c)f[c].resize(e);for(c=0;6>c;++c)d[c].resize(e);a.width=a.height=e;return a},_reglType:"framebufferCube",destroy:function(){d.forEach(function(c){c.destroy()})}})},clear:function(){r(H).forEach(q)},restore:function(){r(H).forEach(function(c){c.framebuffer=b.createFramebuffer();G(c)})}})}},{"./util/check":21,
"./util/extend":24,"./util/values":33}],13:[function(b,h,q){h.exports=function(b,r){var e=1;r.ext_texture_filter_anisotropic&&(e=b.getParameter(34047));var a=1,n=1;r.webgl_draw_buffers&&(a=b.getParameter(34852),n=b.getParameter(36063));return{colorBits:[b.getParameter(3410),b.getParameter(3411),b.getParameter(3412),b.getParameter(3413)],depthBits:b.getParameter(3414),stencilBits:b.getParameter(3415),subpixelBits:b.getParameter(3408),extensions:Object.keys(r).filter(function(a){return!!r[a]}),maxAnisotropic:e,
maxDrawbuffers:a,maxColorAttachments:n,pointSizeDims:b.getParameter(33901),lineWidthDims:b.getParameter(33902),maxViewportDims:b.getParameter(3386),maxCombinedTextureUnits:b.getParameter(35661),maxCubeMapSize:b.getParameter(34076),maxRenderbufferSize:b.getParameter(34024),maxTextureUnits:b.getParameter(34930),maxTextureSize:b.getParameter(3379),maxAttributes:b.getParameter(34921),maxVertexUniforms:b.getParameter(36347),maxVertexTextureUnits:b.getParameter(35660),maxVaryingVectors:b.getParameter(36348),
maxFragmentUniforms:b.getParameter(36349),glsl:b.getParameter(35724),renderer:b.getParameter(7937),vendor:b.getParameter(7936),version:b.getParameter(7938)}}},{}],14:[function(b,h,q){var t=b("./util/check"),r=b("./util/is-typed-array");h.exports=function(e,a,b,k,l,A){function v(m){var g;null===a.next?(t(l.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),g=5121):(t(null!==a.next.colorAttachments[0].texture,"You cannot read from a renderbuffer"),
g=a.next.colorAttachments[0].texture._texture.type,A.oes_texture_float?t(5121===g||5126===g,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"):t(5121===g,"Reading from a framebuffer is only allowed for the type 'uint8'"));var d=0,f=0,p=k.framebufferWidth,x=k.framebufferHeight,u=null;r(m)?u=m:m&&(t.type(m,"object","invalid arguments to regl.read()"),d=m.x|0,f=m.y|0,t(0<=d&&d<k.framebufferWidth,"invalid x offset for regl.read"),t(0<=f&&f<k.framebufferHeight,"invalid y offset for regl.read"),
p=(m.width||k.framebufferWidth-d)|0,x=(m.height||k.framebufferHeight-f)|0,u=m.data||null);u&&(5121===g?t(u instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):5126===g&&t(u instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'"));t(0<p&&p+d<=k.framebufferWidth,"invalid width for read pixels");t(0<x&&x+f<=k.framebufferHeight,"invalid height for read pixels");b();m=p*x*4;u||(5121===g?u=new Uint8Array(m):
5126===g&&(u=u||new Float32Array(m)));t.isTypedArray(u,"data buffer for regl.read() must be a typedarray");t(u.byteLength>=m,"data buffer for regl.read() too small");e.pixelStorei(3333,4);e.readPixels(d,f,p,x,6408,g,u);return u}function u(e){var g;a.setFBO({framebuffer:e.framebuffer},function(){g=v(e)});return g}return function(a){return a&&"framebuffer"in a?u(a):v(a)}}},{"./util/check":21,"./util/is-typed-array":28}],15:[function(b,h,q){var t=b("./util/check"),r=b("./util/values"),e=[];e[32854]=
2;e[32855]=2;e[36194]=2;e[33189]=2;e[36168]=1;e[34041]=4;e[35907]=4;e[34836]=16;e[34842]=8;e[34843]=6;h.exports=function(a,b,k,l,A){function v(a){this.id=d++;this.refCount=1;this.renderbuffer=a;this.format=32854;this.height=this.width=0;A.profile&&(this.stats={size:0})}function u(d){var e=d.renderbuffer;t(e,"must not double destroy renderbuffer");a.bindRenderbuffer(36161,null);a.deleteRenderbuffer(e);d.renderbuffer=null;d.refCount=0;delete f[d.id];l.renderbufferCount--}var m={rgba4:32854,rgb565:36194,
"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};b.ext_srgb&&(m.srgba=35907);b.ext_color_buffer_half_float&&(m.rgba16f=34842,m.rgb16f=34843);b.webgl_color_buffer_float&&(m.rgba32f=34836);var g=[];Object.keys(m).forEach(function(a){g[m[a]]=a});var d=0,f={};v.prototype.decRef=function(){0>=--this.refCount&&u(this)};A.profile&&(l.getTotalRenderbufferSize=function(){var a=0;Object.keys(f).forEach(function(d){a+=f[d].stats.size});return a});return{create:function(d,b){function n(c,d){var f=
0,b=0,p=32854;"object"===typeof c&&c?("shape"in c?(b=c.shape,t(Array.isArray(b)&&2<=b.length,"invalid renderbuffer shape"),f=b[0]|0,b=b[1]|0):("radius"in c&&(f=b=c.radius|0),"width"in c&&(f=c.width|0),"height"in c&&(b=c.height|0)),"format"in c&&(t.parameter(c.format,m,"invalid renderbuffer format"),p=m[c.format])):"number"===typeof c?(f=c|0,b="number"===typeof d?d|0:f):c?t.raise("invalid arguments to renderbuffer constructor"):f=b=1;t(0<f&&0<b&&f<=k.maxRenderbufferSize&&b<=k.maxRenderbufferSize,"invalid renderbuffer size");
if(f!==u.width||b!==u.height||p!==u.format)return n.width=u.width=f,n.height=u.height=b,u.format=p,a.bindRenderbuffer(36161,u.renderbuffer),a.renderbufferStorage(36161,p,f,b),A.profile&&(u.stats.size=e[u.format]*u.width*u.height),n.format=g[u.format],n}var u=new v(a.createRenderbuffer());f[u.id]=u;l.renderbufferCount++;n(d,b);n.resize=function(c,d){var f=c|0,g=d|0||f;if(f===u.width&&g===u.height)return n;t(0<f&&0<g&&f<=k.maxRenderbufferSize&&g<=k.maxRenderbufferSize,"invalid renderbuffer size");n.width=
u.width=f;n.height=u.height=g;a.bindRenderbuffer(36161,u.renderbuffer);a.renderbufferStorage(36161,u.format,f,g);A.profile&&(u.stats.size=e[u.format]*u.width*u.height);return n};n._reglType="renderbuffer";n._renderbuffer=u;A.profile&&(n.stats=u.stats);n.destroy=function(){u.decRef()};return n},clear:function(){r(f).forEach(u)},restore:function(){r(f).forEach(function(d){d.renderbuffer=a.createRenderbuffer();a.bindRenderbuffer(36161,d.renderbuffer);a.renderbufferStorage(36161,d.format,d.width,d.height)});
a.bindRenderbuffer(36161,null)}}}},{"./util/check":21,"./util/values":33}],16:[function(b,h,q){var t=b("./util/check"),r=b("./util/values");h.exports=function(e,a,b,k){function l(a,d,c,e){this.name=a;this.id=d;this.location=c;this.info=e}function A(a,d){for(var c=0;c<a.length;++c)if(a[c].id===d.id){a[c].location=d.location;return}a.push(d)}function v(f,b,c){var p=35632===f?g:d,l=p[b];if(!l){var k=a.str(b),l=e.createShader(f);e.shaderSource(l,k);e.compileShader(l);t.shaderError(e,l,k,f,c);p[b]=l}return l}
function u(a,d){this.id=x++;this.fragId=a;this.vertId=d;this.program=null;this.uniforms=[];this.attributes=[];k.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function m(d,f){var c,g;c=v(35632,d.fragId);g=v(35633,d.vertId);var b=d.program=e.createProgram();e.attachShader(b,c);e.attachShader(b,g);e.linkProgram(b);t.linkError(e,b,a.str(d.fragId),a.str(d.vertId),f);var p=e.getProgramParameter(b,35718);k.profile&&(d.stats.uniformsCount=p);var n=d.uniforms;for(c=0;c<p;++c)if(g=e.getActiveUniform(b,
c))if(1<g.size)for(var m=0;m<g.size;++m){var x=g.name.replace("[0]","["+m+"]");A(n,new l(x,a.id(x),e.getUniformLocation(b,x),g))}else A(n,new l(g.name,a.id(g.name),e.getUniformLocation(b,g.name),g));p=e.getProgramParameter(b,35721);k.profile&&(d.stats.attributesCount=p);n=d.attributes;for(c=0;c<p;++c)(g=e.getActiveAttrib(b,c))&&A(n,new l(g.name,a.id(g.name),e.getAttribLocation(b,g.name),g))}var g={},d={},f={},p=[],x=0;k.profile&&(b.getMaxUniformsCount=function(){var a=0;p.forEach(function(d){d.stats.uniformsCount>
a&&(a=d.stats.uniformsCount)});return a},b.getMaxAttributesCount=function(){var a=0;p.forEach(function(d){d.stats.attributesCount>a&&(a=d.stats.attributesCount)});return a});return{clear:function(){var a=e.deleteShader.bind(e);r(g).forEach(a);g={};r(d).forEach(a);d={};p.forEach(function(a){e.deleteProgram(a.program)});p.length=0;f={};b.shaderCount=0},program:function(a,d,c){t.command(0<=a,"missing vertex shader",c);t.command(0<=d,"missing fragment shader",c);var e=f[d];e||(e=f[d]={});var g=e[a];g||
(g=new u(d,a),b.shaderCount++,m(g,c),e[a]=g,p.push(g));return g},restore:function(){g={};d={};for(var a=0;a<p.length;++a)m(p[a])},shader:v,frag:-1,vert:-1}}},{"./util/check":21,"./util/values":33}],17:[function(b,h,q){h.exports=function(){return{bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}},{}],18:[function(b,h,q){h.exports=function(){var b={"":0},r=[""];return{id:function(e){var a=b[e];if(a)return a;a=b[e]=r.length;
r.push(e);return a},str:function(e){return r[e]}}}},{}],19:[function(b,h,q){function t(c){return Array.isArray(c)&&(0===c.length||"number"===typeof c[0])}function r(c){return Array.isArray(c)&&0!==c.length&&f(c[0])?!0:!1}function e(c){return Object.prototype.toString.call(c)}function a(c){if(!c)return!1;var a=e(c);return 0<=y.indexOf(a)?!0:t(c)||r(c)||m(c)}function n(c,a){36193===c.type?(c.data=d(a),g.freeType(a)):c.data=a}function k(a,d,e,f,g,b){a="undefined"!==typeof B[a]?B[a]:c[a]*D[d];b&&(a*=
6);if(g){for(f=0;1<=e;)f+=a*e*e,e/=2;return f}return a*e*f}var l=b("./util/check"),A=b("./util/extend"),v=b("./util/values"),u=b("./util/is-typed-array"),m=b("./util/is-ndarray"),g=b("./util/pool"),d=b("./util/to-half-float"),f=b("./util/is-array-like"),p=b("./util/flatten");q=b("./constants/arraytypes.json");var x=b("./constants/arraytypes.json"),z=[9984,9986,9985,9987],C=[0,6409,6410,6407,6408],c={};c[6409]=c[6406]=c[6402]=1;c[34041]=c[6410]=2;c[6407]=c[35904]=3;c[6408]=c[35906]=4;var y=Object.keys(q).concat(["[object HTMLCanvasElement]",
"[object CanvasRenderingContext2D]","[object HTMLImageElement]","[object HTMLVideoElement]"]),D=[];D[5121]=1;D[5126]=4;D[36193]=2;D[5123]=2;D[5125]=4;var B=[];B[32854]=2;B[32855]=2;B[36194]=2;B[34041]=4;B[33776]=.5;B[33777]=.5;B[33778]=1;B[33779]=1;B[35986]=.5;B[35987]=1;B[34798]=1;B[35840]=.5;B[35841]=.25;B[35842]=.5;B[35843]=.25;B[36196]=.5;h.exports=function(b,y,B,D,h,q,M){function K(){this.format=this.internalformat=6408;this.type=5121;this.flipY=this.premultiplyAlpha=this.compressed=!1;this.unpackAlignment=
1;this.channels=this.height=this.width=this.colorSpace=0}function J(c,a){c.internalformat=a.internalformat;c.format=a.format;c.type=a.type;c.compressed=a.compressed;c.premultiplyAlpha=a.premultiplyAlpha;c.flipY=a.flipY;c.unpackAlignment=a.unpackAlignment;c.colorSpace=a.colorSpace;c.width=a.width;c.height=a.height;c.channels=a.channels}function L(a,d){if("object"===typeof d&&d){"premultiplyAlpha"in d&&(l.type(d.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),a.premultiplyAlpha=d.premultiplyAlpha);
"flipY"in d&&(l.type(d.flipY,"boolean","invalid texture flip"),a.flipY=d.flipY);"alignment"in d&&(l.oneOf(d.alignment,[1,2,4,8],"invalid texture unpack alignment"),a.unpackAlignment=d.alignment);"colorSpace"in d&&(l.parameter(d.colorSpace,ba,"invalid colorSpace"),a.colorSpace=ba[d.colorSpace]);if("type"in d){var e=d.type;l(y.oes_texture_float||!("float"===e||"float32"===e),"you must enable the OES_texture_float extension in order to use floating point textures.");l(y.oes_texture_half_float||!("half float"===
e||"float16"===e),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures.");l(y.webgl_depth_texture||!("uint16"===e||"uint32"===e||"depth stencil"===e),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures.");l.parameter(e,V,"invalid texture type");a.type=V[e]}var f=a.width,b=a.height,g=a.channels,e=!1;"shape"in d?(l(Array.isArray(d.shape)&&2<=d.shape.length,"shape must be an array"),f=d.shape[0],b=d.shape[1],3===d.shape.length&&
(g=d.shape[2],l(0<g&&4>=g,"invalid number of channels"),e=!0),l(0<=f&&f<=B.maxTextureSize,"invalid width"),l(0<=b&&b<=B.maxTextureSize,"invalid height")):("radius"in d&&(f=b=d.radius,l(0<=f&&f<=B.maxTextureSize,"invalid radius")),"width"in d&&(f=d.width,l(0<=f&&f<=B.maxTextureSize,"invalid width")),"height"in d&&(b=d.height,l(0<=b&&b<=B.maxTextureSize,"invalid height")),"channels"in d&&(g=d.channels,l(0<g&&4>=g,"invalid number of channels"),e=!0));a.width=f|0;a.height=b|0;a.channels=g|0;f=!1;"format"in
d&&(f=d.format,l(y.webgl_depth_texture||!("depth"===f||"depth stencil"===f),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),l.parameter(f,fa,"invalid texture format"),b=a.internalformat=fa[f],a.format=Fa[b],f in V&&!("type"in d)&&(a.type=V[f]),f in ia&&(a.compressed=!0),f=!0);!e&&f?a.channels=c[a.format]:e&&!f?a.channels!==C[a.format]&&(a.format=a.internalformat=C[a.channels]):f&&e&&l(a.channels===c[a.format],"number of channels inconsistent with specified format")}}
function H(c){b.pixelStorei(37440,c.flipY);b.pixelStorei(37441,c.premultiplyAlpha);b.pixelStorei(37443,c.colorSpace);b.pixelStorei(3317,c.unpackAlignment)}function Q(){K.call(this);this.yOffset=this.xOffset=0;this.data=null;this.needsFree=!1;this.element=null;this.needsCopy=!1}function I(c,b){var k=null;a(b)?k=b:b&&(l.type(b,"object","invalid pixel data type"),L(c,b),"x"in b&&(c.xOffset=b.x|0),"y"in b&&(c.yOffset=b.y|0),a(b.data)&&(k=b.data));l(!c.compressed||k instanceof Uint8Array,"compressed texture data must be stored in a uint8array");
if(b.copy){l(!k,"can not specify copy and data field for the same texture");var y=h.viewportWidth,w=h.viewportHeight;c.width=c.width||y-c.xOffset;c.height=c.height||w-c.yOffset;c.needsCopy=!0;l(0<=c.xOffset&&c.xOffset<y&&0<=c.yOffset&&c.yOffset<w&&0<c.width&&c.width<=y&&0<c.height&&c.height<=w,"copy texture read out of bounds")}else if(!k)c.width=c.width||1,c.height=c.height||1,c.channels=c.channels||4;else if(u(k))c.channels=c.channels||4,c.data=k,"type"in b||5121!==c.type||(c.type=x[Object.prototype.toString.call(k)]|
0);else if(t(k)){c.channels=c.channels||4;y=k;w=y.length;switch(c.type){case 5121:case 5123:case 5125:case 5126:w=g.allocType(c.type,w);w.set(y);c.data=w;break;case 36193:c.data=d(y);break;default:l.raise("unsupported texture type, must specify a typed array")}c.alignment=1;c.needsFree=!0}else if(m(k)){y=k.data;Array.isArray(y)||5121!==c.type||(c.type=x[Object.prototype.toString.call(y)]|0);var w=k.shape,H=k.stride,A,v,z,D;3===w.length?(z=w[2],D=H[2]):(l(2===w.length,"invalid ndarray pixel data, must be 2 or 3D"),
D=z=1);A=w[0];v=w[1];w=H[0];H=H[1];c.alignment=1;c.width=A;c.height=v;c.channels=z;c.format=c.internalformat=C[z];c.needsFree=!0;A=D;k=k.offset;z=c.width;D=c.height;v=c.channels;for(var Q=g.allocType(36193===c.type?5126:c.type,z*D*v),I=0,E=0;E<D;++E)for(var q=0;q<z;++q)for(var U=0;U<v;++U)Q[I++]=y[w*q+H*E+A*U+k];n(c,Q)}else if("[object HTMLCanvasElement]"===e(k)||"[object CanvasRenderingContext2D]"===e(k))"[object HTMLCanvasElement]"===e(k)?c.element=k:c.element=k.canvas,c.width=c.element.width,c.height=
c.element.height,c.channels=4;else if("[object HTMLImageElement]"===e(k))c.element=k,c.width=k.naturalWidth,c.height=k.naturalHeight,c.channels=4;else if("[object HTMLVideoElement]"===e(k))c.element=k,c.width=k.videoWidth,c.height=k.videoHeight,c.channels=4;else if(r(k)){y=c.width||k[0].length;w=c.height||k.length;H=c.channels;H=f(k[0][0])?H||k[0][0].length:H||1;A=p.shape(k);z=1;for(D=0;D<A.length;++D)z*=A[D];z=g.allocType(36193===c.type?5126:c.type,z);p.flatten(k,A,"",z);n(c,z);c.alignment=1;c.width=
y;c.height=w;c.channels=H;c.format=c.internalformat=C[H];c.needsFree=!0}5126===c.type?l(0<=B.extensions.indexOf("oes_texture_float"),"oes_texture_float extension not enabled"):36193===c.type&&l(0<=B.extensions.indexOf("oes_texture_half_float"),"oes_texture_half_float extension not enabled")}function U(c,a,d,e,f){var g=c.element,p=c.data,k=c.internalformat,l=c.format,n=c.type,m=c.width,y=c.height;H(c);g?b.texSubImage2D(a,f,d,e,l,n,g):c.compressed?b.compressedTexSubImage2D(a,f,d,e,k,m,y,p):c.needsCopy?
(D(),b.copyTexSubImage2D(a,f,d,e,c.xOffset,c.yOffset,m,y)):b.texSubImage2D(a,f,d,e,m,y,l,n,p)}function Z(){return Ha.pop()||new Q}function aa(c){c.needsFree&&g.freeType(c.data);Q.call(c);Ha.push(c)}function X(){K.call(this);this.genMipmaps=!1;this.mipmapHint=4352;this.mipmask=0;this.images=Array(16)}function T(c,a,d){var e=c.images[0]=Z();c.mipmask=1;e.width=c.width=a;e.height=c.height=d;e.channels=c.channels=4}function O(c,d){var e=null;if(a(d))e=c.images[0]=Z(),J(e,c),I(e,d),c.mipmask=1;else if(L(c,
d),Array.isArray(d.mipmap))for(var f=d.mipmap,b=0;b<f.length;++b)e=c.images[b]=Z(),J(e,c),e.width>>=b,e.height>>=b,I(e,f[b]),c.mipmask|=1<<b;else e=c.images[0]=Z(),J(e,c),I(e,d),c.mipmask=1;J(c,c.images[0]);(c.compressed&&33776===c.internalformat||33777===c.internalformat||33778===c.internalformat||33779===c.internalformat)&&l(0===c.width%4&&0===c.height%4,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function P(c,a){for(var d=c.images,e=0;e<
d.length&&d[e];++e){var f=d[e],g=a,p=e,k=f.element,l=f.data,n=f.internalformat,m=f.format,y=f.type,x=f.width,u=f.height;H(f);k?b.texImage2D(g,p,m,m,y,k):f.compressed?b.compressedTexImage2D(g,p,n,x,u,0,l):f.needsCopy?(D(),b.copyTexImage2D(g,p,m,f.xOffset,f.yOffset,x,u,0)):b.texImage2D(g,p,m,x,u,0,m,y,l)}}function W(){var c=Ia.pop()||new X;K.call(c);for(var a=c.mipmask=0;16>a;++a)c.images[a]=null;return c}function S(c){for(var a=c.images,d=0;d<a.length;++d)a[d]&&aa(a[d]),a[d]=null;Ia.push(c)}function da(){this.magFilter=
this.minFilter=9728;this.wrapT=this.wrapS=33071;this.anisotropic=1;this.genMipmaps=!1;this.mipmapHint=4352}function Y(c,a){if("min"in a){var d=a.min;l.parameter(d,ja);c.minFilter=ja[d];0<=z.indexOf(c.minFilter)&&(c.genMipmaps=!0)}"mag"in a&&(d=a.mag,l.parameter(d,ea),c.magFilter=ea[d]);var d=c.wrapS,e=c.wrapT;if("wrap"in a){var f=a.wrap;"string"===typeof f?(l.parameter(f,ca),d=e=ca[f]):Array.isArray(f)&&(l.parameter(f[0],ca),l.parameter(f[1],ca),d=ca[f[0]],e=ca[f[1]])}else"wrapS"in a&&(d=a.wrapS,
l.parameter(d,ca),d=ca[d]),"wrapT"in a&&(e=a.wrapT,l.parameter(e,ca),e=ca[e]);c.wrapS=d;c.wrapT=e;"anisotropic"in a&&(d=a.anisotropic,l("number"===typeof d&&1<=d&&d<=B.maxAnisotropic,"aniso samples must be between 1 and "),c.anisotropic=a.anisotropic);if("mipmap"in a){d=!1;switch(typeof a.mipmap){case "string":l.parameter(a.mipmap,sa,"invalid mipmap hint");c.mipmapHint=sa[a.mipmap];d=c.genMipmaps=!0;break;case "boolean":d=c.genMipmaps=a.mipmap;break;case "object":l(Array.isArray(a.mipmap),"invalid mipmap type");
c.genMipmaps=!1;d=!0;break;default:l.raise("invalid mipmap type")}!d||"min"in a||(c.minFilter=9984)}}function ha(c,a){b.texParameteri(a,10241,c.minFilter);b.texParameteri(a,10240,c.magFilter);b.texParameteri(a,10242,c.wrapS);b.texParameteri(a,10243,c.wrapT);y.ext_texture_filter_anisotropic&&b.texParameteri(a,34046,c.anisotropic);c.genMipmaps&&(b.hint(33170,c.mipmapHint),b.generateMipmap(a))}function la(c){K.call(this);this.mipmask=0;this.internalformat=6408;this.id=Ka++;this.refCount=1;this.target=
c;this.texture=b.createTexture();this.unit=-1;this.bindCount=0;this.texInfo=new da;M.profile&&(this.stats={size:0})}function ma(c){b.activeTexture(33984);b.bindTexture(c.target,c.texture)}function na(){var c=ga[0];c?b.bindTexture(c.target,c.texture):b.bindTexture(3553,null)}function oa(c){var a=c.texture;l(a,"must not double destroy texture");var d=c.unit,e=c.target;0<=d&&(b.activeTexture(33984+d),b.bindTexture(e,null),ga[d]=null);b.deleteTexture(a);c.texture=null;c.params=null;c.pixels=null;c.refCount=
0;delete ra[c.id];q.textureCount--}var sa={"don't care":4352,"dont care":4352,nice:4354,fast:4353},ca={repeat:10497,clamp:33071,mirror:33648},ea={nearest:9728,linear:9729},ja=A({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},ea),ba={none:0,browser:37444},V={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},fa={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},
ia={};y.ext_srgb&&(fa.srgb=35904,fa.srgba=35906);y.oes_texture_float&&(V.float32=V["float"]=5126);y.oes_texture_half_float&&(V.float16=V["half float"]=36193);y.webgl_depth_texture&&(A(fa,{depth:6402,"depth stencil":34041}),A(V,{uint16:5123,uint32:5125,"depth stencil":34042}));y.webgl_compressed_texture_s3tc&&A(ia,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779});y.webgl_compressed_texture_atc&&A(ia,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798});
y.webgl_compressed_texture_pvrtc&&A(ia,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843});y.webgl_compressed_texture_etc1&&(ia["rgb etc1"]=36196);var ta=Array.prototype.slice.call(b.getParameter(34467));Object.keys(ia).forEach(function(c){var a=ia[c];0<=ta.indexOf(a)&&(fa[c]=a)});var ka=Object.keys(fa);B.textureFormats=ka;var qa=[];Object.keys(fa).forEach(function(c){qa[fa[c]]=c});var xa=[];Object.keys(V).forEach(function(c){xa[V[c]]=c});var Aa=
[];Object.keys(ea).forEach(function(c){Aa[ea[c]]=c});var Ea=[];Object.keys(ja).forEach(function(c){Ea[ja[c]]=c});var ya=[];Object.keys(ca).forEach(function(c){ya[ca[c]]=c});var Fa=ka.reduce(function(c,a){var d=fa[a];6409===d||6406===d||6409===d||6410===d||6402===d||34041===d?c[d]=d:32855===d||0<=a.indexOf("rgba")?c[d]=6408:c[d]=6407;return c},{}),Ha=[],Ia=[],Ka=0,ra={},pa=B.maxTextureUnits,ga=Array(pa).map(function(){return null});A(la.prototype,{bind:function(){this.bindCount+=1;var c=this.unit;
if(0>c){for(var a=0;a<pa;++a){var d=ga[a];if(d){if(0<d.bindCount)continue;d.unit=-1}ga[a]=this;c=a;break}c>=pa&&l.raise("insufficient number of texture units");M.profile&&q.maxTextureUnits<c+1&&(q.maxTextureUnits=c+1);this.unit=c;b.activeTexture(33984+c);b.bindTexture(this.target,this.texture)}return c},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&oa(this)}});M.profile&&(q.getTotalTextureSize=function(){var c=0;Object.keys(ra).forEach(function(a){c+=ra[a].stats.size});
return c});return{create2D:function(c,a){function d(c,a){var f=e.texInfo;da.call(f);var b=W();"number"===typeof c?"number"===typeof a?T(b,c|0,a|0):T(b,c|0,c|0):c?(l.type(c,"object","invalid arguments to regl.texture"),Y(f,c),O(b,c)):T(b,1,1);f.genMipmaps&&(b.mipmask=(b.width<<1)-1);e.mipmask=b.mipmask;J(e,b);l.texture2D(f,b,B);e.internalformat=b.internalformat;d.width=b.width;d.height=b.height;ma(e);P(b,3553);ha(f,3553);na();S(b);M.profile&&(e.stats.size=k(e.internalformat,e.type,b.width,b.height,
f.genMipmaps,!1));d.format=qa[e.internalformat];d.type=xa[e.type];d.mag=Aa[f.magFilter];d.min=Ea[f.minFilter];d.wrapS=ya[f.wrapS];d.wrapT=ya[f.wrapT];return d}var e=new la(3553);ra[e.id]=e;q.textureCount++;d(c,a);d.subimage=function(c,a,f,b){l(!!c,"must specify image data");a|=0;f|=0;b|=0;var g=Z();J(g,e);g.width=0;g.height=0;I(g,c);g.width=g.width||(e.width>>b)-a;g.height=g.height||(e.height>>b)-f;l(e.type===g.type&&e.format===g.format&&e.internalformat===g.internalformat,"incompatible format for texture.subimage");
l(0<=a&&0<=f&&a+g.width<=e.width&&f+g.height<=e.height,"texture.subimage write out of bounds");l(e.mipmask&1<<b,"missing mipmap data");l(g.data||g.element||g.needsCopy,"missing image data");ma(e);U(g,3553,a,f,b);na();aa(g);return d};d.resize=function(c,a){var f=c|0,g=a|0||f;if(f===e.width&&g===e.height)return d;d.width=e.width=f;d.height=e.height=g;ma(e);for(var p=0;e.mipmask>>p;++p)b.texImage2D(3553,p,e.format,f>>p,g>>p,0,e.format,e.type,null);na();M.profile&&(e.stats.size=k(e.internalformat,e.type,
f,g,!1,!1));return d};d._reglType="texture2d";d._texture=e;M.profile&&(d.stats=e.stats);d.destroy=function(){e.decRef()};return d},createCube:function(c,a,d,e,f,g){function p(c,a,d,e,f,b){var g,y=n.texInfo;da.call(y);for(g=0;6>g;++g)m[g]=W();if("number"!==typeof c&&c)if("object"===typeof c)if(a)O(m[0],c),O(m[1],a),O(m[2],d),O(m[3],e),O(m[4],f),O(m[5],b);else if(Y(y,c),L(n,c),"faces"in c)for(c=c.faces,l(Array.isArray(c)&&6===c.length,"cube faces must be a length 6 array"),g=0;6>g;++g)l("object"===
typeof c[g]&&!!c[g],"invalid input for cube map face"),J(m[g],n),O(m[g],c[g]);else for(g=0;6>g;++g)O(m[g],c);else l.raise("invalid arguments to cube map");else for(c=c|0||1,g=0;6>g;++g)T(m[g],c,c);J(n,m[0]);n.mipmask=y.genMipmaps?(m[0].width<<1)-1:m[0].mipmask;l.textureCube(n,y,m,B);n.internalformat=m[0].internalformat;p.width=m[0].width;p.height=m[0].height;ma(n);for(g=0;6>g;++g)P(m[g],34069+g);ha(y,34067);na();M.profile&&(n.stats.size=k(n.internalformat,n.type,p.width,p.height,y.genMipmaps,!0));
p.format=qa[n.internalformat];p.type=xa[n.type];p.mag=Aa[y.magFilter];p.min=Ea[y.minFilter];p.wrapS=ya[y.wrapS];p.wrapT=ya[y.wrapT];for(g=0;6>g;++g)S(m[g]);return p}var n=new la(34067);ra[n.id]=n;q.cubeCount++;var m=Array(6);p(c,a,d,e,f,g);p.subimage=function(c,a,d,e,f){l(!!a,"must specify image data");l("number"===typeof c&&c===(c|0)&&0<=c&&6>c,"invalid face");d|=0;e|=0;f|=0;var b=Z();J(b,n);b.width=0;b.height=0;I(b,a);b.width=b.width||(n.width>>f)-d;b.height=b.height||(n.height>>f)-e;l(n.type===
b.type&&n.format===b.format&&n.internalformat===b.internalformat,"incompatible format for texture.subimage");l(0<=d&&0<=e&&d+b.width<=n.width&&e+b.height<=n.height,"texture.subimage write out of bounds");l(n.mipmask&1<<f,"missing mipmap data");l(b.data||b.element||b.needsCopy,"missing image data");ma(n);U(b,34069+c,d,e,f);na();aa(b);return p};p.resize=function(c){c|=0;if(c!==n.width){p.width=n.width=c;p.height=n.height=c;ma(n);for(var a=0;6>a;++a)for(var d=0;n.mipmask>>d;++d)b.texImage2D(34069+a,
d,n.format,c>>d,c>>d,0,n.format,n.type,null);na();M.profile&&(n.stats.size=k(n.internalformat,n.type,p.width,p.height,!1,!0));return p}};p._reglType="textureCube";p._texture=n;M.profile&&(p.stats=n.stats);p.destroy=function(){n.decRef()};return p},clear:function(){for(var c=0;c<pa;++c)b.activeTexture(33984+c),b.bindTexture(3553,null),ga[c]=null;v(ra).forEach(oa);q.cubeCount=0;q.textureCount=0},getTexture:function(c){return null},restore:function(){v(ra).forEach(function(c){c.texture=b.createTexture();
b.bindTexture(c.target,c.texture);for(var a=0;32>a;++a)if(0!==(c.mipmask&1<<a))if(3553===c.target)b.texImage2D(3553,a,c.internalformat,c.width>>a,c.height>>a,0,c.internalformat,c.type,null);else for(var d=0;6>d;++d)b.texImage2D(34069+d,a,c.internalformat,c.width>>a,c.height>>a,0,c.internalformat,c.type,null);ha(c.texInfo,c.target)})}}}},{"./constants/arraytypes.json":4,"./util/check":21,"./util/extend":24,"./util/flatten":25,"./util/is-array-like":26,"./util/is-ndarray":27,"./util/is-typed-array":28,
"./util/pool":30,"./util/to-half-float":32,"./util/values":33}],20:[function(b,h,q){h.exports=function(b,r){function e(){this.endQueryIndex=this.startQueryIndex=-1;this.sum=0;this.stats=null}function a(a,d,f){var b=A.pop()||new e;b.startQueryIndex=a;b.endQueryIndex=d;b.sum=0;b.stats=f;v.push(b)}var n=r.ext_disjoint_timer_query;if(!n)return null;var k=[],l=[],A=[],v=[],u=[],m=[];return{beginQuery:function(e){var d=k.pop()||n.createQueryEXT();n.beginQueryEXT(35007,d);l.push(d);a(l.length-1,l.length,
e)},endQuery:function(){n.endQueryEXT(35007)},pushScopeStats:a,update:function(){var a,d;a=l.length;if(0!==a){m.length=Math.max(m.length,a+1);u.length=Math.max(u.length,a+1);u[0]=0;var e=m[0]=0;for(d=a=0;d<l.length;++d){var b=l[d];n.getQueryObjectEXT(b,34919)?(e+=n.getQueryObjectEXT(b,34918),k.push(b)):l[a++]=b;u[d+1]=e;m[d+1]=a}l.length=a;for(d=a=0;d<v.length;++d){var e=v[d],x=e.startQueryIndex,b=e.endQueryIndex;e.sum+=u[b]-u[x];x=m[x];b=m[b];b===x?(e.stats.gpuTime+=e.sum/1E6,A.push(e)):(e.startQueryIndex=
x,e.endQueryIndex=b,v[a++]=e)}v.length=a}},getNumPendingQueries:function(){return l.length},clear:function(){k.push.apply(k,l);for(var a=0;a<k.length;a++)n.deleteQueryEXT(k[a]);l.length=0;k.length=0},restore:function(){l.length=0;k.length=0}}}},{}],21:[function(b,h,q){function t(c){return"undefined"!==typeof btoa?btoa(c):"base64:"+c}function r(c){c=Error("(regl) "+c);console.error(c);throw c;}function e(c,a){c||r(a)}function a(c){return c?": "+c:""}function n(c,d,e){0>d.indexOf(c)&&r("invalid value"+
a(e)+". must be one of: "+d)}function k(c,a){for(c+="";c.length<a;)c=" "+c;return c}function l(){this.name="unknown";this.lines=[];this.index={};this.hasErrors=!1}function A(c,a){this.number=c;this.line=a;this.errors=[]}function v(c,a,d){this.file=c;this.line=a;this.message=d}function u(){var c=Error(),c=(c.stack||c).toString(),a=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(c);return a?a[1]:(c=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(c))?c[1]:"unknown"}function m(){var c=Error(),c=(c.stack||c).toString(),
a=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(c);return a?a[1]:(c=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(c))?c[1]:"unknown"}function g(c,a){var d=c.split("\n"),e=1,f=0,b={unknown:new l,0:new l};b.unknown.name=b[0].name=a||u();b.unknown.lines.push(new A(0,""));for(var g=0;g<d.length;++g){var p=d[g],k=/^\s*\#\s*(\w+)\s+(.+)\s*$/.exec(p);if(k)switch(k[1]){case "line":if(k=/(\d+)(\s+\d+)?/.exec(k[2]))e=k[1]|0,k[2]&&(f=k[2]|0,f in b||(b[f]=new l));break;case "define":if(k=/SHADER_NAME(_B64)?\s+(.*)$/.exec(k[2]))b[f].name=
k[1]?t(k[2]):k[2]}b[f].lines.push(new A(e++,p))}Object.keys(b).forEach(function(c){var a=b[c];a.lines.forEach(function(c){a.index[c.number]=c})});return b}function d(c){var a=[];c.split("\n").forEach(function(c){if(!(5>c.length)){var d=/^ERROR\:\s+(\d+)\:(\d+)\:\s*(.*)$/.exec(c);d?a.push(new v(d[1]|0,d[2]|0,d[3].trim())):0<c.length&&a.push(new v("unknown",0,c))}});return a}function f(c,a){a.forEach(function(a){var d=c[a.file];if(d){var e=d.index[a.line];if(e){e.errors.push(a);d.hasErrors=!0;return}}c.unknown.hasErrors=
!0;c.unknown.lines[0].errors.push(a)})}function p(c){c._commandRef=u()}function x(c,a){var d=m();r(c+" in command "+(a||u())+("unknown"===d?"":" called from "+d))}function z(c,d,e,f){typeof c!==d&&x("invalid parameter type"+a(e)+". expected "+d+", got "+typeof c,f||u())}function C(c,a){return 32820===c||32819===c||33635===c?2:34042===c?4:D[c]*a}var c=b("./is-typed-array");b=b("./extend");var y="gl canvas container attributes pixelRatio extensions optionalExtensions profile onDone".split(" "),D={};
D[5120]=D[5121]=1;D[5122]=D[5123]=D[36193]=D[33635]=D[32819]=D[32820]=2;D[5124]=D[5125]=D[5126]=D[34042]=4;h.exports=b(e,{optional:function(c){c()},raise:r,commandRaise:x,command:function(c,a,d){c||x(a,d||u())},parameter:function(c,d,e){c in d||r("unknown parameter ("+c+")"+a(e)+". possible values: "+Object.keys(d).join())},commandParameter:function(c,d,e,f){c in d||x("unknown parameter ("+c+")"+a(e)+". possible values: "+Object.keys(d).join(),f||u())},constructor:function(c){Object.keys(c).forEach(function(c){0>
y.indexOf(c)&&r('invalid regl constructor argument "'+c+'". must be one of '+y)})},type:function(c,d,e){typeof c!==d&&r("invalid parameter type"+a(e)+". expected "+d+", got "+typeof c)},commandType:z,isTypedArray:function(d,e){c(d)||r("invalid parameter type"+a(e)+". must be a typed array")},nni:function(c,d){0<=c&&(c|0)===c||r("invalid parameter type, ("+c+")"+a(d)+". must be a nonnegative integer")},oneOf:n,shaderError:function(c,a,b,p,n){if(!c.getShaderParameter(a,c.COMPILE_STATUS)){a=c.getShaderInfoLog(a);
c=p===c.FRAGMENT_SHADER?"fragment":"vertex";z(b,"string",c+" shader source must be a string",n);var l=g(b,n);b=d(a);f(l,b);Object.keys(l).forEach(function(c){function a(c,d){e.push(c);f.push(d||"")}var d=l[c];if(d.hasErrors){var e=[""],f=[""];a("file number "+c+": "+d.name+"\n","color:red;text-decoration:underline;font-weight:bold");d.lines.forEach(function(c){if(0<c.errors.length){a(k(c.number,4)+"|  ","background-color:yellow; font-weight:bold");a(c.line+"\n","color:red; background-color:yellow; font-weight:bold");
var d=0;c.errors.forEach(function(e){e=e.message;var f=/^\s*\'(.*)\'\s*\:\s*(.*)$/.exec(e);if(f){var b=f[1];e=f[2];switch(b){case "assign":b="="}d=Math.max(c.line.indexOf(b,d),0)}else d=0;a(k("| ",6));a(k("^^^",d+3)+"\n","font-weight:bold");a(k("| ",6));a(e+"\n","font-weight:bold")});a(k("| ",6)+"\n")}else a(k(c.number,4)+"|  "),a(c.line+"\n","color:red")});"undefined"!==typeof document?(f[0]=e.join("%c"),console.log.apply(console,f)):console.log(e.join(""))}});e.raise("Error compiling "+c+" shader, "+
l[0].name)}},linkError:function(c,a,d,f,b){c.getProgramParameter(a,c.LINK_STATUS)||(c=c.getProgramInfoLog(a),d=g(d,b),f='Error linking program with vertex shader, "'+g(f,b)[0].name+'", and fragment shader "'+d[0].name+'"',"undefined"!==typeof document?console.log("%c"+f+"\n%c"+c,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(f+"\n"+c),e.raise(f))},callSite:m,saveCommandRef:p,saveDrawInfo:function(c,a,d,e){function f(c){return c?e.id(c):0}function b(c,a){Object.keys(a).forEach(function(a){c[e.id(a)]=
!0})}p(c);c._fragId=f(c["static"].frag);c._vertId=f(c["static"].vert);var g=c._uniformSet={};b(g,a["static"]);b(g,a.dynamic);a=c._attributeSet={};b(a,d["static"]);b(a,d.dynamic);c._hasCount="count"in c["static"]||"count"in c.dynamic||"elements"in c["static"]||"elements"in c.dynamic},framebufferFormat:function(c,a,d){c.texture?n(c.texture._texture.internalformat,a,"unsupported texture format for attachment"):n(c.renderbuffer._renderbuffer.format,d,"unsupported renderbuffer format for attachment")},
guessCommand:u,texture2D:function(c,a,d){var f=a.width,b=a.height,g=a.channels;e(0<f&&f<=d.maxTextureSize&&0<b&&b<=d.maxTextureSize,"invalid texture shape");33071===c.wrapS&&33071===c.wrapT||e(!(f&f-1)&&!!f&&!(b&b-1)&&!!b,"incompatible wrap mode for texture, both width and height must be power of 2");1===a.mipmask?1!==f&&1!==b&&e(9984!==c.minFilter&&9986!==c.minFilter&&9985!==c.minFilter&&9987!==c.minFilter,"min filter requires mipmap"):(e(!(f&f-1)&&!!f&&!(b&b-1)&&!!b,"texture must be a square power of 2 to support mipmapping"),
e(a.mipmask===(f<<1)-1,"missing or incomplete mipmap data"));5126===a.type&&(0>d.extensions.indexOf("oes_texture_float_linear")&&e(9728===c.minFilter&&9728===c.magFilter,"filter not supported, must enable oes_texture_float_linear"),e(!c.genMipmaps,"mipmap generation not supported with float textures"));var p=a.images;for(d=0;16>d;++d)if(p[d]){var k=f>>d,n=b>>d;e(a.mipmask&1<<d,"missing mipmap data");var l=p[d];e(l.width===k&&l.height===n,"invalid shape for mip images");e(l.format===a.format&&l.internalformat===
a.internalformat&&l.type===a.type,"incompatible type for mip image");l.compressed||l.data&&e(l.data.byteLength===k*n*Math.max(C(l.type,g),l.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format")}else c.genMipmaps||e(0===(a.mipmask&1<<d),"extra mipmap data");a.compressed&&e(!c.genMipmaps,"mipmap generation for compressed images not supported")},textureCube:function(c,a,d,f){var b=c.width,g=c.height,p=c.channels;e(0<b&&b<=f.maxTextureSize&&0<g&&g<=f.maxTextureSize,
"invalid texture shape");e(b===g,"cube map must be square");e(33071===a.wrapS&&33071===a.wrapT,"wrap mode not supported by cube map");for(f=0;f<d.length;++f){var k=d[f];e(k.width===b&&k.height===g,"inconsistent cube map face shape");a.genMipmaps&&(e(!k.compressed,"can not generate mipmap for compressed textures"),e(1===k.mipmask,"can not specify mipmaps and generate mipmaps"));for(var l=k.images,n=0;16>n;++n){var m=l[n];if(m){var y=b>>n,x=g>>n;e(k.mipmask&1<<n,"missing mipmap data");e(m.width===y&&
m.height===x,"invalid shape for mip images");e(m.format===c.format&&m.internalformat===c.internalformat&&m.type===c.type,"incompatible type for mip image");m.compressed||m.data&&e(m.data.byteLength===y*x*Math.max(C(m.type,p),m.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format")}}}}})},{"./extend":24,"./is-typed-array":28}],22:[function(b,h,q){h.exports="undefined"!==typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date}},
{}],23:[function(b,h,q){function t(a){return Array.prototype.slice.call(a)}function r(a){return t(a).join("")}var e=b("./extend");h.exports=function(){function a(){var a=[],b=[];return e(function(){a.push.apply(a,t(arguments))},{def:function(){var d="v"+k++;b.push(d);0<arguments.length&&(a.push(d,"="),a.push.apply(a,t(arguments)),a.push(";"));return d},toString:function(){return r([0<b.length?"var "+b+";":"",r(a)])}})}function b(){function k(a,e){d(a,e,"=",g.def(a,e),";")}var g=a(),d=a(),f=g.toString,
p=d.toString;return e(function(){g.apply(g,t(arguments))},{def:g.def,entry:g,exit:d,save:k,set:function(a,d,e){k(a,d);g(a,d,"=",e,";")},toString:function(){return f()+p()}})}var k=0,l=[],A=[],v=a(),u={};return{global:v,link:function(a){for(var e=0;e<A.length;++e)if(A[e]===a)return l[e];e="g"+k++;l.push(e);A.push(a);return e},block:a,proc:function(a,g){function d(){var a="a"+f.length;f.push(a);return a}var f=[];g=g||0;for(var p=0;p<g;++p)d();var p=b(),k=p.toString;return u[a]=e(p,{arg:d,toString:function(){return r(["function(",
f.join(),"){",k(),"}"])}})},scope:b,cond:function(){var a=r(arguments),g=b(),d=b(),f=g.toString,p=d.toString;return e(g,{then:function(){g.apply(g,t(arguments));return this},"else":function(){d.apply(d,t(arguments));return this},toString:function(){var d=p();d&&(d="else{"+d+"}");return r(["if(",a,"){",f(),"}",d])}})},compile:function(){var a=['"use strict";',v,"return {"];Object.keys(u).forEach(function(d){a.push('"',d,'":',u[d].toString(),",")});a.push("}");var e=r(a).replace(/;/g,";\n").replace(/}/g,
"}\n").replace(/{/g,"{\n");return Function.apply(null,l.concat(e)).apply(null,A)}}}},{"./extend":24}],24:[function(b,h,q){h.exports=function(b,r){for(var e=Object.keys(r),a=0;a<e.length;++a)b[e[a]]=r[e[a]];return b}},{}],25:[function(b,h,q){function t(a,e,b,l,r,v){for(var u=0;u<e;++u)for(var m=a[u],g=0;g<b;++g)for(var d=m[g],f=0;f<l;++f)r[v++]=d[f]}function r(a,e,b,l,A){for(var v=1,u=b+1;u<e.length;++u)v*=e[u];var m=e[b];if(4===e.length-b){var g=e[b+1],d=e[b+2];e=e[b+3];for(u=0;u<m;++u)t(a[u],g,d,
e,l,A),A+=v}else for(u=0;u<m;++u)r(a[u],e,b+1,l,A),A+=v}var e=b("./pool");h.exports={shape:function(a){for(var e=[];a.length;a=a[0])e.push(a.length);return e},flatten:function(a,b,k,l){var A=1;if(b.length)for(var v=0;v<b.length;++v)A*=b[v];else A=0;k=l||e.allocType(k,A);switch(b.length){case 0:break;case 1:l=b[0];for(b=0;b<l;++b)k[b]=a[b];break;case 2:l=b[0];b=b[1];for(v=A=0;v<l;++v)for(var u=a[v],m=0;m<b;++m)k[A++]=u[m];break;case 3:t(a,b[0],b[1],b[2],k,0);break;default:r(a,b,0,k,0)}return k}}},
{"./pool":30}],26:[function(b,h,q){var t=b("./is-typed-array");h.exports=function(b){return Array.isArray(b)||t(b)}},{"./is-typed-array":28}],27:[function(b,h,q){var t=b("./is-typed-array");h.exports=function(b){return!!b&&"object"===typeof b&&Array.isArray(b.shape)&&Array.isArray(b.stride)&&"number"===typeof b.offset&&b.shape.length===b.stride.length&&(Array.isArray(b.data)||t(b.data))}},{"./is-typed-array":28}],28:[function(b,h,q){var t=b("../constants/arraytypes.json");h.exports=function(b){return Object.prototype.toString.call(b)in
t}},{"../constants/arraytypes.json":4}],29:[function(b,h,q){h.exports=function(b,r){for(var e=Array(b),a=0;a<b;++a)e[a]=r(a);return e}},{}],30:[function(b,h,q){function t(a){var e,b;e=(65535<a)<<4;a>>>=e;b=(255<a)<<3;a>>>=b;e|=b;b=(15<a)<<2;a>>>=b;e|=b;b=(3<a)<<1;return e|b|a>>>b>>1}function r(e){a:{for(var b=16;268435456>=b;b*=16)if(e<=b){e=b;break a}e=0}b=a[t(e)>>2];return 0<b.length?b.pop():new ArrayBuffer(e)}function e(e){a[t(e.byteLength)>>2].push(e)}var a=b("./loop")(8,function(){return[]});
h.exports={alloc:r,free:e,allocType:function(a,e){var b=null;switch(a){case 5120:b=new Int8Array(r(e),0,e);break;case 5121:b=new Uint8Array(r(e),0,e);break;case 5122:b=new Int16Array(r(2*e),0,e);break;case 5123:b=new Uint16Array(r(2*e),0,e);break;case 5124:b=new Int32Array(r(4*e),0,e);break;case 5125:b=new Uint32Array(r(4*e),0,e);break;case 5126:b=new Float32Array(r(4*e),0,e);break;default:return null}return b.length!==e?b.subarray(0,e):b},freeType:function(a){e(a.buffer)}}},{"./loop":29}],31:[function(b,
h,q){h.exports={next:"function"===typeof requestAnimationFrame?function(b){return requestAnimationFrame(b)}:function(b){return setTimeout(b,16)},cancel:"function"===typeof cancelAnimationFrame?function(b){return cancelAnimationFrame(b)}:clearTimeout}},{}],32:[function(b,h,q){var t=b("./pool"),r=new Float32Array(1),e=new Uint32Array(r.buffer);h.exports=function(a){for(var b=t.allocType(5123,a.length),k=0;k<a.length;++k)if(isNaN(a[k]))b[k]=65535;else if(Infinity===a[k])b[k]=31744;else if(-Infinity===
a[k])b[k]=64512;else{r[0]=a[k];var l=e[0],A=l>>>31<<15,v=(l<<1>>>24)-127,l=l>>13&1023;b[k]=-24>v?A:-14>v?A+(l+1024>>-14-v):15<v?A+31744:A+(v+15<<10)+l}return b}},{"./pool":30}],33:[function(b,h,q){h.exports=function(b){return Object.keys(b).map(function(r){return b[r]})}},{}],34:[function(b,h,q){function t(a,e,b){function n(){var e=window.innerWidth,d=window.innerHeight;a!==document.body&&(d=a.getBoundingClientRect(),e=d.right-d.left,d=d.bottom-d.top);m.width=b*e;m.height=b*d;k(m.style,{width:e+"px",
height:d+"px"})}var m=document.createElement("canvas");k(m.style,{border:0,margin:0,padding:0,top:0,left:0});a.appendChild(m);a===document.body&&(m.style.position="absolute",k(a.style,{margin:0,padding:0}));window.addEventListener("resize",n,!1);n();return{canvas:m,onDestroy:function(){window.removeEventListener("resize",n);a.removeChild(m)}}}function r(a,e){function b(k){try{return a.getContext(k,e)}catch(m){return null}}return b("webgl")||b("experimental-webgl")||b("webgl-experimental")}function e(a){if("string"===
typeof a)return a.split();n(Array.isArray(a),"invalid extension array");return a}function a(a){return"string"===typeof a?(n("undefined"!==typeof document,"not supported outside of DOM"),document.querySelector(a)):a}var n=b("./util/check"),k=b("./util/extend");h.exports=function(b){var k=b||{},v,u,m,g;b={};var d=[],f=[],p="undefined"===typeof window?1:window.devicePixelRatio,x=!1,z=function(c){c&&n.raise(c)},C=function(){};"string"===typeof k?(n("undefined"!==typeof document,"selector queries only supported in DOM enviroments"),
v=document.querySelector(k),n(v,"invalid query string for element")):"object"===typeof k?"string"===typeof k.nodeName&&"function"===typeof k.appendChild&&"function"===typeof k.getBoundingClientRect?v=k:"function"===typeof k.drawArrays||"function"===typeof k.drawElements?(g=k,m=g.canvas):(n.constructor(k),"gl"in k?g=k.gl:"canvas"in k?m=a(k.canvas):"container"in k&&(u=a(k.container)),"attributes"in k&&(b=k.attributes,n.type(b,"object","invalid context attributes")),"extensions"in k&&(d=e(k.extensions)),
"optionalExtensions"in k&&(f=e(k.optionalExtensions)),"onDone"in k&&(n.type(k.onDone,"function","invalid or missing onDone callback"),z=k.onDone),"profile"in k&&(x=!!k.profile),"pixelRatio"in k&&(p=+k.pixelRatio,n(0<p,"invalid pixel ratio"))):n.raise("invalid arguments to regl");v&&("canvas"===v.nodeName.toLowerCase()?m=v:u=v);if(!g){if(!m){n("undefined"!==typeof document,"must manually specify webgl context outside of DOM environments");v=t(u||document.body,z,p);if(!v)return null;m=v.canvas;C=v.onDestroy}g=
r(m,b)}return g?{gl:g,canvas:m,container:u,extensions:d,optionalExtensions:f,pixelRatio:p,profile:x,onDone:z,onDestroy:C}:(C(),z("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}},{"./util/check":21,"./util/extend":24}],35:[function(b,h,q){function t(a){var e=a.length;if(0<e%4)throw Error("Invalid string. Length must be a multiple of 4");return"="===a[e-2]?2:"="===a[e-1]?1:0}function r(a,b,n){for(var r=[],u=b;u<n;u+=3)b=(a[u]<<16)+(a[u+1]<<8)+a[u+2],
r.push(e[b>>18&63]+e[b>>12&63]+e[b>>6&63]+e[b&63]);return r.join("")}q.byteLength=function(a){return 3*a.length/4-t(a)};q.toByteArray=function(e){var b,r,v,u,m;b=e.length;u=t(e);m=new n(3*b/4-u);r=0<u?b-4:b;var g=0;for(b=0;b<r;b+=4)v=a[e.charCodeAt(b)]<<18|a[e.charCodeAt(b+1)]<<12|a[e.charCodeAt(b+2)]<<6|a[e.charCodeAt(b+3)],m[g++]=v>>16&255,m[g++]=v>>8&255,m[g++]=v&255;2===u?(v=a[e.charCodeAt(b)]<<2|a[e.charCodeAt(b+1)]>>4,m[g++]=v&255):1===u&&(v=a[e.charCodeAt(b)]<<10|a[e.charCodeAt(b+1)]<<4|a[e.charCodeAt(b+
2)]>>2,m[g++]=v>>8&255,m[g++]=v&255);return m};q.fromByteArray=function(a){for(var b=a.length,n=b%3,v="",u=[],m=0,g=b-n;m<g;m+=16383)u.push(r(a,m,m+16383>g?g:m+16383));1===n?(a=a[b-1],v+=e[a>>2],v+=e[a<<4&63],v+="=="):2===n&&(a=(a[b-2]<<8)+a[b-1],v+=e[a>>10],v+=e[a>>4&63],v+=e[a<<2&63],v+="=");u.push(v);return u.join("")};var e=[],a=[],n="undefined"!==typeof Uint8Array?Uint8Array:Array;for(b=0;64>b;++b)e[b]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[b],a["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(b)]=
b;a[45]=62;a[95]=63},{}],36:[function(b,h,q){var t=b("./lib/rationalize");h.exports=function(b,e){return t(b[0].mul(e[1]).add(e[0].mul(b[1])),b[1].mul(e[1]))}},{"./lib/rationalize":46}],37:[function(b,h,q){h.exports=function(b,r){return b[0].mul(r[1]).cmp(r[0].mul(b[1]))}},{}],38:[function(b,h,q){var t=b("./lib/rationalize");h.exports=function(b,e){return t(b[0].mul(e[1]),b[1].mul(e[0]))}},{"./lib/rationalize":46}],39:[function(b,h,q){function t(b,v){if(r(b))return v?l(b,t(v)):[b[0].clone(),b[1].clone()];
var u=0,m,g;if(e(b))m=b.clone();else if("string"===typeof b)m=n(b);else{if(0===b)return[a(0),a(1)];if(b!==Math.floor(b))for(;b!==Math.floor(b);)b*=Math.pow(2,256),u-=256;m=a(b)}if(r(v))m.mul(v[1]),g=v[0].clone();else if(e(v))g=v.clone();else if("string"===typeof v)g=n(v);else if(v){if(v!==Math.floor(v))for(;v!==Math.floor(v);)v*=Math.pow(2,256),u+=256;g=a(v)}else g=a(1);0<u?m=m.shln(u):0>u&&(g=g.shln(-u));return k(m,g)}var r=b("./is-rat"),e=b("./lib/is-bn"),a=b("./lib/num-to-bn"),n=b("./lib/str-to-bn"),
k=b("./lib/rationalize"),l=b("./div");h.exports=t},{"./div":38,"./is-rat":40,"./lib/is-bn":44,"./lib/num-to-bn":45,"./lib/rationalize":46,"./lib/str-to-bn":47}],40:[function(b,h,q){var t=b("./lib/is-bn");h.exports=function(b){return Array.isArray(b)&&2===b.length&&t(b[0])&&t(b[1])}},{"./lib/is-bn":44}],41:[function(b,h,q){var t=b("bn.js");h.exports=function(b){return b.cmp(new t(0))}},{"bn.js":49}],42:[function(b,h,q){h.exports=function(b){var r=b.length,e=b.words,a=0;if(1===r)a=e[0];else if(2===
r)a=e[0]+67108864*e[1];else for(var n=a=0;n<r;n++)a+=e[n]*Math.pow(67108864,n);return b.sign?-a:a}},{}],43:[function(b,h,q){var t=b("double-bits"),r=b("bit-twiddle").countTrailingZeros;h.exports=function(e){var a=r(t.lo(e));if(32>a)return a;e=r(t.hi(e));return 20<e?52:e+32}},{"bit-twiddle":54,"double-bits":76}],44:[function(b,h,q){b("bn.js");h.exports=function(b){return b&&"object"===typeof b&&!!b.words}},{"bn.js":49}],45:[function(b,h,q){var t=b("bn.js"),r=b("double-bits");h.exports=function(e){var a=
r.exponent(e);return 52>a?new t(e):(new t(e*Math.pow(2,52-a))).shln(a-52)}},{"bn.js":49,"double-bits":76}],46:[function(b,h,q){var t=b("./num-to-bn"),r=b("./bn-sign");h.exports=function(e,a){var b=r(e),k=r(a);if(0===b)return[t(0),t(1)];if(0===k)return[t(0),t(0)];0>k&&(e=e.neg(),a=a.neg());b=e.gcd(a);return b.cmpn(1)?[e.div(b),a.div(b)]:[e,a]}},{"./bn-sign":41,"./num-to-bn":45}],47:[function(b,h,q){var t=b("bn.js");h.exports=function(b){return new t(b)}},{"bn.js":49}],48:[function(b,h,q){var t=b("./lib/rationalize");
h.exports=function(b,e){return t(b[0].mul(e[0]),b[1].mul(e[1]))}},{"./lib/rationalize":46}],49:[function(b,h,q){(function(b,r){function e(c,a){if(!c)throw Error(a||"Assertion failed");}function a(c,a){c.super_=a;var d=function(){};d.prototype=a.prototype;c.prototype=new d;c.prototype.constructor=c}function n(c,a,d){if(null!==c&&"object"===typeof c&&Array.isArray(c.words))return c;this.sign=!1;this.words=null;this.length=0;this.red=null;if("le"===a||"be"===a)d=a,a=10;null!==c&&this._init(c||0,a||10,
d||"be")}function k(c,a,d){var e=0;for(d=Math.min(c.length,d);a<d;a++)var b=c.charCodeAt(a)-48,e=e<<4,e=49<=b&&54>=b?e|b-49+10:17<=b&&22>=b?e|b-17+10:e|b&15;return e}function l(c,a,d,e){var b=0;for(d=Math.min(c.length,d);a<d;a++)var f=c.charCodeAt(a)-48,b=b*e,b=49<=f?b+(f-49+10):17<=f?b+(f-17+10):b+f;return b}function A(c,a){this.name=c;this.p=new n(a,16);this.n=this.p.bitLength();this.k=(new n(1)).ishln(this.n).isub(this.p);this.tmp=this._tmp()}function v(){A.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}
function u(){A.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function m(){A.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function g(){A.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function d(c){"string"===typeof c?(c=n._prime(c),this.m=c.p,this.prime=c):(this.m=c,this.prime=null)}function f(c){d.call(this,c);this.shift=this.m.bitLength();0!==this.shift%26&&(this.shift+=26-this.shift%26);
this.r=(new n(1)).ishln(this.shift);this.r2=this.imod(this.r.sqr());this.rinv=this.r._invmp(this.m);this.minv=this.rinv.mul(this.r).isubn(1).div(this.m);this.minv.sign=!0;this.minv=this.minv.mod(this.r)}"object"===typeof b?b.exports=n:r.BN=n;n.BN=n;n.wordSize=26;n.prototype._init=function(c,a,d){if("number"===typeof c)return this._initNumber(c,a,d);if("object"===typeof c)return this._initArray(c,a,d);"hex"===a&&(a=16);e(a===(a|0)&&2<=a&&36>=a);c=c.toString().replace(/\s+/g,"");var b=0;"-"===c[0]&&
b++;16===a?this._parseHex(c,b):this._parseBase(c,a,b);"-"===c[0]&&(this.sign=!0);this.strip();"le"===d&&this._initArray(this.toArray(),a,d)};n.prototype._initNumber=function(c,a,d){0>c&&(this.sign=!0,c=-c);67108864>c?(this.words=[c&67108863],this.length=1):4503599627370496>c?(this.words=[c&67108863,c/67108864&67108863],this.length=2):(e(9007199254740992>c),this.words=[c&67108863,c/67108864&67108863,1],this.length=3);"le"===d&&this._initArray(this.toArray(),a,d)};n.prototype._initArray=function(c,
a,d){e("number"===typeof c.length);if(0>=c.length)return this.words=[0],this.length=1,this;this.length=Math.ceil(c.length/3);this.words=Array(this.length);for(a=0;a<this.length;a++)this.words[a]=0;var b=0;if("be"===d)for(a=c.length-1,d=0;0<=a;a-=3){var f=c[a]|c[a-1]<<8|c[a-2]<<16;this.words[d]|=f<<b&67108863;this.words[d+1]=f>>>26-b&67108863;b+=24;26<=b&&(b-=26,d++)}else if("le"===d)for(d=a=0;a<c.length;a+=3)f=c[a]|c[a+1]<<8|c[a+2]<<16,this.words[d]|=f<<b&67108863,this.words[d+1]=f>>>26-b&67108863,
b+=24,26<=b&&(b-=26,d++);return this.strip()};n.prototype._parseHex=function(c,a){this.length=Math.ceil((c.length-a)/6);this.words=Array(this.length);for(var d=0;d<this.length;d++)this.words[d]=0;for(var e=0,d=c.length-6,b=0;d>=a;d-=6){var f=k(c,d,d+6);this.words[b]|=f<<e&67108863;this.words[b+1]|=f>>>26-e&4194303;e+=24;26<=e&&(e-=26,b++)}d+6!==a&&(f=k(c,a,d+6),this.words[b]|=f<<e&67108863,this.words[b+1]|=f>>>26-e&4194303);this.strip()};n.prototype._parseBase=function(c,a,d){this.words=[0];this.length=
1;for(var e=0,b=1;67108863>=b;b*=a)e++;e--;for(var b=b/a|0,f=c.length-d,g=f%e,p=Math.min(f,f-g)+d,f=0;d<p;d+=e)f=l(c,d,d+e,a),this.imuln(b),67108864>this.words[0]+f?this.words[0]+=f:this._iaddn(f);if(0!==g){e=1;f=l(c,d,c.length,a);for(d=0;d<g;d++)e*=a;this.imuln(e);67108864>this.words[0]+f?this.words[0]+=f:this._iaddn(f)}};n.prototype.copy=function(c){c.words=Array(this.length);for(var a=0;a<this.length;a++)c.words[a]=this.words[a];c.length=this.length;c.sign=this.sign;c.red=this.red};n.prototype.clone=
function(){var c=new n(null);this.copy(c);return c};n.prototype.strip=function(){for(;1<this.length&&0===this.words[this.length-1];)this.length--;return this._normSign()};n.prototype._normSign=function(){1===this.length&&0===this.words[0]&&(this.sign=!1);return this};n.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var p=" 0 00 000 0000 00000 000000 0000000 00000000 000000000 0000000000 00000000000 000000000000 0000000000000 00000000000000 000000000000000 0000000000000000 00000000000000000 000000000000000000 0000000000000000000 00000000000000000000 000000000000000000000 0000000000000000000000 00000000000000000000000 000000000000000000000000 0000000000000000000000000".split(" "),
x=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],z=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1E7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64E6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243E5,28629151,33554432,39135393,45435424,52521875,60466176];n.prototype.toString=function(c,a){c=c||10;if(16===c||"hex"===c){var d="",b=0;a=a|0||1;for(var f=0,g=0;g<this.length;g++){var k=
this.words[g],m=((k<<b|f)&16777215).toString(16),f=k>>>24-b&16777215,d=0!==f||g!==this.length-1?p[6-m.length]+m+d:m+d,b=b+2;26<=b&&(b-=26,g--)}for(0!==f&&(d=f.toString(16)+d);0!==d.length%a;)d="0"+d;this.sign&&(d="-"+d);return d}if(c===(c|0)&&2<=c&&36>=c){b=x[c];f=z[c];d="";g=this.clone();for(g.sign=!1;0!==g.cmpn(0);)k=g.modn(f).toString(c),g=g.idivn(f),d=0!==g.cmpn(0)?p[b-k.length]+k+d:k+d;0===this.cmpn(0)&&(d="0"+d);this.sign&&(d="-"+d);return d}e(!1,"Base should be between 2 and 36")};n.prototype.toJSON=
function(){return this.toString(16)};n.prototype.toArray=function(c){this.strip();var a=Array(this.byteLength());a[0]=0;var d=this.clone();if("le"!==c)for(c=0;0!==d.cmpn(0);c++){var e=d.andln(255);d.ishrn(8);a[a.length-c-1]=e}else for(c=0;0!==d.cmpn(0);c++)e=d.andln(255),d.ishrn(8),a[c]=e;return a};n.prototype._countBits=Math.clz32?function(c){return 32-Math.clz32(c)}:function(c){var a=0;4096<=c&&(a+=13,c>>>=13);64<=c&&(a+=7,c>>>=7);8<=c&&(a+=4,c>>>=4);2<=c&&(a+=2,c>>>=2);return a+c};n.prototype._zeroBits=
function(c){if(0===c)return 26;var a=0;0===(c&8191)&&(a+=13,c>>>=13);0===(c&127)&&(a+=7,c>>>=7);0===(c&15)&&(a+=4,c>>>=4);0===(c&3)&&(a+=2,c>>>=2);0===(c&1)&&a++;return a};n.prototype.bitLength=function(){var c=0,c=this._countBits(this.words[this.length-1]);return 26*(this.length-1)+c};n.prototype.zeroBits=function(){if(0===this.cmpn(0))return 0;for(var c=0,a=0;a<this.length;a++){var d=this._zeroBits(this.words[a]),c=c+d;if(26!==d)break}return c};n.prototype.byteLength=function(){return Math.ceil(this.bitLength()/
8)};n.prototype.neg=function(){if(0===this.cmpn(0))return this.clone();var c=this.clone();c.sign=!this.sign;return c};n.prototype.ior=function(c){for(this.sign=this.sign||c.sign;this.length<c.length;)this.words[this.length++]=0;for(var a=0;a<c.length;a++)this.words[a]|=c.words[a];return this.strip()};n.prototype.or=function(c){return this.length>c.length?this.clone().ior(c):c.clone().ior(this)};n.prototype.iand=function(c){this.sign=this.sign&&c.sign;var a;a=this.length>c.length?c:this;for(var d=
0;d<a.length;d++)this.words[d]&=c.words[d];this.length=a.length;return this.strip()};n.prototype.and=function(c){return this.length>c.length?this.clone().iand(c):c.clone().iand(this)};n.prototype.ixor=function(c){this.sign=this.sign||c.sign;var a;this.length>c.length?a=this:(a=c,c=this);for(var d=0;d<c.length;d++)this.words[d]=a.words[d]^c.words[d];if(this!==a)for(;d<a.length;d++)this.words[d]=a.words[d];this.length=a.length;return this.strip()};n.prototype.xor=function(c){return this.length>c.length?
this.clone().ixor(c):c.clone().ixor(this)};n.prototype.setn=function(c,a){e("number"===typeof c&&0<=c);for(var d=c/26|0,b=c%26;this.length<=d;)this.words[this.length++]=0;this.words[d]=a?this.words[d]|1<<b:this.words[d]&~(1<<b);return this.strip()};n.prototype.iadd=function(c){if(this.sign&&!c.sign){this.sign=!1;var a=this.isub(c);this.sign=!this.sign;return this._normSign()}if(!this.sign&&c.sign)return c.sign=!1,a=this.isub(c),c.sign=!0,a._normSign();var d;this.length>c.length?d=this:(d=c,c=this);
for(var e=a=0;e<c.length;e++)a=d.words[e]+c.words[e]+a,this.words[e]=a&67108863,a>>>=26;for(;0!==a&&e<d.length;e++)a=d.words[e]+a,this.words[e]=a&67108863,a>>>=26;this.length=d.length;if(0!==a)this.words[this.length]=a,this.length++;else if(d!==this)for(;e<d.length;e++)this.words[e]=d.words[e];return this};n.prototype.add=function(c){if(c.sign&&!this.sign){c.sign=!1;var a=this.sub(c);c.sign=!0;return a}return!c.sign&&this.sign?(this.sign=!1,a=c.sub(this),this.sign=!0,a):this.length>c.length?this.clone().iadd(c):
c.clone().iadd(this)};n.prototype.isub=function(c){if(c.sign){c.sign=!1;var a=this.iadd(c);c.sign=!0;return a._normSign()}if(this.sign)return this.sign=!1,this.iadd(c),this.sign=!0,this._normSign();a=this.cmp(c);if(0===a)return this.sign=!1,this.length=1,this.words[0]=0,this;var d;0<a?d=this:(d=c,c=this);for(var e=0,b=0;b<c.length;b++)a=d.words[b]-c.words[b]+e,e=a>>26,this.words[b]=a&67108863;for(;0!==e&&b<d.length;b++)a=d.words[b]+e,e=a>>26,this.words[b]=a&67108863;if(0===e&&b<d.length&&d!==this)for(;b<
d.length;b++)this.words[b]=d.words[b];this.length=Math.max(this.length,b);d!==this&&(this.sign=!0);return this.strip()};n.prototype.sub=function(c){return this.clone().isub(c)};n.prototype._smallMulTo=function(c,a){a.sign=c.sign!==this.sign;a.length=this.length+c.length;for(var d=0,e=0;e<a.length-1;e++){for(var b=d>>>26,d=d&67108863,f=Math.min(e,c.length-1),g=Math.max(0,e-this.length+1);g<=f;g++)var p=(this.words[e-g]|0)*(c.words[g]|0),k=p&67108863,b=b+(p/67108864|0)|0,k=k+d|0,d=k&67108863,b=b+(k>>>
26)|0;a.words[e]=d;d=b}0!==d?a.words[e]=d:a.length--;return a.strip()};n.prototype._bigMulTo=function(c,a){a.sign=c.sign!==this.sign;a.length=this.length+c.length;for(var d=0,e=0,b=0;b<a.length-1;b++){for(var f=e,e=0,d=d&67108863,g=Math.min(b,c.length-1),p=Math.max(0,b-this.length+1);p<=g;p++)var k=(this.words[b-p]|0)*(c.words[p]|0),m=k&67108863,f=f+(k/67108864|0)|0,m=m+d|0,d=m&67108863,f=f+(m>>>26)|0,e=e+(f>>>26),f=f&67108863;a.words[b]=d;d=f}0!==d?a.words[b]=d:a.length--;return a.strip()};n.prototype.mulTo=
function(c,a){return 63>this.length+c.length?this._smallMulTo(c,a):this._bigMulTo(c,a)};n.prototype.mul=function(c){var a=new n(null);a.words=Array(this.length+c.length);return this.mulTo(c,a)};n.prototype.imul=function(c){if(0===this.cmpn(0)||0===c.cmpn(0))return this.words[0]=0,this.length=1,this;var a=this.length,d=c.length;this.sign=c.sign!==this.sign;this.length+=c.length;this.words[this.length-1]=0;for(var e=this.length-2;0<=e;e--){for(var b=0,f=0,g=Math.min(e,d-1),p=Math.max(0,e-a+1);p<=g;p++)var k=
e-p,k=this.words[k]*c.words[p],m=k&67108863,b=b+(k/67108864|0),m=m+f,f=m&67108863,b=b+(m>>>26);this.words[e]=f;this.words[e+1]+=b}b=0;for(k=1;k<this.length;k++)c=this.words[k]+b,this.words[k]=c&67108863,b=c>>>26;return this.strip()};n.prototype.imuln=function(c){e("number"===typeof c);for(var a=0,d=0;d<this.length;d++){var b=this.words[d]*c,f=(b&67108863)+(a&67108863),a=a>>26,a=a+(b/67108864|0),a=a+(f>>>26);this.words[d]=f&67108863}0!==a&&(this.words[d]=a,this.length++);return this};n.prototype.muln=
function(c){return this.clone().imuln(c)};n.prototype.sqr=function(){return this.mul(this)};n.prototype.isqr=function(){return this.mul(this)};n.prototype.ishln=function(c){e("number"===typeof c&&0<=c);var a=c%26;c=(c-a)/26;var d=67108863>>>26-a<<26-a;if(0!==a){for(var b=0,f=0;f<this.length;f++){var g=this.words[f]&d;this.words[f]=this.words[f]-g<<a|b;b=g>>>26-a}b&&(this.words[f]=b,this.length++)}if(0!==c){for(f=this.length-1;0<=f;f--)this.words[f+c]=this.words[f];for(f=0;f<c;f++)this.words[f]=0;
this.length+=c}return this.strip()};n.prototype.ishrn=function(c,a,d){e("number"===typeof c&&0<=c);var b=c%26,f=Math.min((c-b)/26,this.length);c=67108863^67108863>>>b<<b;a=(a?(a-a%26)/26:0)-f;a=Math.max(0,a);if(d){for(var g=0;g<f;g++)d.words[g]=this.words[g];d.length=f}if(0!==f)if(this.length>f)for(this.length-=f,g=0;g<this.length;g++)this.words[g]=this.words[g+f];else this.words[0]=0,this.length=1;f=0;for(g=this.length-1;0<=g&&(0!==f||g>=a);g--){var p=this.words[g];this.words[g]=f<<26-b|p>>>b;f=
p&c}d&&0!==f&&(d.words[d.length++]=f);0===this.length&&(this.words[0]=0,this.length=1);this.strip();return this};n.prototype.shln=function(c){return this.clone().ishln(c)};n.prototype.shrn=function(c){return this.clone().ishrn(c)};n.prototype.testn=function(c){e("number"===typeof c&&0<=c);var a=c%26;c=(c-a)/26;return this.length<=c?!1:!!(this.words[c]&1<<a)};n.prototype.imaskn=function(c){e("number"===typeof c&&0<=c);var a=c%26;c=(c-a)/26;e(!this.sign,"imaskn works only with positive numbers");0!==
a&&c++;this.length=Math.min(c,this.length);0!==a&&(this.words[this.length-1]&=67108863^67108863>>>a<<a);return this.strip()};n.prototype.maskn=function(c){return this.clone().imaskn(c)};n.prototype.iaddn=function(c){e("number"===typeof c);if(0>c)return this.isubn(-c);if(this.sign){if(1===this.length&&this.words[0]<c)return this.words[0]=c-this.words[0],this.sign=!1,this;this.sign=!1;this.isubn(c);this.sign=!0;return this}return this._iaddn(c)};n.prototype._iaddn=function(c){this.words[0]+=c;for(c=
0;c<this.length&&67108864<=this.words[c];c++)this.words[c]-=67108864,c===this.length-1?this.words[c+1]=1:this.words[c+1]++;this.length=Math.max(this.length,c+1);return this};n.prototype.isubn=function(c){e("number"===typeof c);if(0>c)return this.iaddn(-c);if(this.sign)return this.sign=!1,this.iaddn(c),this.sign=!0,this;this.words[0]-=c;for(c=0;c<this.length&&0>this.words[c];c++)this.words[c]+=67108864,--this.words[c+1];return this.strip()};n.prototype.addn=function(c){return this.clone().iaddn(c)};
n.prototype.subn=function(c){return this.clone().isubn(c)};n.prototype.iabs=function(){this.sign=!1;return this};n.prototype.abs=function(){return this.clone().iabs()};n.prototype._ishlnsubmul=function(c,a,d){var b=c.length+d,f;if(this.words.length<b){var g=Array(b);for(f=0;f<this.length;f++)g[f]=this.words[f];this.words=g}else f=this.length;for(this.length=Math.max(this.length,b);f<this.length;f++)this.words[f]=0;for(f=g=0;f<c.length;f++)b=this.words[f+d]+g,g=c.words[f]*a,b-=g&67108863,g=(b>>26)-
(g/67108864|0),this.words[f+d]=b&67108863;for(;f<this.length-d;f++)b=this.words[f+d]+g,g=b>>26,this.words[f+d]=b&67108863;if(0===g)return this.strip();e(-1===g);for(f=g=0;f<this.length;f++)b=-this.words[f]+g,g=b>>26,this.words[f]=b&67108863;this.sign=!0;return this.strip()};n.prototype._wordDiv=function(c,a){var d=this.length-c.length,e=this.clone(),b=c,f=b.words[b.length-1],d=26-this._countBits(f);0!==d&&(b=b.shln(d),e.ishln(d),f=b.words[b.length-1]);var g=e.length-b.length,p;if("mod"!==a){p=new n(null);
p.length=g+1;p.words=Array(p.length);for(var k=0;k<p.length;k++)p.words[k]=0}k=e.clone()._ishlnsubmul(b,1,g);k.sign||(e=k,p&&(p.words[g]=1));for(--g;0<=g;g--){k=67108864*e.words[b.length+g]+e.words[b.length+g-1];k=Math.min(k/f|0,67108863);for(e._ishlnsubmul(b,k,g);e.sign;)k--,e.sign=!1,e._ishlnsubmul(b,1,g),0!==e.cmpn(0)&&(e.sign=!e.sign);p&&(p.words[g]=k)}p&&p.strip();e.strip();"div"!==a&&0!==d&&e.ishrn(d);return{div:p?p:null,mod:e}};n.prototype.divmod=function(c,a){e(0!==c.cmpn(0));if(this.sign&&
!c.sign){var d=this.neg().divmod(c,a),b,f;"mod"!==a&&(b=d.div.neg());"div"!==a&&(f=0===d.mod.cmpn(0)?d.mod:c.sub(d.mod));return{div:b,mod:f}}return!this.sign&&c.sign?(d=this.divmod(c.neg(),a),"mod"!==a&&(b=d.div.neg()),{div:b,mod:d.mod}):this.sign&&c.sign?this.neg().divmod(c.neg(),a):c.length>this.length||0>this.cmp(c)?{div:new n(0),mod:this}:1===c.length?"div"===a?{div:this.divn(c.words[0]),mod:null}:"mod"===a?{div:null,mod:new n(this.modn(c.words[0]))}:{div:this.divn(c.words[0]),mod:new n(this.modn(c.words[0]))}:
this._wordDiv(c,a)};n.prototype.div=function(c){return this.divmod(c,"div").div};n.prototype.mod=function(c){return this.divmod(c,"mod").mod};n.prototype.divRound=function(c){var a=this.divmod(c);if(0===a.mod.cmpn(0))return a.div;var d=a.div.sign?a.mod.isub(c):a.mod,e=c.shrn(1);c=c.andln(1);d=d.cmp(e);return 0>d||1===c&&0===d?a.div:a.div.sign?a.div.isubn(1):a.div.iaddn(1)};n.prototype.modn=function(c){e(67108863>=c);for(var a=67108864%c,d=0,b=this.length-1;0<=b;b--)d=(a*d+this.words[b])%c;return d};
n.prototype.idivn=function(c){e(67108863>=c);for(var a=0,d=this.length-1;0<=d;d--)a=this.words[d]+67108864*a,this.words[d]=a/c|0,a%=c;return this.strip()};n.prototype.divn=function(c){return this.clone().idivn(c)};n.prototype.egcd=function(c){e(!c.sign);e(0!==c.cmpn(0));var a=this,d=c.clone(),a=a.sign?a.mod(c):a.clone();c=new n(1);for(var b=new n(0),f=new n(0),g=new n(1),p=0;a.isEven()&&d.isEven();)a.ishrn(1),d.ishrn(1),++p;for(var k=d.clone(),m=a.clone();0!==a.cmpn(0);){for(;a.isEven();)a.ishrn(1),
c.isEven()&&b.isEven()?(c.ishrn(1),b.ishrn(1)):(c.iadd(k).ishrn(1),b.isub(m).ishrn(1));for(;d.isEven();)d.ishrn(1),f.isEven()&&g.isEven()?(f.ishrn(1),g.ishrn(1)):(f.iadd(k).ishrn(1),g.isub(m).ishrn(1));0<=a.cmp(d)?(a.isub(d),c.isub(f),b.isub(g)):(d.isub(a),f.isub(c),g.isub(b))}return{a:f,b:g,gcd:d.ishln(p)}};n.prototype._invmp=function(c){e(!c.sign);e(0!==c.cmpn(0));var a=this,d=c.clone(),a=a.sign?a.mod(c):a.clone();c=new n(1);for(var b=new n(0),f=d.clone();0<a.cmpn(1)&&0<d.cmpn(1);){for(;a.isEven();)a.ishrn(1),
c.isEven()?c.ishrn(1):c.iadd(f).ishrn(1);for(;d.isEven();)d.ishrn(1),b.isEven()?b.ishrn(1):b.iadd(f).ishrn(1);0<=a.cmp(d)?(a.isub(d),c.isub(b)):(d.isub(a),b.isub(c))}return 0===a.cmpn(1)?c:b};n.prototype.gcd=function(c){if(0===this.cmpn(0))return c.clone();if(0===c.cmpn(0))return this.clone();var a=this.clone();c=c.clone();a.sign=!1;c.sign=!1;for(var d=0;a.isEven()&&c.isEven();d++)a.ishrn(1),c.ishrn(1);do{for(;a.isEven();)a.ishrn(1);for(;c.isEven();)c.ishrn(1);var e=a.cmp(c);if(0>e)e=a,a=c,c=e;else if(0===
e||0===c.cmpn(1))break;a.isub(c)}while(1);return c.ishln(d)};n.prototype.invm=function(c){return this.egcd(c).a.mod(c)};n.prototype.isEven=function(){return 0===(this.words[0]&1)};n.prototype.isOdd=function(){return 1===(this.words[0]&1)};n.prototype.andln=function(c){return this.words[0]&c};n.prototype.bincn=function(c){e("number"===typeof c);var a=c%26;c=(c-a)/26;var d=1<<a;if(this.length<=c){for(a=this.length;a<c+1;a++)this.words[a]=0;this.words[c]|=d;this.length=c+1;return this}for(a=c;0!==d&&
a<this.length;a++)c=this.words[a],c+=d,d=c>>>26,c&=67108863,this.words[a]=c;0!==d&&(this.words[a]=d,this.length++);return this};n.prototype.cmpn=function(c){var a=0>c;a&&(c=-c);if(this.sign&&!a)return-1;if(!this.sign&&a)return 1;c&=67108863;this.strip();1<this.length?c=1:(a=this.words[0],c=a===c?0:a<c?-1:1);this.sign&&(c=-c);return c};n.prototype.cmp=function(c){if(this.sign&&!c.sign)return-1;if(!this.sign&&c.sign)return 1;c=this.ucmp(c);return this.sign?-c:c};n.prototype.ucmp=function(c){if(this.length>
c.length)return 1;if(this.length<c.length)return-1;for(var a=0,d=this.length-1;0<=d;d--){var e=this.words[d],b=c.words[d];if(e!==b){e<b?a=-1:e>b&&(a=1);break}}return a};n.red=function(c){return new d(c)};n.prototype.toRed=function(c){e(!this.red,"Already a number in reduction context");e(!this.sign,"red works only with positives");return c.convertTo(this)._forceRed(c)};n.prototype.fromRed=function(){e(this.red,"fromRed works only with numbers in reduction context");return this.red.convertFrom(this)};
n.prototype._forceRed=function(c){this.red=c;return this};n.prototype.forceRed=function(c){e(!this.red,"Already a number in reduction context");return this._forceRed(c)};n.prototype.redAdd=function(c){e(this.red,"redAdd works only with red numbers");return this.red.add(this,c)};n.prototype.redIAdd=function(c){e(this.red,"redIAdd works only with red numbers");return this.red.iadd(this,c)};n.prototype.redSub=function(c){e(this.red,"redSub works only with red numbers");return this.red.sub(this,c)};n.prototype.redISub=
function(c){e(this.red,"redISub works only with red numbers");return this.red.isub(this,c)};n.prototype.redShl=function(c){e(this.red,"redShl works only with red numbers");return this.red.shl(this,c)};n.prototype.redMul=function(c){e(this.red,"redMul works only with red numbers");this.red._verify2(this,c);return this.red.mul(this,c)};n.prototype.redIMul=function(c){e(this.red,"redMul works only with red numbers");this.red._verify2(this,c);return this.red.imul(this,c)};n.prototype.redSqr=function(){e(this.red,
"redSqr works only with red numbers");this.red._verify1(this);return this.red.sqr(this)};n.prototype.redISqr=function(){e(this.red,"redISqr works only with red numbers");this.red._verify1(this);return this.red.isqr(this)};n.prototype.redSqrt=function(){e(this.red,"redSqrt works only with red numbers");this.red._verify1(this);return this.red.sqrt(this)};n.prototype.redInvm=function(){e(this.red,"redInvm works only with red numbers");this.red._verify1(this);return this.red.invm(this)};n.prototype.redNeg=
function(){e(this.red,"redNeg works only with red numbers");this.red._verify1(this);return this.red.neg(this)};n.prototype.redPow=function(c){e(this.red&&!c.red,"redPow(normalNum)");this.red._verify1(this);return this.red.pow(this,c)};var C={k256:null,p224:null,p192:null,p25519:null};A.prototype._tmp=function(){var c=new n(null);c.words=Array(Math.ceil(this.n/13));return c};A.prototype.ireduce=function(c){var a;do this.split(c,this.tmp),c=this.imulK(c),c=c.iadd(this.tmp),a=c.bitLength();while(a>this.n);
a=a<this.n?-1:c.ucmp(this.p);0===a?(c.words[0]=0,c.length=1):0<a?c.isub(this.p):c.strip();return c};A.prototype.split=function(c,a){c.ishrn(this.n,0,a)};A.prototype.imulK=function(c){return c.imul(this.k)};a(v,A);v.prototype.split=function(c,a){for(var d=Math.min(c.length,9),e=0;e<d;e++)a.words[e]=c.words[e];a.length=d;if(9>=c.length)c.words[0]=0,c.length=1;else{d=c.words[9];a.words[a.length++]=d&4194303;for(e=10;e<c.length;e++){var b=c.words[e];c.words[e-10]=(b&4194303)<<4|d>>>22;d=b}c.words[e-10]=
d>>>22;c.length-=9}};v.prototype.imulK=function(c){c.words[c.length]=0;c.words[c.length+1]=0;c.length+=2;for(var a,d=0,e=0;e<c.length;e++){var b=c.words[e];a=64*b;d+=977*b;a+=d/67108864|0;d&=67108863;c.words[e]=d;d=a}0===c.words[c.length-1]&&(c.length--,0===c.words[c.length-1]&&c.length--);return c};a(u,A);a(m,A);a(g,A);g.prototype.imulK=function(c){for(var a=0,d=0;d<c.length;d++){var a=19*c.words[d]+a,e=a&67108863,a=a>>>26;c.words[d]=e}0!==a&&(c.words[c.length++]=a);return c};n._prime=function(c){if(C[c])return C[c];
var a;if("k256"===c)a=new v;else if("p224"===c)a=new u;else if("p192"===c)a=new m;else if("p25519"===c)a=new g;else throw Error("Unknown prime "+c);return C[c]=a};d.prototype._verify1=function(c){e(!c.sign,"red works only with positives");e(c.red,"red works only with red numbers")};d.prototype._verify2=function(c,a){e(!c.sign&&!a.sign,"red works only with positives");e(c.red&&c.red===a.red,"red works only with red numbers")};d.prototype.imod=function(c){return this.prime?this.prime.ireduce(c)._forceRed(this):
c.mod(this.m)._forceRed(this)};d.prototype.neg=function(c){c=c.clone();c.sign=!c.sign;return c.iadd(this.m)._forceRed(this)};d.prototype.add=function(c,a){this._verify2(c,a);var d=c.add(a);0<=d.cmp(this.m)&&d.isub(this.m);return d._forceRed(this)};d.prototype.iadd=function(c,a){this._verify2(c,a);var d=c.iadd(a);0<=d.cmp(this.m)&&d.isub(this.m);return d};d.prototype.sub=function(c,a){this._verify2(c,a);var d=c.sub(a);0>d.cmpn(0)&&d.iadd(this.m);return d._forceRed(this)};d.prototype.isub=function(c,
a){this._verify2(c,a);var d=c.isub(a);0>d.cmpn(0)&&d.iadd(this.m);return d};d.prototype.shl=function(c,a){this._verify1(c);return this.imod(c.shln(a))};d.prototype.imul=function(c,a){this._verify2(c,a);return this.imod(c.imul(a))};d.prototype.mul=function(c,a){this._verify2(c,a);return this.imod(c.mul(a))};d.prototype.isqr=function(c){return this.imul(c,c)};d.prototype.sqr=function(c){return this.mul(c,c)};d.prototype.sqrt=function(c){if(0===c.cmpn(0))return c.clone();var a=this.m.andln(3);e(1===
a%2);if(3===a){var a=this.m.add(new n(1)).ishrn(2),d=this.pow(c,a);return d}for(var b=this.m.subn(1),f=0;0!==b.cmpn(0)&&0===b.andln(1);)f++,b.ishrn(1);e(0!==b.cmpn(0));for(var a=(new n(1)).toRed(this),d=a.redNeg(),g=this.m.subn(1).ishrn(1),p=this.m.bitLength(),p=(new n(2*p*p)).toRed(this);0!==this.pow(p,g).cmp(d);)p.redIAdd(d);g=this.pow(p,b);d=this.pow(c,b.addn(1).ishrn(1));c=this.pow(c,b);for(b=f;0!==c.cmp(a);){p=c;for(f=0;0!==p.cmp(a);f++)p=p.redSqr();e(f<b);g=this.pow(g,(new n(1)).ishln(b-f-1));
d=d.redMul(g);g=g.redSqr();c=c.redMul(g);b=f}return d};d.prototype.invm=function(c){c=c._invmp(this.m);return c.sign?(c.sign=!1,this.imod(c).redNeg()):this.imod(c)};d.prototype.pow=function(c,a){var d=[];if(0===a.cmpn(0))return new n(1);for(var e=a.clone();0!==e.cmpn(0);)d.push(e.andln(1)),e.ishrn(1);for(var b=c,f=0;f<d.length&&0===d[f];f++,b=this.sqr(b));if(++f<d.length)for(e=this.sqr(b);f<d.length;f++,e=this.sqr(e))0!==d[f]&&(b=this.mul(b,e));return b};d.prototype.convertTo=function(c){var a=c.mod(this.m);
return a===c?a.clone():a};d.prototype.convertFrom=function(c){c=c.clone();c.red=null;return c};n.mont=function(c){return new f(c)};a(f,d);f.prototype.convertTo=function(c){return this.imod(c.shln(this.shift))};f.prototype.convertFrom=function(c){c=this.imod(c.mul(this.rinv));c.red=null;return c};f.prototype.imul=function(c,a){if(0===c.cmpn(0)||0===a.cmpn(0))return c.words[0]=0,c.length=1,c;var d=c.imul(a),e=d.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),e=d=d.isub(e).ishrn(this.shift);
0<=d.cmp(this.m)?e=d.isub(this.m):0>d.cmpn(0)&&(e=d.iadd(this.m));return e._forceRed(this)};f.prototype.mul=function(c,a){if(0===c.cmpn(0)||0===a.cmpn(0))return(new n(0))._forceRed(this);var d=c.mul(a),e=d.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),e=d=d.isub(e).ishrn(this.shift);0<=d.cmp(this.m)?e=d.isub(this.m):0>d.cmpn(0)&&(e=d.iadd(this.m));return e._forceRed(this)};f.prototype.invm=function(c){return this.imod(c._invmp(this.m).mul(this.r2))._forceRed(this)}})("undefined"===
typeof h||h,this)},{}],50:[function(b,h,q){var t=b("./lib/bn-sign");h.exports=function(b){return t(b[0])*t(b[1])}},{"./lib/bn-sign":41}],51:[function(b,h,q){var t=b("./lib/rationalize");h.exports=function(b,e){return t(b[0].mul(e[1]).sub(b[1].mul(e[0])),b[1].mul(e[1]))}},{"./lib/rationalize":46}],52:[function(b,h,q){var t=b("./lib/bn-to-num"),r=b("./lib/ctz");h.exports=function(e){var a=e[0];e=e[1];if(0===a.cmpn(0))return 0;var b=a.divmod(e),a=t(b.div),b=b.mod;if(0===b.cmpn(0))return a;if(a){var k=
r(a)+4;e=t(b.shln(k).divRound(e));0>a&&(e=-e);return a+e*Math.pow(2,-k)}a=e.bitLength()-b.bitLength()+53;e=t(b.shln(a).divRound(e));if(1023>a)return e*Math.pow(2,-a);e*=Math.pow(2,-1023);return e*Math.pow(2,1023-a)}},{"./lib/bn-to-num":42,"./lib/ctz":43}],53:[function(b,h,q){function t(e,a,b,k,l){e=["function ",e,"(a,l,h,",k.join(","),"){",l?"":"var i=",b?"l-1":"h+1",";while(l<=h){var m=(l+h)>>>1,x=a[m]"];l?0>a.indexOf("c")?e.push(";if(x===y){return m}else if(x<=y){"):e.push(";var p=c(x,y);if(p===0){return m}else if(p<=0){"):
e.push(";if(",a,"){i=m;");b?e.push("l=m+1}else{h=m-1}"):e.push("h=m-1}else{l=m+1}");e.push("}");l?e.push("return -1};"):e.push("return i};");return e.join("")}function r(e,a,b,k){return(new Function([t("A","x"+e+"y",a,["y"],k),t("P","c(x,y)"+e+"0",a,["y","c"],k),"function dispatchBsearch",b,"(a,y,c,l,h){if(typeof(c)==='function'){return P(a,(l===void 0)?0:l|0,(h===void 0)?a.length-1:h|0,y,c)}else{return A(a,(c===void 0)?0:c|0,(l===void 0)?a.length-1:l|0,y)}}return dispatchBsearch",b].join("")))()}
h.exports={ge:r(">=",!1,"GE"),gt:r(">",!1,"GT"),lt:r("<",!0,"LT"),le:r("<=",!0,"LE"),eq:r("-",!0,"EQ",!0)}},{}],54:[function(b,h,q){function t(e){var a=32;(e&=-e)&&a--;e&65535&&(a-=16);e&16711935&&(a-=8);e&252645135&&(a-=4);e&858993459&&(a-=2);e&1431655765&&--a;return a}"use restrict";q.INT_BITS=32;q.INT_MAX=2147483647;q.INT_MIN=-2147483648;q.sign=function(e){return(0<e)-(0>e)};q.abs=function(e){var a=e>>31;return(e^a)-a};q.min=function(e,a){return a^(e^a)&-(e<a)};q.max=function(e,a){return e^(e^
a)&-(e<a)};q.isPow2=function(e){return!(e&e-1)&&!!e};q.log2=function(e){var a,b;a=(65535<e)<<4;e>>>=a;b=(255<e)<<3;e>>>=b;a|=b;b=(15<e)<<2;e>>>=b;a|=b;b=(3<e)<<1;return a|b|e>>>b>>1};q.log10=function(e){return 1E9<=e?9:1E8<=e?8:1E7<=e?7:1E6<=e?6:1E5<=e?5:1E4<=e?4:1E3<=e?3:100<=e?2:10<=e?1:0};q.popCount=function(e){e-=e>>>1&1431655765;e=(e&858993459)+(e>>>2&858993459);return 16843009*(e+(e>>>4)&252645135)>>>24};q.countTrailingZeros=t;q.nextPow2=function(e){e+=0===e;--e;e|=e>>>1;e|=e>>>2;e|=e>>>4;e|=
e>>>8;return(e|e>>>16)+1};q.prevPow2=function(e){e|=e>>>1;e|=e>>>2;e|=e>>>4;e|=e>>>8;e|=e>>>16;return e-(e>>>1)};q.parity=function(e){e^=e>>>16;e^=e>>>8;e=(e^e>>>4)&15;return 27030>>>e&1};var r=Array(256);(function(e){for(var a=0;256>a;++a){for(var b=a,k=a,l=7,b=b>>>1;b;b>>>=1)k<<=1,k|=b&1,--l;e[a]=k<<l&255}})(r);q.reverse=function(e){return r[e&255]<<24|r[e>>>8&255]<<16|r[e>>>16&255]<<8|r[e>>>24&255]};q.interleave2=function(e,a){e&=65535;e=(e|e<<8)&16711935;e=(e|e<<4)&252645135;e=(e|e<<2)&858993459;
a&=65535;a=(a|a<<8)&16711935;a=(a|a<<4)&252645135;a=(a|a<<2)&858993459;return(e|e<<1)&1431655765|((a|a<<1)&1431655765)<<1};q.deinterleave2=function(e,a){e=e>>>a&1431655765;e=(e|e>>>1)&858993459;e=(e|e>>>2)&252645135;e=(e|e>>>4)&16711935;return((e|e>>>16)&65535)<<16>>16};q.interleave3=function(e,a,b){e&=1023;e=(e|e<<16)&4278190335;e=(e|e<<8)&251719695;e=(e|e<<4)&3272356035;a&=1023;a=(a|a<<16)&4278190335;a=(a|a<<8)&251719695;a=(a|a<<4)&3272356035;e=(e|e<<2)&1227133513|((a|a<<2)&1227133513)<<1;b&=1023;
b=(b|b<<16)&4278190335;b=(b|b<<8)&251719695;b=(b|b<<4)&3272356035;return e|((b|b<<2)&1227133513)<<2};q.deinterleave3=function(e,a){e=e>>>a&1227133513;e=(e|e>>>2)&3272356035;e=(e|e>>>4)&251719695;e=(e|e>>>8)&4278190335;return((e|e>>>16)&1023)<<22>>22};q.nextCombination=function(e){var a=e|e-1;return a+1|(~a&-~a)-1>>>t(e)+1}},{}],55:[function(b,h,q){function t(a,e,b,k){for(var g=0,d=0,f=0,p=a.length;f<p;++f){var l=a[f],n;a:{for(n=0;n<e;++n)if(!(l[n]<=l[n+e])){n=!0;break a}n=!1}if(!n){for(n=0;n<2*e;++n)b[g++]=
l[n];k[d++]=f}}return d}function r(e,b,l,m){var g=e.length,d=b.length;if(!(0>=g||0>=d)){var f=e[0].length>>>1;if(!(0>=f)){var p,x=a.mallocDouble(2*f*g),r=a.mallocInt32(g),g=t(e,f,x,r);if(0<g){if(1===f&&m)n.init(g),p=n.sweepComplete(f,l,0,g,x,r,0,g,x,r);else{e=a.mallocDouble(2*f*d);var C=a.mallocInt32(d),d=t(b,f,e,C);0<d&&(n.init(g+d),p=1===f?n.sweepBipartite(f,l,0,g,x,r,0,d,e,C):k(f,l,m,g,x,r,d,e,C),a.free(e),a.free(C))}a.free(x);a.free(r)}return p}}}function e(a,e){l.push([a,e])}h.exports=function(a,
b,k){switch(arguments.length){case 1:return l=[],r(a,a,e,!0),l;case 2:if("function"===typeof b)return r(a,a,b,!0);l=[];r(a,b,e,!1);return l;case 3:return r(a,b,k,!1);default:throw Error("box-intersect: Invalid arguments");}};var a=b("typedarray-pool"),n=b("./lib/sweep"),k=b("./lib/intersect"),l},{"./lib/intersect":57,"./lib/sweep":61,"typedarray-pool":123}],56:[function(b,h,q){function t(e){function a(a,b){var m,g="bruteForce"+(a?"Red":"Blue")+(b?"Flip":"")+(e?"Full":"");m=["function ",g,"(",r.join(),
"){","var ","es","=2*","d",";"];var d="for(var j=bs,bp=es*bs;j<be;++j,bp+=es){var y0=bb[ax+bp],"+(e?"y1=bb[ax+bp+d],":"")+"yi=bi[j];";a?m.push("for(var i=rs,rp=es*rs;i<re;++i,rp+=es){var x0=rb[ax+rp],x1=rb[ax+rp+d],xi=ri[i];","Q",":",d):m.push(d,"Q",":","for(var i=rs,rp=es*rs;i<re;++i,rp+=es){var x0=rb[ax+rp],x1=rb[ax+rp+d],xi=ri[i];");e?m.push("if(y1<x0||x1<y0)continue;"):b?m.push("if(y0<=x0||x1<y0)continue;"):m.push("if(y0<x0||x1<y0)continue;");m.push("for(var k=ax+1;k<d;++k){var r0=rb[k+rp],r1=rb[k+d+rp],b0=bb[k+bp],b1=bb[k+d+bp];if(r1<b0||b1<r0)continue Q;}var rv=vv(");
b?m.push("yi,xi"):m.push("xi,yi");m.push(");if(rv!==void 0)return rv;}}}");m=m.join("");k.push(m);t.push("return "+g+"("+r.join()+");")}var b="bruteForce"+(e?"Full":"Partial"),k=[],l=r.slice();e||l.splice(3,0,"fp");var t=["function "+b+"("+l.join()+"){"];t.push("if(re-rs>be-bs){");e?(a(!0,!1),t.push("}else{"),a(!1,!1)):(t.push("if(fp){"),a(!0,!0),t.push("}else{"),a(!0,!1),t.push("}}else{if(fp){"),a(!1,!0),t.push("}else{"),a(!1,!1),t.push("}"));t.push("}}return "+b);b=k.join("")+t.join("");return(new Function(b))()}
var r="d ax vv rs re rb ri bs be bb bi".split(" ");q.partial=t(!1);q.full=t(!0)},{}],57:[function(b,h,q){function t(a,d,e,b,f,g,p,k,m){var l=z*a;c[l]=d;c[l+1]=e;c[l+2]=b;c[l+3]=f;c[l+4]=g;c[l+5]=p;a*=C;y[a]=k;y[a+1]=m}h.exports=function(b,h,w,q,N,G,F,R,M){var K=8*e.log2(q+F+1)*(b+1)|0,J=e.nextPow2(z*K);c.length<J&&(r.free(c),c=r.mallocInt32(J));K=e.nextPow2(C*K);y<K&&(r.free(y),y=r.mallocDouble(K));var K=0,J=2*b,L;t(K++,0,0,q,0,F,w?16:0,-Infinity,Infinity);for(w||t(K++,0,0,F,0,q,1,-Infinity,Infinity);0<
K;){--K;w=K*z;var H=c[w];F=c[w+1];var Q=c[w+2],I=c[w+3],U=c[w+4];w=c[w+5];q=K*C;var Z=y[q],aa=y[q+1],X=w&1,T=!!(w&16),O=N,P=G,W=R;q=M;X&&(O=R,P=M,W=N,q=G);if(w&2&&(Q=d(b,H,F,Q,O,P,aa),F>=Q))continue;if(w&4&&(F=f(b,H,F,Q,O,P,Z),F>=Q))continue;w=Q-F;var S=U-I;if(T){if(b*w*(w+S)<u){L=k.scanComplete(b,H,h,F,Q,O,P,I,U,W,q);if(void 0!==L)return L;continue}}else if(b*Math.min(w,S)<A){L=a(b,H,h,X,F,Q,O,P,I,U,W,q);if(void 0!==L)return L;continue}else if(b*w*S<v){L=k.scanBipartite(b,H,h,X,F,Q,O,P,I,U,W,q);
if(void 0!==L)return L;continue}w=m(b,H,F,Q,O,P,Z,aa);if(F<w)if(b*(w-F)<A){if(L=n(b,H+1,h,F,w,O,P,I,U,W,q),void 0!==L)return L}else if(H===b-2){if(L=X?k.sweepBipartite(b,h,I,U,W,q,F,w,O,P):k.sweepBipartite(b,h,F,w,O,P,I,U,W,q),void 0!==L)return L}else t(K++,H+1,F,w,I,U,X,-Infinity,Infinity),t(K++,H+1,I,U,F,w,X^1,-Infinity,Infinity);if(w<Q)if(F=l(b,H,I,U,W,q),L=W[J*F+H],S=g(b,H,F,U,W,q,L),S<U&&t(K++,H,w,Q,S,U,(X|4)+(T?16:0),L,aa),I<F&&t(K++,H,w,Q,I,F,(X|2)+(T?16:0),Z,L),F+1===S){if(T)a:{I=b;U=h;q=
q[F];X=2*I;F*=X;Z=W[F+H];aa=w;w*=X;b:for(;aa<Q;++aa,w+=X)if(T=P[aa],T!==q&&(S=O[w+H],L=O[w+H+I],!(Z<S||L<Z))){for(var da=H+1;da<I;++da){S=O[w+da];L=O[w+da+I];var Y=W[F+da+I];if(L<W[F+da]||Y<S)continue b}T=U(T,q);if(void 0!==T){L=T;break a}}L=void 0}else a:{I=b;U=h;q=q[F];Z=2*I;F*=Z;aa=W[F+H];T=w;w*=Z;b:for(;T<Q;++T,w+=Z)if(S=O[w+H],L=O[w+H+I],!(aa<S||L<aa||X&&aa===S)){da=P[T];for(Y=H+1;Y<I;++Y){S=O[w+Y];L=O[w+Y+I];var ha=W[F+Y+I];if(L<W[F+Y]||ha<S)continue b}S=X?U(q,da):U(da,q);if(void 0!==S){L=S;
break a}}L=void 0}if(void 0!==L)return L}else if(F<S)if(T){if(Q=p(b,H,w,Q,O,P,L),w<Q)if(I=g(b,H,w,Q,O,P,L),H===b-2){if(w<I&&(L=k.sweepComplete(b,h,w,I,O,P,F,S,W,q),void 0!==L)||I<Q&&(L=k.sweepBipartite(b,h,I,Q,O,P,F,S,W,q),void 0!==L))return L}else w<I&&t(K++,H+1,w,I,F,S,16,-Infinity,Infinity),I<Q&&(t(K++,H+1,I,Q,F,S,0,-Infinity,Infinity),t(K++,H+1,F,S,I,Q,1,-Infinity,Infinity))}else Q=X?x(b,H,w,Q,O,P,L):p(b,H,w,Q,O,P,L),w<Q&&(H===b-2?X?k.sweepBipartite(b,h,F,S,W,q,w,Q,O,P):k.sweepBipartite(b,h,w,
Q,O,P,F,S,W,q):(t(K++,H+1,w,Q,F,S,X,-Infinity,Infinity),t(K++,H+1,F,S,w,Q,X^1,-Infinity,Infinity)))}};var r=b("typedarray-pool"),e=b("bit-twiddle");h=b("./brute");var a=h.partial,n=h.full,k=b("./sweep"),l=b("./median");b=b("./partition");var A=128,v=4194304,u=4194304,m=b("!(lo>=p0)&&!(p1>=hi)",["p0","p1"]),g=b("lo===p0",["p0"]),d=b("lo<p0",["p0"]),f=b("hi<=p0",["p0"]),p=b("lo<=p0&&p0<=hi",["p0"]),x=b("lo<p0&&p0<=hi",["p0"]),z=6,C=2,c=r.mallocInt32(1024),y=r.mallocDouble(1024)},{"./brute":56,"./median":58,
"./partition":59,"./sweep":61,"bit-twiddle":54,"typedarray-pool":123}],58:[function(b,h,q){h.exports=function(e,a,b,k,l,A){if(k<=b+1)return b;var v=b,u=k;k=k+b>>>1;for(var m=2*e,g=k,d=l[m*k+a];v<u;){if(u-v<r){for(var g=a,d=l,f=A,p=2*e,x=p*(v+1)+g,z=v+1;z<u;++z,x+=p)for(var h=d[x],c=z,y=p*(z-1);c>v&&d[y+g]>h;--c,y-=p){for(var q=y,B=y+p,w=0;w<p;++w,++q,++B){var E=d[q];d[q]=d[B];d[B]=E}q=f[c];f[c]=f[c-1];f[c-1]=q}break}x=u-v;g=Math.random()*x+v|0;d=l[m*g+a];p=Math.random()*x+v|0;f=l[m*p+a];z=Math.random()*
x+v|0;x=l[m*z+a];d<=f?x>=f?(g=p,d=f):d>=x||(g=z,d=x):f>=x?(g=p,d=f):x>=d||(g=z,d=x);f=m*(u-1);p=m*g;for(x=0;x<m;++x,++f,++p)z=l[f],l[f]=l[p],l[p]=z;f=A[u-1];A[u-1]=A[g];A[g]=f;g=t(e,a,v,u-1,l,A,d);f=m*(u-1);p=m*g;for(x=0;x<m;++x,++f,++p)z=l[f],l[f]=l[p],l[p]=z;f=A[u-1];A[u-1]=A[g];A[g]=f;if(k<g){for(u=g-1;v<u&&l[m*(u-1)+a]===d;)--u;u+=1}else if(g<k)for(v=g+1;v<u&&l[m*v+a]===d;)v+=1;else break}return t(e,a,b,k,l,A,l[m*k+a])};var t=b("./partition")("lo<p0",["p0"]),r=8},{"./partition":59}],59:[function(b,
h,q){h.exports=function(b,e){var a="abcdef".split("").concat(e),n=[];0<=b.indexOf("lo")&&n.push("lo=e[k+n]");0<=b.indexOf("hi")&&n.push("hi=e[k+o]");a.push(t.replace("_",n.join()).replace("$",b));return Function.apply(void 0,a)};var t="for(var j=2*a,k=j*c,l=k,m=c,n=b,o=a+b,p=c;d>p;++p,k+=j){var _;if($)if(m===p)m+=1,l+=j;else{for(var s=0;j>s;++s){var t=e[k+s];e[k+s]=e[l],e[l++]=t}var u=f[p];f[p]=f[m],f[m++]=u}}return m"},{}],60:[function(b,h,q){function t(a,e,b){for(var g=2*(a+1),d=a+1;d<=e;++d){for(var f=
b[g++],p=b[g++],k=d,l=g-2;k-- >a;){var n=b[l-2],c=b[l-1];if(n<f)break;else if(n===f&&c<p)break;b[l]=n;b[l+1]=c;l-=2}b[l]=f;b[l+1]=p}}function r(a,b,e){a*=2;b*=2;var g=e[a],d=e[a+1];e[a]=e[b];e[a+1]=e[b+1];e[b]=g;e[b+1]=d}function e(a,b,e){a*=2;b*=2;e[a]=e[b];e[a+1]=e[b+1]}function a(a,b,e,g,d){a*=2;b*=2;d[a]=d[b];d[b]=e;d[a+1]=d[b+1];d[b+1]=g}function n(a,b,e){a*=2;b*=2;var g=e[a],d=e[b];return g<d?!1:g===d?e[a+1]>e[b+1]:!0}function k(a,b,e,g){a*=2;var d=g[a];return d<b?!0:d===b?g[a+1]<e:!1}function l(b,
u,m){var g=(u-b+1)/6|0,d=b+g,f=u-g,p=b+u>>1,x=p-g,z=p+g,h=d,c=x,y=p,q=z,B=f,g=b+1,w=u-1,E=0;n(h,c,m)&&(E=h,h=c,c=E);n(q,B,m)&&(E=q,q=B,B=E);n(h,y,m)&&(E=h,h=y,y=E);n(c,y,m)&&(E=c,c=y,y=E);n(h,q,m)&&(E=h,h=q,q=E);n(y,q,m)&&(E=y,y=q,q=E);n(c,B,m)&&(E=c,c=B,B=E);n(c,y,m)&&(E=c,c=y,y=E);n(q,B,m)&&(E=q,q=B,B=E);for(var E=m[2*c],c=m[2*c+1],N=m[2*q],q=m[2*q+1],h=2*h,y=2*y,B=2*B,d=2*d,p=2*p,f=2*f,G=0;2>G;++G){var F=m[y+G],R=m[B+G];m[d+G]=m[h+G];m[p+G]=F;m[f+G]=R}e(x,b,m);e(z,u,m);for(x=g;x<=w;++x)if(k(x,
E,c,m))x!==g&&r(x,g,m),++g;else if(!k(x,N,q,m))for(;;)if(k(w,N,q,m)){k(w,E,c,m)?(z=x,f=g,p=w,h=m,z*=2,f*=2,p*=2,d=h[z],y=h[z+1],h[z]=h[f],h[z+1]=h[f+1],h[f]=h[p],h[f+1]=h[p+1],h[p]=d,h[p+1]=y,++g):r(x,w,m);--w;break}else if(--w<x)break;a(b,g-1,E,c,m);a(u,w+1,N,q,m);g-2-b<=A?t(b,g-2,m):l(b,g-2,m);u-(w+2)<=A?t(w+2,u,m):l(w+2,u,m);w-g<=A?t(g,w,m):l(g,w,m)}h.exports=function(a,b){b<=4*A?t(0,b-1,a):l(0,b-1,a)};var A=32},{}],61:[function(b,h,q){function t(a,b,e,g){g=b[g];e=a[e-1];a[g]=e;b[e]=g}h.exports=
{init:function(a){a=e.nextPow2(a);k.length<a&&(r.free(k),k=r.mallocInt32(a));l.length<a&&(r.free(l),l=r.mallocInt32(a));A.length<a&&(r.free(A),A=r.mallocInt32(a));v.length<a&&(r.free(v),v=r.mallocInt32(a));u.length<a&&(r.free(u),u=r.mallocInt32(a));m.length<a&&(r.free(m),m=r.mallocInt32(a));a*=8;g.length<a&&(r.free(g),g=r.mallocDouble(a))},sweepBipartite:function(d,b,e,m,u,r,c,h,q,B){var w=0,E=2*d;--d;for(var N=E-1;e<m;++e){var G=r[e],F=E*e;g[w++]=u[F+d];g[w++]=-(G+1);g[w++]=u[F+N];g[w++]=G}for(e=
c;e<h;++e)G=B[e]+n,m=E*e,g[w++]=q[m+d],g[w++]=-G,g[w++]=q[m+N],g[w++]=G;h=w>>>1;a(g,h);for(e=B=q=0;e<h;++e)if(w=g[2*e+1]|0,w>=n)w=w-n|0,t(A,v,B--,w);else if(0<=w)t(k,l,q--,w);else{if(w<=-n){w=-w-n|0;for(E=0;E<q;++E)if(m=b(k[E],w),void 0!==m)return m;E=v;m=B++;A[m]=w}else{w=-w-1|0;for(E=0;E<B;++E)if(m=b(w,A[E]),void 0!==m)return m;E=l;m=q++;k[m]=w}E[w]=m}},sweepComplete:function(d,b,e,n,r,h,c,q,D,B){var w=0,E=2*d;--d;for(var N=E-1;e<n;++e){var G=h[e]+1<<1,F=E*e;g[w++]=r[F+d];g[w++]=-G;g[w++]=r[F+N];
g[w++]=G}for(e=c;e<q;++e)G=B[e]+1<<1,n=E*e,g[w++]=D[n+d],g[w++]=-G|1,g[w++]=D[n+N],g[w++]=G|1;q=w>>>1;a(g,q);for(e=w=B=D=0;e<q;++e)if(E=g[2*e+1]|0,n=E&1,e<q-1&&E>>1===g[2*e+3]>>1&&(n=2,e+=1),0>E){E=-(E>>1)-1;for(r=0;r<w;++r)if(h=b(u[r],E),void 0!==h)return h;if(0!==n)for(r=0;r<D;++r)if(h=b(k[r],E),void 0!==h)return h;if(1!==n)for(r=0;r<B;++r)if(h=b(A[r],E),void 0!==h)return h;0===n?(n=l,r=D++,k[r]=E,n[E]=r):1===n?(n=v,r=B++,A[r]=E,n[E]=r):2===n&&(n=m,r=w++,u[r]=E,n[E]=r)}else E=(E>>1)-1,0===n?t(k,
l,D--,E):1===n?t(A,v,B--,E):2===n&&t(u,m,w--,E)},scanBipartite:function(d,e,b,m,r,u,c,v,A,h,q,E){var N=0,G=2*d,F=e+d,R=1,M=1;for(m?M=n:R=n;r<u;++r){var K=r+R,J=G*r;g[N++]=c[J+e];g[N++]=-K;g[N++]=c[J+F];g[N++]=K}for(r=A;r<h;++r)K=r+M,u=G*r,g[N++]=q[u+e],g[N++]=-K;h=N>>>1;a(g,h);for(r=N=0;r<h;++r)if(K=g[2*r+1]|0,0>K)if(K=-K,M=!1,K>=n?(M=!m,K-=n):(M=!!m,--K),M)M=l,u=N++,k[u]=K,M[K]=u;else a:for(M=E[K],K*=G,u=q[K+e+1],A=q[K+e+1+d],F=0;F<N;++F){var J=k[F],L=G*J;if(!(A<c[L+e+1]||c[L+e+1+d]<u)){for(var H=
e+2;H<d;++H)if(q[K+H+d]<c[L+H]||c[L+H+d]<q[K+H])continue a;J=v[J];J=m?b(M,J):b(J,M);if(void 0!==J)return J}}else t(k,l,N--,K-R)},scanComplete:function(d,e,b,l,m,r,c,u,t,v,A){for(var h=0,q=2*d,G=e+d;l<m;++l){var F=l+n,R=q*l;g[h++]=r[R+e];g[h++]=-F;g[h++]=r[R+G];g[h++]=F}for(l=u;l<t;++l)F=l+1,m=q*l,g[h++]=v[m+e],g[h++]=-F;t=h>>>1;a(g,t);for(l=h=0;l<t;++l)if(m=g[2*l+1]|0,0>m)if(F=-m,F>=n)k[h++]=F-n;else a:for(--F,m=A[F],F*=q,G=v[F+e+1],R=v[F+e+1+d],u=0;u<h;++u){var M=k[u],K=c[M];if(K===m)break;M*=q;
if(!(R<r[M+e+1]||r[M+e+1+d]<G)){for(var J=e+2;J<d;++J)if(v[F+J+d]<r[M+J]||r[M+J+d]<v[F+J])continue a;K=b(K,m);if(void 0!==K)return K}}else{F=m-n;for(u=h-1;0<=u;--u)if(k[u]===F){for(J=u+1;J<h;++J)k[J-1]=k[J];break}--h}}};var r=b("typedarray-pool"),e=b("bit-twiddle"),a=b("./sort"),n=268435456,k=r.mallocInt32(1024),l=r.mallocInt32(1024),A=r.mallocInt32(1024),v=r.mallocInt32(1024),u=r.mallocInt32(1024),m=r.mallocInt32(1024),g=r.mallocDouble(8192)},{"./sort":60,"bit-twiddle":54,"typedarray-pool":123}],
62:[function(b,h,q){(function(t){function r(){try{var c=new Uint8Array(1);c.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}};return 42===c.foo()&&"function"===typeof c.subarray&&0===c.subarray(1,1).byteLength}catch(a){return!1}}function e(c,d){if((a.TYPED_ARRAY_SUPPORT?2147483647:1073741823)<d)throw new RangeError("Invalid typed array length");a.TYPED_ARRAY_SUPPORT?(c=new Uint8Array(d),c.__proto__=a.prototype):(null===c&&(c=new a(d)),c.length=d);return c}function a(c,d,e){if(!(a.TYPED_ARRAY_SUPPORT||
this instanceof a))return new a(c,d,e);if("number"===typeof c){if("string"===typeof d)throw Error("If encoding is specified then the first argument must be a string");return l(this,c)}return n(this,c,d,e)}function n(c,d,b,f){if("number"===typeof d)throw new TypeError('"value" argument must not be a number');if("undefined"!==typeof ArrayBuffer&&d instanceof ArrayBuffer){d.byteLength;if(0>b||d.byteLength<b)throw new RangeError("'offset' is out of bounds");if(d.byteLength<b+(f||0))throw new RangeError("'length' is out of bounds");
d=void 0===b&&void 0===f?new Uint8Array(d):void 0===f?new Uint8Array(d,b):new Uint8Array(d,b,f);a.TYPED_ARRAY_SUPPORT?(c=d,c.__proto__=a.prototype):c=A(c,d);return c}if("string"===typeof d){f=c;c=b;if("string"!==typeof c||""===c)c="utf8";if(!a.isEncoding(c))throw new TypeError('"encoding" must be a valid string encoding');b=m(d,c)|0;f=e(f,b);d=f.write(d,c);d!==b&&(f=f.slice(0,d));return f}return v(c,d)}function k(c){if("number"!==typeof c)throw new TypeError('"size" argument must be a number');if(0>
c)throw new RangeError('"size" argument must not be negative');}function l(c,d){k(d);c=e(c,0>d?0:u(d)|0);if(!a.TYPED_ARRAY_SUPPORT)for(var b=0;b<d;++b)c[b]=0;return c}function A(c,a){var d=0>a.length?0:u(a.length)|0;c=e(c,d);for(var b=0;b<d;b+=1)c[b]=a[b]&255;return c}function v(c,d){if(a.isBuffer(d)){var b=u(d.length)|0;c=e(c,b);if(0===c.length)return c;d.copy(c,0,0,b);return c}if(d){if("undefined"!==typeof ArrayBuffer&&d.buffer instanceof ArrayBuffer||"length"in d)return(b="number"!==typeof d.length)||
(b=d.length,b=b!==b),b?e(c,0):A(c,d);if("Buffer"===d.type&&K(d.data))return A(c,d.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");}function u(c){if(c>=(a.TYPED_ARRAY_SUPPORT?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(a.TYPED_ARRAY_SUPPORT?2147483647:1073741823).toString(16)+" bytes");return c|0}function m(c,d){if(a.isBuffer(c))return c.length;if("undefined"!==typeof ArrayBuffer&&
"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(c)||c instanceof ArrayBuffer))return c.byteLength;"string"!==typeof c&&(c=""+c);var b=c.length;if(0===b)return 0;for(var e=!1;;)switch(d){case "ascii":case "latin1":case "binary":return b;case "utf8":case "utf-8":case void 0:return N(c).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*b;case "hex":return b>>>1;case "base64":return R.toByteArray(E(c)).length;default:if(e)return N(c).length;d=(""+d).toLowerCase();e=!0}}
function g(c,a,d){var b=!1;if(void 0===a||0>a)a=0;if(a>this.length)return"";if(void 0===d||d>this.length)d=this.length;if(0>=d)return"";d>>>=0;a>>>=0;if(d<=a)return"";for(c||(c="utf8");;)switch(c){case "hex":c=a;a=d;d=this.length;if(!c||0>c)c=0;if(!a||0>a||a>d)a=d;b="";for(d=c;d<a;++d)c=b,b=this[d],b=16>b?"0"+b.toString(16):b.toString(16),b=c+b;return b;case "utf8":case "utf-8":return x(this,a,d);case "ascii":c="";for(d=Math.min(this.length,d);a<d;++a)c+=String.fromCharCode(this[a]&127);return c;
case "latin1":case "binary":c="";for(d=Math.min(this.length,d);a<d;++a)c+=String.fromCharCode(this[a]);return c;case "base64":return a=0===a&&d===this.length?R.fromByteArray(this):R.fromByteArray(this.slice(a,d)),a;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":a=this.slice(a,d);d="";for(c=0;c<a.length;c+=2)d+=String.fromCharCode(a[c]+256*a[c+1]);return d;default:if(b)throw new TypeError("Unknown encoding: "+c);c=(c+"").toLowerCase();b=!0}}function d(c,a,d){var b=c[a];c[a]=c[d];c[d]=b}function f(c,
d,b,e,f){if(0===c.length)return-1;"string"===typeof b?(e=b,b=0):2147483647<b?b=2147483647:-2147483648>b&&(b=-2147483648);b=+b;isNaN(b)&&(b=f?0:c.length-1);0>b&&(b=c.length+b);if(b>=c.length){if(f)return-1;b=c.length-1}else if(0>b)if(f)b=0;else return-1;"string"===typeof d&&(d=a.from(d,e));if(a.isBuffer(d))return 0===d.length?-1:p(c,d,b,e,f);if("number"===typeof d)return d&=255,a.TYPED_ARRAY_SUPPORT&&"function"===typeof Uint8Array.prototype.indexOf?f?Uint8Array.prototype.indexOf.call(c,d,b):Uint8Array.prototype.lastIndexOf.call(c,
d,b):p(c,[d],b,e,f);throw new TypeError("val must be string, number or Buffer");}function p(c,a,d,b,e){function f(c,a){return 1===g?c[a]:c.readUInt16BE(a*g)}var g=1,p=c.length,k=a.length;if(void 0!==b&&(b=String(b).toLowerCase(),"ucs2"===b||"ucs-2"===b||"utf16le"===b||"utf-16le"===b)){if(2>c.length||2>a.length)return-1;g=2;p/=2;k/=2;d/=2}if(e)for(b=-1;d<p;d++)if(f(c,d)===f(a,-1===b?0:d-b)){if(-1===b&&(b=d),d-b+1===k)return b*g}else-1!==b&&(d-=d-b),b=-1;else for(d+k>p&&(d=p-k);0<=d;d--){p=!0;for(b=
0;b<k;b++)if(f(c,d+b)!==f(a,b)){p=!1;break}if(p)return d}return-1}function x(c,a,d){d=Math.min(c.length,d);for(var b=[];a<d;){var e=c[a],f=null,g=239<e?4:223<e?3:191<e?2:1;if(a+g<=d){var p,k,l;switch(g){case 1:128>e&&(f=e);break;case 2:p=c[a+1];128===(p&192)&&(e=(e&31)<<6|p&63,127<e&&(f=e));break;case 3:p=c[a+1];k=c[a+2];128===(p&192)&&128===(k&192)&&(e=(e&15)<<12|(p&63)<<6|k&63,2047<e&&(55296>e||57343<e)&&(f=e));break;case 4:p=c[a+1],k=c[a+2],l=c[a+3],128===(p&192)&&128===(k&192)&&128===(l&192)&&
(e=(e&15)<<18|(p&63)<<12|(k&63)<<6|l&63,65535<e&&1114112>e&&(f=e))}}null===f?(f=65533,g=1):65535<f&&(f-=65536,b.push(f>>>10&1023|55296),f=56320|f&1023);b.push(f);a+=g}c=b.length;if(c<=J)b=String.fromCharCode.apply(String,b);else{d="";for(a=0;a<c;)d+=String.fromCharCode.apply(String,b.slice(a,a+=J));b=d}return b}function h(c,a,d){if(0!==c%1||0>c)throw new RangeError("offset is not uint");if(c+a>d)throw new RangeError("Trying to access beyond buffer length");}function C(c,d,b,e,f,g){if(!a.isBuffer(c))throw new TypeError('"buffer" argument must be a Buffer instance');
if(d>f||d<g)throw new RangeError('"value" argument is out of bounds');if(b+e>c.length)throw new RangeError("Index out of range");}function c(c,a,d,b){0>a&&(a=65535+a+1);for(var e=0,f=Math.min(c.length-d,2);e<f;++e)c[d+e]=(a&255<<8*(b?e:1-e))>>>8*(b?e:1-e)}function y(c,a,d,b){0>a&&(a=4294967295+a+1);for(var e=0,f=Math.min(c.length-d,4);e<f;++e)c[d+e]=a>>>8*(b?e:3-e)&255}function D(c,a,d,b,e,f){if(d+b>c.length)throw new RangeError("Index out of range");if(0>d)throw new RangeError("Index out of range");
}function B(c,a,d,b,e){e||D(c,a,d,4,3.4028234663852886E38,-3.4028234663852886E38);M.write(c,a,d,b,23,4);return d+4}function w(c,a,d,b,e){e||D(c,a,d,8,1.7976931348623157E308,-1.7976931348623157E308);M.write(c,a,d,b,52,8);return d+8}function E(c){c=c.trim?c.trim():c.replace(/^\s+|\s+$/g,"");c=c.replace(L,"");if(2>c.length)return"";for(;0!==c.length%4;)c+="=";return c}function N(c,a){a=a||Infinity;for(var d,b=c.length,e=null,f=[],g=0;g<b;++g){d=c.charCodeAt(g);if(55295<d&&57344>d){if(!e){if(56319<d){-1<
(a-=3)&&f.push(239,191,189);continue}else if(g+1===b){-1<(a-=3)&&f.push(239,191,189);continue}e=d;continue}if(56320>d){-1<(a-=3)&&f.push(239,191,189);e=d;continue}d=(e-55296<<10|d-56320)+65536}else e&&-1<(a-=3)&&f.push(239,191,189);e=null;if(128>d){if(0>--a)break;f.push(d)}else if(2048>d){if(0>(a-=2))break;f.push(d>>6|192,d&63|128)}else if(65536>d){if(0>(a-=3))break;f.push(d>>12|224,d>>6&63|128,d&63|128)}else if(1114112>d){if(0>(a-=4))break;f.push(d>>18|240,d>>12&63|128,d>>6&63|128,d&63|128)}else throw Error("Invalid code point");
}return f}function G(c){for(var a=[],d=0;d<c.length;++d)a.push(c.charCodeAt(d)&255);return a}function F(c,a,d,b){for(var e=0;e<b&&!(e+d>=a.length||e>=c.length);++e)a[e+d]=c[e];return e}var R=b("base64-js"),M=b("ieee754"),K=b("isarray");q.Buffer=a;q.SlowBuffer=function(c){+c!=c&&(c=0);return a.alloc(+c)};q.INSPECT_MAX_BYTES=50;a.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:r();q.kMaxLength=a.TYPED_ARRAY_SUPPORT?2147483647:1073741823;a.poolSize=8192;a._augment=function(c){c.__proto__=
a.prototype;return c};a.from=function(c,a,d){return n(null,c,a,d)};a.TYPED_ARRAY_SUPPORT&&(a.prototype.__proto__=Uint8Array.prototype,a.__proto__=Uint8Array,$jscomp.initSymbol(),$jscomp.initSymbol(),$jscomp.initSymbol(),"undefined"!==typeof Symbol&&Symbol.species&&a[Symbol.species]===a&&($jscomp.initSymbol(),Object.defineProperty(a,Symbol.species,{value:null,configurable:!0})));a.alloc=function(c,a,d){k(c);c=0>=c?e(null,c):void 0!==a?"string"===typeof d?e(null,c).fill(a,d):e(null,c).fill(a):e(null,
c);return c};a.allocUnsafe=function(c){return l(null,c)};a.allocUnsafeSlow=function(c){return l(null,c)};a.isBuffer=function(c){return!(null==c||!c._isBuffer)};a.compare=function(c,d){if(!a.isBuffer(c)||!a.isBuffer(d))throw new TypeError("Arguments must be Buffers");if(c===d)return 0;for(var b=c.length,e=d.length,f=0,g=Math.min(b,e);f<g;++f)if(c[f]!==d[f]){b=c[f];e=d[f];break}return b<e?-1:e<b?1:0};a.isEncoding=function(c){switch(String(c).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;
default:return!1}};a.concat=function(c,d){if(!K(c))throw new TypeError('"list" argument must be an Array of Buffers');if(0===c.length)return a.alloc(0);var b;if(void 0===d)for(b=d=0;b<c.length;++b)d+=c[b].length;var e=a.allocUnsafe(d),f=0;for(b=0;b<c.length;++b){var g=c[b];if(!a.isBuffer(g))throw new TypeError('"list" argument must be an Array of Buffers');g.copy(e,f);f+=g.length}return e};a.byteLength=m;a.prototype._isBuffer=!0;a.prototype.swap16=function(){var c=this.length;if(0!==c%2)throw new RangeError("Buffer size must be a multiple of 16-bits");
for(var a=0;a<c;a+=2)d(this,a,a+1);return this};a.prototype.swap32=function(){var c=this.length;if(0!==c%4)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var a=0;a<c;a+=4)d(this,a,a+3),d(this,a+1,a+2);return this};a.prototype.swap64=function(){var c=this.length;if(0!==c%8)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var a=0;a<c;a+=8)d(this,a,a+7),d(this,a+1,a+6),d(this,a+2,a+5),d(this,a+3,a+4);return this};a.prototype.toString=function(){var c=this.length|
0;return 0===c?"":0===arguments.length?x(this,0,c):g.apply(this,arguments)};a.prototype.equals=function(c){if(!a.isBuffer(c))throw new TypeError("Argument must be a Buffer");return this===c?!0:0===a.compare(this,c)};a.prototype.inspect=function(){var c="",a=q.INSPECT_MAX_BYTES;0<this.length&&(c=this.toString("hex",0,a).match(/.{2}/g).join(" "),this.length>a&&(c+=" ... "));return"<Buffer "+c+">"};a.prototype.compare=function(c,d,b,e,f){if(!a.isBuffer(c))throw new TypeError("Argument must be a Buffer");
void 0===d&&(d=0);void 0===b&&(b=c?c.length:0);void 0===e&&(e=0);void 0===f&&(f=this.length);if(0>d||b>c.length||0>e||f>this.length)throw new RangeError("out of range index");if(e>=f&&d>=b)return 0;if(e>=f)return-1;if(d>=b)return 1;d>>>=0;b>>>=0;e>>>=0;f>>>=0;if(this===c)return 0;var g=f-e,p=b-d,k=Math.min(g,p);e=this.slice(e,f);c=c.slice(d,b);for(d=0;d<k;++d)if(e[d]!==c[d]){g=e[d];p=c[d];break}return g<p?-1:p<g?1:0};a.prototype.includes=function(c,a,d){return-1!==this.indexOf(c,a,d)};a.prototype.indexOf=
function(c,a,d){return f(this,c,a,d,!0)};a.prototype.lastIndexOf=function(c,a,d){return f(this,c,a,d,!1)};a.prototype.write=function(c,a,d,b){if(void 0===a)b="utf8",d=this.length,a=0;else if(void 0===d&&"string"===typeof a)b=a,d=this.length,a=0;else if(isFinite(a))a|=0,isFinite(d)?(d|=0,void 0===b&&(b="utf8")):(b=d,d=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var e=this.length-a;if(void 0===d||d>e)d=e;if(0<c.length&&(0>d||0>a)||a>this.length)throw new RangeError("Attempt to write outside buffer bounds");
b||(b="utf8");for(e=!1;;)switch(b){case "hex":a:{a=Number(a)||0;b=this.length-a;d?(d=Number(d),d>b&&(d=b)):d=b;b=c.length;if(0!==b%2)throw new TypeError("Invalid hex string");d>b/2&&(d=b/2);for(b=0;b<d;++b){e=parseInt(c.substr(2*b,2),16);if(isNaN(e)){c=b;break a}this[a+b]=e}c=b}return c;case "utf8":case "utf-8":return F(N(c,this.length-a),this,a,d);case "ascii":return F(G(c),this,a,d);case "latin1":case "binary":return F(G(c),this,a,d);case "base64":return F(R.toByteArray(E(c)),this,a,d);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":b=
this.length-a;for(var f=void 0,f=e=void 0,g=[],p=0;p<c.length&&!(0>(b-=2));++p)f=c.charCodeAt(p),e=f>>8,f%=256,g.push(f),g.push(e);return F(g,this,a,d);default:if(e)throw new TypeError("Unknown encoding: "+b);b=(""+b).toLowerCase();e=!0}};a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var J=4096;a.prototype.slice=function(c,d){var b=this.length;c=~~c;d=void 0===d?b:~~d;0>c?(c+=b,0>c&&(c=0)):c>b&&(c=b);0>d?(d+=b,0>d&&(d=0)):d>b&&(d=b);d<c&&(d=
c);if(a.TYPED_ARRAY_SUPPORT)b=this.subarray(c,d),b.__proto__=a.prototype;else for(var e=d-c,b=new a(e,void 0),f=0;f<e;++f)b[f]=this[f+c];return b};a.prototype.readUIntLE=function(c,a,d){c|=0;a|=0;d||h(c,a,this.length);d=this[c];for(var b=1,e=0;++e<a&&(b*=256);)d+=this[c+e]*b;return d};a.prototype.readUIntBE=function(c,a,d){c|=0;a|=0;d||h(c,a,this.length);d=this[c+--a];for(var b=1;0<a&&(b*=256);)d+=this[c+--a]*b;return d};a.prototype.readUInt8=function(c,a){a||h(c,1,this.length);return this[c]};a.prototype.readUInt16LE=
function(c,a){a||h(c,2,this.length);return this[c]|this[c+1]<<8};a.prototype.readUInt16BE=function(c,a){a||h(c,2,this.length);return this[c]<<8|this[c+1]};a.prototype.readUInt32LE=function(c,a){a||h(c,4,this.length);return(this[c]|this[c+1]<<8|this[c+2]<<16)+16777216*this[c+3]};a.prototype.readUInt32BE=function(c,a){a||h(c,4,this.length);return 16777216*this[c]+(this[c+1]<<16|this[c+2]<<8|this[c+3])};a.prototype.readIntLE=function(c,a,d){c|=0;a|=0;d||h(c,a,this.length);d=this[c];for(var b=1,e=0;++e<
a&&(b*=256);)d+=this[c+e]*b;d>=128*b&&(d-=Math.pow(2,8*a));return d};a.prototype.readIntBE=function(c,a,d){c|=0;a|=0;d||h(c,a,this.length);d=a;for(var b=1,e=this[c+--d];0<d&&(b*=256);)e+=this[c+--d]*b;e>=128*b&&(e-=Math.pow(2,8*a));return e};a.prototype.readInt8=function(c,a){a||h(c,1,this.length);return this[c]&128?-1*(255-this[c]+1):this[c]};a.prototype.readInt16LE=function(c,a){a||h(c,2,this.length);var d=this[c]|this[c+1]<<8;return d&32768?d|4294901760:d};a.prototype.readInt16BE=function(c,a){a||
h(c,2,this.length);var d=this[c+1]|this[c]<<8;return d&32768?d|4294901760:d};a.prototype.readInt32LE=function(c,a){a||h(c,4,this.length);return this[c]|this[c+1]<<8|this[c+2]<<16|this[c+3]<<24};a.prototype.readInt32BE=function(c,a){a||h(c,4,this.length);return this[c]<<24|this[c+1]<<16|this[c+2]<<8|this[c+3]};a.prototype.readFloatLE=function(c,a){a||h(c,4,this.length);return M.read(this,c,!0,23,4)};a.prototype.readFloatBE=function(c,a){a||h(c,4,this.length);return M.read(this,c,!1,23,4)};a.prototype.readDoubleLE=
function(c,a){a||h(c,8,this.length);return M.read(this,c,!0,52,8)};a.prototype.readDoubleBE=function(c,a){a||h(c,8,this.length);return M.read(this,c,!1,52,8)};a.prototype.writeUIntLE=function(c,a,d,b){c=+c;a|=0;d|=0;b||C(this,c,a,d,Math.pow(2,8*d)-1,0);b=1;var e=0;for(this[a]=c&255;++e<d&&(b*=256);)this[a+e]=c/b&255;return a+d};a.prototype.writeUIntBE=function(c,a,d,b){c=+c;a|=0;d|=0;b||C(this,c,a,d,Math.pow(2,8*d)-1,0);b=d-1;var e=1;for(this[a+b]=c&255;0<=--b&&(e*=256);)this[a+b]=c/e&255;return a+
d};a.prototype.writeUInt8=function(c,d,b){c=+c;d|=0;b||C(this,c,d,1,255,0);a.TYPED_ARRAY_SUPPORT||(c=Math.floor(c));this[d]=c&255;return d+1};a.prototype.writeUInt16LE=function(d,b,e){d=+d;b|=0;e||C(this,d,b,2,65535,0);a.TYPED_ARRAY_SUPPORT?(this[b]=d&255,this[b+1]=d>>>8):c(this,d,b,!0);return b+2};a.prototype.writeUInt16BE=function(d,b,e){d=+d;b|=0;e||C(this,d,b,2,65535,0);a.TYPED_ARRAY_SUPPORT?(this[b]=d>>>8,this[b+1]=d&255):c(this,d,b,!1);return b+2};a.prototype.writeUInt32LE=function(c,d,b){c=
+c;d|=0;b||C(this,c,d,4,4294967295,0);a.TYPED_ARRAY_SUPPORT?(this[d+3]=c>>>24,this[d+2]=c>>>16,this[d+1]=c>>>8,this[d]=c&255):y(this,c,d,!0);return d+4};a.prototype.writeUInt32BE=function(c,d,b){c=+c;d|=0;b||C(this,c,d,4,4294967295,0);a.TYPED_ARRAY_SUPPORT?(this[d]=c>>>24,this[d+1]=c>>>16,this[d+2]=c>>>8,this[d+3]=c&255):y(this,c,d,!1);return d+4};a.prototype.writeIntLE=function(c,a,d,b){c=+c;a|=0;b||(b=Math.pow(2,8*d-1),C(this,c,a,d,b-1,-b));b=0;var e=1,f=0;for(this[a]=c&255;++b<d&&(e*=256);)0>c&&
0===f&&0!==this[a+b-1]&&(f=1),this[a+b]=(c/e>>0)-f&255;return a+d};a.prototype.writeIntBE=function(c,a,d,b){c=+c;a|=0;b||(b=Math.pow(2,8*d-1),C(this,c,a,d,b-1,-b));b=d-1;var e=1,f=0;for(this[a+b]=c&255;0<=--b&&(e*=256);)0>c&&0===f&&0!==this[a+b+1]&&(f=1),this[a+b]=(c/e>>0)-f&255;return a+d};a.prototype.writeInt8=function(c,d,b){c=+c;d|=0;b||C(this,c,d,1,127,-128);a.TYPED_ARRAY_SUPPORT||(c=Math.floor(c));0>c&&(c=255+c+1);this[d]=c&255;return d+1};a.prototype.writeInt16LE=function(d,b,e){d=+d;b|=0;
e||C(this,d,b,2,32767,-32768);a.TYPED_ARRAY_SUPPORT?(this[b]=d&255,this[b+1]=d>>>8):c(this,d,b,!0);return b+2};a.prototype.writeInt16BE=function(d,b,e){d=+d;b|=0;e||C(this,d,b,2,32767,-32768);a.TYPED_ARRAY_SUPPORT?(this[b]=d>>>8,this[b+1]=d&255):c(this,d,b,!1);return b+2};a.prototype.writeInt32LE=function(c,d,b){c=+c;d|=0;b||C(this,c,d,4,2147483647,-2147483648);a.TYPED_ARRAY_SUPPORT?(this[d]=c&255,this[d+1]=c>>>8,this[d+2]=c>>>16,this[d+3]=c>>>24):y(this,c,d,!0);return d+4};a.prototype.writeInt32BE=
function(c,d,b){c=+c;d|=0;b||C(this,c,d,4,2147483647,-2147483648);0>c&&(c=4294967295+c+1);a.TYPED_ARRAY_SUPPORT?(this[d]=c>>>24,this[d+1]=c>>>16,this[d+2]=c>>>8,this[d+3]=c&255):y(this,c,d,!1);return d+4};a.prototype.writeFloatLE=function(c,a,d){return B(this,c,a,!0,d)};a.prototype.writeFloatBE=function(c,a,d){return B(this,c,a,!1,d)};a.prototype.writeDoubleLE=function(c,a,d){return w(this,c,a,!0,d)};a.prototype.writeDoubleBE=function(c,a,d){return w(this,c,a,!1,d)};a.prototype.copy=function(c,d,
b,e){b||(b=0);e||0===e||(e=this.length);d>=c.length&&(d=c.length);d||(d=0);0<e&&e<b&&(e=b);if(e===b||0===c.length||0===this.length)return 0;if(0>d)throw new RangeError("targetStart out of bounds");if(0>b||b>=this.length)throw new RangeError("sourceStart out of bounds");if(0>e)throw new RangeError("sourceEnd out of bounds");e>this.length&&(e=this.length);c.length-d<e-b&&(e=c.length-d+b);var f=e-b;if(this===c&&b<d&&d<e)for(e=f-1;0<=e;--e)c[e+d]=this[e+b];else if(1E3>f||!a.TYPED_ARRAY_SUPPORT)for(e=
0;e<f;++e)c[e+d]=this[e+b];else Uint8Array.prototype.set.call(c,this.subarray(b,b+f),d);return f};a.prototype.fill=function(c,d,b,e){if("string"===typeof c){"string"===typeof d?(e=d,d=0,b=this.length):"string"===typeof b&&(e=b,b=this.length);if(1===c.length){var f=c.charCodeAt(0);256>f&&(c=f)}if(void 0!==e&&"string"!==typeof e)throw new TypeError("encoding must be a string");if("string"===typeof e&&!a.isEncoding(e))throw new TypeError("Unknown encoding: "+e);}else"number"===typeof c&&(c&=255);if(0>
d||this.length<d||this.length<b)throw new RangeError("Out of range index");if(b<=d)return this;d>>>=0;b=void 0===b?this.length:b>>>0;c||(c=0);if("number"===typeof c)for(e=d;e<b;++e)this[e]=c;else for(c=a.isBuffer(c)?c:N((new a(c,e)).toString()),f=c.length,e=0;e<b-d;++e)this[e+d]=c[e%f];return this};var L=/[^+\/0-9A-Za-z-_]/g}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"base64-js":35,ieee754:84,isarray:90}],63:[function(b,h,
q){function t(a){return[Math.min(a[0],a[1]),Math.max(a[0],a[1])]}function r(a,b){return a[0]-b[0]||a[1]-b[1]}function e(a,b,e){return b in a?a[b]:e}var a=b("./lib/monotone"),n=b("./lib/triangulation"),k=b("./lib/delaunay"),l=b("./lib/filter");h.exports=function(b,h,u){Array.isArray(h)?(u=u||{},h=h||[]):(u=h||{},h=[]);var m=!!e(u,"delaunay",!0),g=!!e(u,"interior",!0),d=!!e(u,"exterior",!0);u=!!e(u,"infinity",!1);if(!g&&!d||0===b.length)return[];var f=a(b,h);if(m||g!==d||u){h=n(b.length,h.map(t).sort(r));
for(var p=0;p<f.length;++p){var x=f[p];h.addTriangle(x[0],x[1],x[2])}m&&k(b,h);return d?g?u?l(h,0,u):h.cells():l(h,1,u):l(h,-1)}return f}},{"./lib/delaunay":64,"./lib/filter":65,"./lib/monotone":66,"./lib/triangulation":67}],64:[function(b,h,q){function t(b,a,n,k,l,t){var h=a.opposite(k,l);if(!(0>h)){if(l<k){var u=k;k=l;l=u;u=t;t=h;h=u}a.isConstraint(k,l)||0>r(b[k],b[l],b[t],b[h])&&n.push(k,l)}}var r=b("robust-in-sphere")[4];b("binary-search-bounds");h.exports=function(b,a){for(var n=[],k=b.length,
l=a.stars,h=0;h<k;++h)for(var v=l[h],u=1;u<v.length;u+=2){var m=v[u];if(!(m<h||a.isConstraint(h,m))){for(var g=v[u-1],d=-1,f=1;f<v.length;f+=2)if(v[f-1]===m){d=v[f];break}0>d||0>r(b[h],b[m],b[g],b[d])&&n.push(h,m)}}for(;0<n.length;){m=n.pop();h=n.pop();d=g=-1;v=l[h];for(k=1;k<v.length;k+=2)u=v[k-1],f=v[k],u===m?d=f:f===m&&(g=u);0>g||0>d||0<=r(b[h],b[m],b[g],b[d])||(a.flip(h,m),t(b,a,n,g,h,d),t(b,a,n,h,d,g),t(b,a,n,d,m,g),t(b,a,n,m,g,d))}}},{"binary-search-bounds":53,"robust-in-sphere":105}],65:[function(b,
h,q){function t(a,b,e,l,r,h,u){this.cells=a;this.neighbor=b;this.flags=l;this.constraint=e;this.active=r;this.next=h;this.boundary=u}function r(a,b){return a[0]-b[0]||a[1]-b[1]||a[2]-b[2]}var e=b("binary-search-bounds");h.exports=function(a,b,e){for(var l=a.cells(),h=l.length,v=0;v<h;++v){var u=l[v],m=u[0],g=u[1],d=u[2];g<d?g<m&&(u[0]=g,u[1]=d,u[2]=m):d<m&&(u[0]=d,u[1]=m,u[2]=g)}l.sort(r);for(var f=Array(h),v=0;v<f.length;++v)f[v]=0;var p=[],x=[],z=Array(3*h),q=Array(3*h),c=null;e&&(c=[]);d=new t(l,
z,q,f,p,x,c);for(v=0;v<h;++v)for(var u=l[v],y=0;3>y;++y){var m=u[y],g=u[(y+1)%3],D=z[3*v+y]=d.locate(g,m,a.opposite(g,m)),B=q[3*v+y]=a.isConstraint(m,g);0>D&&(B?x.push(v):(p.push(v),f[v]=1),e&&c.push([g,m,-1]))}if(0===b)return e?d.cells.concat(d.boundary):d.cells;h=1;v=d.active;u=d.next;a=d.flags;l=d.cells;m=d.constraint;for(g=d.neighbor;0<v.length||0<u.length;){for(;0<v.length;)if(f=v.pop(),a[f]!==-h)for(a[f]=h,p=0;3>p;++p)x=g[3*f+p],0<=x&&0===a[x]&&(m[3*f+p]?u.push(x):(v.push(x),a[x]=h));f=u;u=
v;v=f;u.length=0;h=-h}for(v=h=0;v<l.length;++v)a[v]===b&&(l[h++]=l[v]);l.length=h;return e?l.concat(d.boundary):l};t.prototype.locate=function(){var a=[0,0,0];return function(b,k,l){var h=b,t=k,u=l;k<l?k<b&&(h=k,t=l,u=b):l<b&&(h=l,t=b,u=k);if(0>h)return-1;a[0]=h;a[1]=t;a[2]=u;return e.eq(this.cells,a,r)}}()},{"binary-search-bounds":53}],66:[function(b,h,q){function t(a,b,e,k,g){this.a=a;this.b=b;this.idx=e;this.lowerIds=k;this.upperIds=g}function r(a,b,e,k){this.a=a;this.b=b;this.type=e;this.idx=
k}function e(a,b){var e=a.a[0]-b.a[0]||a.a[1]-b.a[1]||a.type-b.type;return e||0!==a.type&&(e=l(a.a,a.b,b.b))?e:a.idx-b.idx}function a(a,b){return l(a.a,a.b,b)}function n(a,b){var e;return(e=a.a[0]<b.a[0]?l(a.a,a.b,b.a):l(b.b,b.a,a.a))?e:(e=b.b[0]<a.b[0]?l(a.a,a.b,b.b):l(b.b,b.a,a.b))||a.idx-b.idx}var k=b("binary-search-bounds"),l=b("robust-orientation")[3];h.exports=function(b,h){for(var u=b.length,m=h.length,g=[],d=0;d<u;++d)g.push(new r(b[d],null,0,d));for(d=0;d<m;++d){var f=h[d],u=b[f[0]],f=b[f[1]];
u[0]<f[0]?g.push(new r(u,f,2,d),new r(f,u,1,d)):u[0]>f[0]&&g.push(new r(f,u,2,d),new r(u,f,1,d))}g.sort(e);d=g[0].a[0]-(1+Math.abs(g[0].a[0]))*Math.pow(2,-52);m=[new t([d,1],[d,0],-1,[],[],[],[])];u=[];d=0;for(f=g.length;d<f;++d){var p=g[d],x=p.type;if(0===x)for(var x=u,z=m,q=b,c=p.a,p=p.idx,y=k.lt(z,c,a),D=k.gt(z,c,a);y<D;++y){for(var B=z[y],w=B.lowerIds,E=w.length;1<E&&0<l(q[w[E-2]],q[w[E-1]],c);)x.push([w[E-1],w[E-2],p]),--E;w.length=E;w.push(p);B=B.upperIds;for(E=B.length;1<E&&0>l(q[B[E-2]],q[B[E-
1]],c);)x.push([B[E-2],B[E-1],p]),--E;B.length=E;B.push(p)}else 2===x?(x=m,z=p,q=k.le(x,z,n),c=x[q],p=c.upperIds,D=p[p.length-1],c.upperIds=[D],x.splice(q+1,0,new t(z.a,z.b,z.idx,[D],p))):(x=m,z=p,q=z.a,z.a=z.b,z.b=q,z=k.eq(x,z,n),x[z-1].upperIds=x[z].upperIds,x.splice(z,1))}return u}},{"binary-search-bounds":53,"robust-orientation":106}],67:[function(b,h,q){function t(a,b){this.stars=a;this.edges=b}function r(a,b,e){for(var l=1,r=a.length;l<r;l+=2)if(a[l-1]===b&&a[l]===e){a[l-1]=a[r-2];a[l]=a[r-
1];a.length=r-2;break}}var e=b("binary-search-bounds");h.exports=function(a,b){for(var e=Array(a),l=0;l<a;++l)e[l]=[];return new t(e,b)};b=t.prototype;b.isConstraint=function(){function a(a,b){return a[0]-b[0]||a[1]-b[1]}var b=[0,0];return function(k,l){b[0]=Math.min(k,l);b[1]=Math.max(k,l);return 0<=e.eq(this.edges,b,a)}}();b.removeTriangle=function(a,b,e){var l=this.stars;r(l[a],b,e);r(l[b],e,a);r(l[e],a,b)};b.addTriangle=function(a,b,e){var l=this.stars;l[a].push(b,e);l[b].push(e,a);l[e].push(a,
b)};b.opposite=function(a,b){for(var e=this.stars[b],l=1,r=e.length;l<r;l+=2)if(e[l]===a)return e[l-1];return-1};b.flip=function(a,b){var e=this.opposite(a,b),l=this.opposite(b,a);this.removeTriangle(a,b,e);this.removeTriangle(b,a,l);this.addTriangle(a,l,e);this.addTriangle(b,e,l)};b.edges=function(){for(var a=this.stars,b=[],e=0,l=a.length;e<l;++e)for(var r=a[e],h=0,u=r.length;h<u;h+=2)b.push([r[h],r[h+1]]);return b};b.cells=function(){for(var a=this.stars,b=[],e=0,l=a.length;e<l;++e)for(var r=a[e],
h=0,u=r.length;h<u;h+=2){var m=r[h],g=r[h+1];e<Math.min(m,g)&&b.push([e,m,g])}return b}},{"binary-search-bounds":53}],68:[function(b,h,q){function t(a){var c=f(a);a=d(g(c),a);return 0>a?[c,x(c,Infinity)]:0<a?[x(c,-Infinity),c]:[c,c]}function r(a,c,d){var b=[];u(d,function(d,e){var f=c[d],g=c[e];f[0]!==g[0]&&f[0]!==g[1]&&f[1]!==g[0]&&f[1]!==g[1]&&m(a[f[0]],a[f[1]],a[g[0]],a[g[1]])&&b.push([d,e])});return b}function e(a,c,d,b){var e=[];u(d,b,function(d,b){var f=c[d];if(f[0]!==b&&f[1]!==b){var g=a[b];
m(a[f[0]],a[f[1]],g,g)&&e.push([d,b])}});return e}function a(a,c,b,e,f){function k(c){if(c>=a.length)return l[c-a.length];c=a[c];return[g(c[0]),g(c[1])]}for(var l=[],m=0;m<b.length;++m){var n=b[m],r=n[0],n=n[1],u=c[r],x=c[n];if(u=z(p(a[u[0]]),p(a[u[1]]),p(a[x[0]]),p(a[x[1]])))x=l.length+a.length,l.push(u),e.push([r,x],[n,x])}e.sort(function(c,a){if(c[0]!==a[0])return c[0]-a[0];var b=k(c[1]),e=k(a[1]);return d(b[0],e[0])||d(b[1],e[1])});for(m=e.length-1;0<=m;--m){n=e[m];r=n[0];u=c[r];x=u[0];b=u[1];
var h=a[x],t=a[b];0>(h[0]-t[0]||h[1]-t[1])&&(h=x,x=b,b=h);u[0]=x;var x=u[1]=n[1],v;for(f&&(v=u[2]);0<m&&e[m-1][0]===r;)n=e[--m],n=n[1],f?c.push([x,n,v]):c.push([x,n]),x=n;f?c.push([x,b,v]):c.push([x,b])}return l}function n(a,c,d){for(var b=a.length+c.length,e=new v(b),g=0;g<c.length;++g){var p=c[g],k=t(p[0]),l=t(p[1]);d.push([k[0],l[0],k[1],l[1]]);a.push([f(p[0]),f(p[1])])}u(d,function(c,a){e.link(c,a)});c=0;d=!0;p=Array(b);for(g=0;g<b;++g)e.find(g)===g?(p[g]=c,a[c++]=a[g]):(d=!1,p[g]=-1);a.length=
c;if(d)return null;for(g=0;g<b;++g)0>p[g]&&(p[g]=p[e.find(g)]);return p}function k(a,c){return a[0]-c[0]||a[1]-c[1]}function l(a,c){var d=a[0]-c[0]||a[1]-c[1];return d?d:a[2]<c[2]?-1:a[2]>c[2]?1:0}function A(d,c,b){for(var f=Array(c.length),g=0;g<c.length;++g){var p=c[g],m=d[p[0]],p=d[p[1]];f[g]=[Math.min(m[0],p[0]),Math.min(m[1],p[1]),Math.max(m[0],p[0]),Math.max(m[1],p[1])]}g=r(d,c,f);m=Array(d.length);for(p=0;p<d.length;++p){var u=d[p];m[p]=[u[0],u[1],u[0],u[1]]}f=e(d,c,f,m);p=a(d,c,g,f,b);d=n(d,
p,m);if(0!==c.length){if(d)for(m=0;m<c.length;++m){var p=c[m],u=d[p[0]],x=d[p[1]];p[0]=Math.min(u,x);p[1]=Math.max(u,x)}else for(m=0;m<c.length;++m)p=c[m],u=p[0],x=p[1],p[0]=Math.min(u,x),p[1]=Math.max(u,x);b?c.sort(l):c.sort(k);for(m=p=1;m<c.length;++m)if(u=c[m-1],x=c[m],x[0]!==u[0]||x[1]!==u[1]||b&&x[2]!==u[2])c[p++]=x;c.length=p}return d?!0:0<g.length||0<f.length}h.exports=function(a,c,d){var b=!1,e;if(d){e=c;for(var f=Array(c.length),g=0;g<c.length;++g){var p=c[g];f[g]=[p[0],p[1],d[g]]}c=f}for(;A(a,
c,!!d);)b=!0;if(d&&b)for(e.length=0,g=d.length=0;g<c.length;++g)p=c[g],e.push([p[0],p[1]]),d.push(p[2]);return b};var v=b("union-find"),u=b("box-intersect");b("compare-cell");var m=b("robust-segment-intersect"),g=b("big-rat"),d=b("big-rat/cmp"),f=b("big-rat/to-float"),p=b("rat-vec"),x=b("nextafter"),z=b("./lib/rat-seg-intersect")},{"./lib/rat-seg-intersect":69,"big-rat":39,"big-rat/cmp":37,"big-rat/to-float":52,"box-intersect":55,"compare-cell":72,nextafter:93,"rat-vec":102,"robust-segment-intersect":109,
"union-find":124}],69:[function(b,h,q){function t(b,e){return a(r(b[0],e[1]),r(b[1],e[0]))}h.exports=function(a,b,m,g){b=k(b,a);var d=k(g,m);g=t(b,d);if(0===n(g))return null;m=k(a,m);m=t(d,m);m=e(m,g);return l(a,A(b,m))};var r=b("big-rat/mul"),e=b("big-rat/div"),a=b("big-rat/sub"),n=b("big-rat/sign"),k=b("rat-vec/sub"),l=b("rat-vec/add"),A=b("rat-vec/muls");b("big-rat/to-float")},{"big-rat/div":38,"big-rat/mul":48,"big-rat/sign":50,"big-rat/sub":51,"big-rat/to-float":52,"rat-vec/add":101,"rat-vec/muls":103,
"rat-vec/sub":104}],70:[function(b,h,q){function t(b,e,r){var u=a(b[0],-e[0]);b=a(b[1],-e[1]);var m=a(r[0],-e[0]);e=a(r[1],-e[1]);u=k(n(u,m),n(b,e));return 0<=u[u.length-1]}h.exports=function(a,b,k,n){var m=r(b,k,n);if(0===m){var m=e(r(a,b,k)),g=e(r(a,b,n));return m===g?0===m&&(k=t(a,b,k),a=t(a,b,n),k!==a)?k?1:-1:0:0===g?0<m?-1:t(a,b,n)?-1:1:0===m?0<g?1:t(a,b,k)?1:-1:e(g-m)}g=r(a,b,k);return 0<g?0<m&&0<r(a,b,n)?1:-1:0>g?0<m||0<r(a,b,n)?1:-1:0<r(a,b,n)?1:t(a,b,k)?1:-1};var r=b("robust-orientation"),
e=b("signum"),a=b("two-sum"),n=b("robust-product"),k=b("robust-sum")},{"robust-orientation":106,"robust-product":107,"robust-sum":111,signum:71,"two-sum":122}],71:[function(b,h,q){h.exports=function(b){return 0>b?-1:0<b?1:0}},{}],72:[function(b,h,q){function t(b,a){return b-a}h.exports=function(b,a){var n=b.length,k=b.length-a.length;if(k)return k;switch(n){case 0:return 0;case 1:return b[0]-a[0];case 2:return b[0]+b[1]-a[0]-a[1]||r(b[0],b[1])-r(a[0],a[1]);case 3:var n=b[0]+b[1],l=a[0]+a[1];if(k=
n+b[2]-(l+a[2]))return k;var k=r(b[0],b[1]),h=r(a[0],a[1]);return r(k,b[2])-r(h,a[2])||r(k+b[2],n)-r(h+a[2],l);case 4:var k=b[0],n=b[1],l=b[2],h=b[3],v=a[0],u=a[1],m=a[2],g=a[3];return k+n+l+h-(v+u+m+g)||r(k,n,l,h)-r(v,u,m,g,v)||r(k+n,k+l,k+h,n+l,n+h,l+h)-r(v+u,v+m,v+g,u+m,u+g,m+g)||r(k+n+l,k+n+h,k+l+h,n+l+h)-r(v+u+m,v+u+g,v+m+g,u+m+g);default:l=b.slice().sort(t);h=a.slice().sort(t);for(v=0;v<n;++v)if(k=l[v]-h[v])return k;return 0}};var r=Math.min},{}],73:[function(b,h,q){function t(){this.argTypes=
[];this.shimArgs=[];this.arrayArgs=[];this.arrayBlockIndices=[];this.scalarArgs=[];this.offsetArgs=[];this.offsetArgIndex=[];this.indexArgs=[];this.shapeArgs=[];this.funcName="";this.post=this.body=this.pre=null;this.debug=!1}var r=b("./lib/thunk.js");h.exports=function(b){var a=new t;a.pre=b.pre;a.body=b.body;a.post=b.post;var n=b.args.slice(0);a.argTypes=n;for(var k=0;k<n.length;++k){var l=n[k];if("array"===l||"object"===typeof l&&l.blockIndices){a.argTypes[k]="array";a.arrayArgs.push(k);a.arrayBlockIndices.push(l.blockIndices?
l.blockIndices:0);a.shimArgs.push("array"+k);if(k<a.pre.args.length&&0<a.pre.args[k].count)throw Error("cwise: pre() block may not reference array args");if(k<a.post.args.length&&0<a.post.args[k].count)throw Error("cwise: post() block may not reference array args");}else if("scalar"===l)a.scalarArgs.push(k),a.shimArgs.push("scalar"+k);else if("index"===l){a.indexArgs.push(k);if(k<a.pre.args.length&&0<a.pre.args[k].count)throw Error("cwise: pre() block may not reference array index");if(k<a.body.args.length&&
a.body.args[k].lvalue)throw Error("cwise: body() block may not write to array index");if(k<a.post.args.length&&0<a.post.args[k].count)throw Error("cwise: post() block may not reference array index");}else if("shape"===l){a.shapeArgs.push(k);if(k<a.pre.args.length&&a.pre.args[k].lvalue)throw Error("cwise: pre() block may not write to array shape");if(k<a.body.args.length&&a.body.args[k].lvalue)throw Error("cwise: body() block may not write to array shape");if(k<a.post.args.length&&a.post.args[k].lvalue)throw Error("cwise: post() block may not write to array shape");
}else if("object"===typeof l&&l.offset)a.argTypes[k]="offset",a.offsetArgs.push({array:l.array,offset:l.offset}),a.offsetArgIndex.push(k);else throw Error("cwise: Unknown argument type "+n[k]);}if(0>=a.arrayArgs.length)throw Error("cwise: No array arguments specified");if(a.pre.args.length>n.length)throw Error("cwise: Too many arguments in pre() block");if(a.body.args.length>n.length)throw Error("cwise: Too many arguments in body() block");if(a.post.args.length>n.length)throw Error("cwise: Too many arguments in post() block");
a.debug=!!b.printCode||!!b.debug;a.funcName=b.funcName||"cwise";a.blockSize=b.blockSize||64;return r(a)}},{"./lib/thunk.js":75}],74:[function(b,h,q){function t(a,b,e){var n=a.length,r=b.arrayArgs.length;b=0<b.indexArgs.length;var m=[],g=[],d=0,f=0,p,x;for(p=0;p<n;++p)g.push(["i",p,"=0"].join(""));for(x=0;x<r;++x)for(p=0;p<n;++p)f=d,d=a[p],0===p?g.push(["d",x,"s",p,"=t",x,"p",d].join("")):g.push(["d",x,"s",p,"=(t",x,"p",d,"-s",f,"*t",x,"p",f,")"].join(""));m.push("var "+g.join(","));for(p=n-1;0<=p;--p)d=
a[p],m.push(["for(i",p,"=0;i",p,"<s",d,";++i",p,"){"].join(""));m.push(e);for(p=0;p<n;++p){f=d;d=a[p];for(x=0;x<r;++x)m.push(["p",x,"+=d",x,"s",p].join(""));b&&(0<p&&m.push(["index[",f,"]-=s",f].join("")),m.push(["++index[",d,"]"].join("")));m.push("}")}return m.join("\n")}function r(a,b,e,n){for(var r=b.length,m=e.arrayArgs.length,g=e.blockSize,d=0<e.indexArgs.length,f=[],p=0;p<m;++p)f.push(["var offset",p,"=p",p].join(""));for(p=a;p<r;++p)f.push(["for(var j"+p+"=SS[",b[p],"]|0;j",p,">0;){"].join("")),
f.push(["if(j",p,"<",g,"){"].join("")),f.push(["s",b[p],"=j",p].join("")),f.push(["j",p,"=0"].join("")),f.push(["}else{s",b[p],"=",g].join("")),f.push(["j",p,"-=",g,"}"].join("")),d&&f.push(["index[",b[p],"]=j",p].join(""));for(p=0;p<m;++p){g=["offset"+p];for(d=a;d<r;++d)g.push(["j",d,"*t",p,"p",b[d]].join(""));f.push(["p",p,"=(",g.join("+"),")"].join(""))}f.push(t(b,e,n));for(p=a;p<r;++p)f.push("}");return f.join("\n")}function e(a,b,e){for(var n=a.body,r=[],m=[],g=0;g<a.args.length;++g){var d=a.args[g];
if(!(0>=d.count)){var f=new RegExp(d.name,"g"),p="",x=b.arrayArgs.indexOf(g);switch(b.argTypes[g]){case "offset":var h=b.offsetArgIndex.indexOf(g),x=b.offsetArgs[h].array,p="+q"+h;case "array":var p="p"+x+p,t="l"+g,h="a"+x;if(0===b.arrayBlockIndices[x])1===d.count?"generic"===e[x]?d.lvalue?(r.push(["var ",t,"=",h,".get(",p,")"].join("")),n=n.replace(f,t),m.push([h,".set(",p,",",t,")"].join(""))):n=n.replace(f,[h,".get(",p,")"].join("")):n=n.replace(f,[h,"[",p,"]"].join("")):"generic"===e[x]?(r.push(["var ",
t,"=",h,".get(",p,")"].join("")),n=n.replace(f,t),d.lvalue&&m.push([h,".set(",p,",",t,")"].join(""))):(r.push(["var ",t,"=",h,"[",p,"]"].join("")),n=n.replace(f,t),d.lvalue&&m.push([h,"[",p,"]=",t].join("")));else{f=[d.name];d=[p];for(p=0;p<Math.abs(b.arrayBlockIndices[x]);p++)f.push("\\s*\\[([^\\]]+)\\]"),d.push("$"+(p+1)+"*t"+x+"b"+p);f=new RegExp(f.join(""),"g");p=d.join("+");if("generic"===e[x])throw Error("cwise: Generic arrays not supported in combination with blocks!");n=n.replace(f,[h,"[",
p,"]"].join(""))}break;case "scalar":n=n.replace(f,"Y"+b.scalarArgs.indexOf(g));break;case "index":n=n.replace(f,"index");break;case "shape":n=n.replace(f,"shape")}}}return[r.join("\n"),n,m.join("\n")].join("\n").trim()}function a(a){for(var b=Array(a.length),e=!0,n=0;n<a.length;++n){var r=a[n],m=r.match(/\d+/),m=m?m[0]:"";0===r.charAt(0)?b[n]="u"+r.charAt(1)+m:b[n]=r.charAt(0)+m;0<n&&(e=e&&b[n]===b[n-1])}return e?b[0]:b.join("")}var n=b("uniq");h.exports=function(b,l){for(var h=l[1].length-Math.abs(b.arrayBlockIndices[0])|
0,q=Array(b.arrayArgs.length),u=Array(b.arrayArgs.length),m=0;m<b.arrayArgs.length;++m)u[m]=l[2*m],q[m]=l[2*m+1];for(var g=[],d=[],f=[],p=[],x=[],m=0;m<b.arrayArgs.length;++m){0>b.arrayBlockIndices[m]?(f.push(0),p.push(h),g.push(h),d.push(h+b.arrayBlockIndices[m])):(f.push(b.arrayBlockIndices[m]),p.push(b.arrayBlockIndices[m]+h),g.push(0),d.push(b.arrayBlockIndices[m]));for(var z=[],C=0;C<q[m].length;C++)f[m]<=q[m][C]&&q[m][C]<p[m]&&z.push(q[m][C]-f[m]);x.push(z)}d=["SS"];p=["'use strict'"];z=[];
for(C=0;C<h;++C)z.push(["s",C,"=SS[",C,"]"].join(""));for(m=0;m<b.arrayArgs.length;++m){d.push("a"+m);d.push("t"+m);d.push("p"+m);for(C=0;C<h;++C)z.push(["t",m,"p",C,"=t",m,"[",f[m]+C,"]"].join(""));for(C=0;C<Math.abs(b.arrayBlockIndices[m]);++C)z.push(["t",m,"b",C,"=t",m,"[",g[m]+C,"]"].join(""))}for(m=0;m<b.scalarArgs.length;++m)d.push("Y"+m);0<b.shapeArgs.length&&z.push("shape=SS.slice(0)");if(0<b.indexArgs.length){C=Array(h);for(m=0;m<h;++m)C[m]="0";z.push(["index=[",C.join(","),"]"].join(""))}for(m=
0;m<b.offsetArgs.length;++m){g=b.offsetArgs[m];f=[];for(C=0;C<g.offset.length;++C)0!==g.offset[C]&&(1===g.offset[C]?f.push(["t",g.array,"p",C].join("")):f.push([g.offset[C],"*t",g.array,"p",C].join("")));0===f.length?z.push("q"+m+"=0"):z.push(["q",m,"=",f.join("+")].join(""))}m=n([].concat(b.pre.thisVars).concat(b.body.thisVars).concat(b.post.thisVars));z=z.concat(m);p.push("var "+z.join(","));for(m=0;m<b.arrayArgs.length;++m)p.push("p"+m+"|=0");3<b.pre.body.length&&p.push(e(b.pre,b,u));m=e(b.body,
b,u);a:for(C=0,z=x[0].length;C<z;){for(g=1;g<x.length;++g)if(x[g][C]!==x[0][C])break a;++C}C<h?p.push(r(C,x[0],b,m)):p.push(t(x[0],b,m));3<b.post.body.length&&p.push(e(b.post,b,u));b.debug&&console.log("-----Generated cwise routine for ",l,":\n"+p.join("\n")+"\n----------");h=[b.funcName||"unnamed","_cwise_loop_",q[0].join("s"),"m",C,a(u)].join("");return(new Function(["function ",h,"(",d.join(","),"){",p.join("\n"),"} return ",h].join("")))()}},{uniq:125}],75:[function(b,h,q){var t=b("./compile.js");
h.exports=function(b){var e=["'use strict'","var CACHED={}"],a=[];e.push(["return function ",b.funcName+"_cwise_thunk","(",b.shimArgs.join(","),"){"].join(""));for(var n=[],k=[],l=[["array",b.arrayArgs[0],".shape.slice(",Math.max(0,b.arrayBlockIndices[0]),0>b.arrayBlockIndices[0]?","+b.arrayBlockIndices[0]+")":")"].join("")],h=[],q=[],u=0;u<b.arrayArgs.length;++u){var m=b.arrayArgs[u];a.push(["t",m,"=array",m,".dtype,r",m,"=array",m,".order"].join(""));n.push("t"+m);n.push("r"+m);k.push("t"+m);k.push("r"+
m+".join()");l.push("array"+m+".data");l.push("array"+m+".stride");l.push("array"+m+".offset|0");0<u&&(h.push("array"+b.arrayArgs[0]+".shape.length===array"+m+".shape.length+"+(Math.abs(b.arrayBlockIndices[0])-Math.abs(b.arrayBlockIndices[u]))),q.push("array"+b.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,b.arrayBlockIndices[0])+"]===array"+m+".shape[shapeIndex+"+Math.max(0,b.arrayBlockIndices[u])+"]"))}1<b.arrayArgs.length&&(e.push("if (!("+h.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),
e.push("for(var shapeIndex=array"+b.arrayArgs[0]+".shape.length-"+Math.abs(b.arrayBlockIndices[0])+"; shapeIndex--\x3e0;) {"),e.push("if (!("+q.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),e.push("}"));for(u=0;u<b.scalarArgs.length;++u)l.push("scalar"+b.scalarArgs[u]);a.push(["type=[",k.join(","),"].join()"].join(""));a.push("proc=CACHED[type]");e.push("var "+a.join(","));e.push(["if(!proc){CACHED[type]=proc=compile([",n.join(","),"])}return proc(",l.join(","),
")}"].join(""));b.debug&&console.log("-----Generated thunk:\n"+e.join("\n")+"\n----------");return(new Function("compile",e.join("\n")))(t.bind(void 0,b))}},{"./compile.js":74}],76:[function(b,h,q){(function(b){var r=!1;if("undefined"!==typeof Float64Array){var e=new Float64Array(1),a=new Uint32Array(e.buffer);e[0]=1;r=!0;1072693248===a[1]?(h.exports=function(b){e[0]=b;return[a[0],a[1]]},h.exports.pack=function(b,n){a[0]=b;a[1]=n;return e[0]},h.exports.lo=function(b){e[0]=b;return a[0]},h.exports.hi=
function(b){e[0]=b;return a[1]}):1072693248===a[0]?(h.exports=function(b){e[0]=b;return[a[1],a[0]]},h.exports.pack=function(b,n){a[1]=b;a[0]=n;return e[0]},h.exports.lo=function(b){e[0]=b;return a[1]},h.exports.hi=function(b){e[0]=b;return a[0]}):r=!1}if(!r){var n=new b(8);h.exports=function(a){n.writeDoubleLE(a,0,!0);return[n.readUInt32LE(0,!0),n.readUInt32LE(4,!0)]};h.exports.pack=function(a,b){n.writeUInt32LE(a,0,!0);n.writeUInt32LE(b,4,!0);return n.readDoubleLE(0,!0)};h.exports.lo=function(a){n.writeDoubleLE(a,
0,!0);return n.readUInt32LE(0,!0)};h.exports.hi=function(a){n.writeDoubleLE(a,0,!0);return n.readUInt32LE(4,!0)}}h.exports.sign=function(a){return h.exports.hi(a)>>>31};h.exports.exponent=function(a){return(h.exports.hi(a)<<1>>>21)-1023};h.exports.fraction=function(a){var b=h.exports.lo(a);a=h.exports.hi(a);var e=a&1048575;a&2146435072&&(e+=1048576);return[b,e]};h.exports.denormalized=function(a){return!(h.exports.hi(a)&2146435072)}}).call(this,b("buffer").Buffer)},{buffer:62}],77:[function(b,h,q){function t(b,
e,a){var n=b[a]|0;if(0>=n)return[];var k=Array(n),l;if(a===b.length-1)for(l=0;l<n;++l)k[l]=e;else for(l=0;l<n;++l)k[l]=t(b,e,a+1);return k}h.exports=function(b,e){"undefined"===typeof e&&(e=0);switch(typeof b){case "number":if(0<b){var a=b|0,n=e,k,l;k=Array(a);for(l=0;l<a;++l)k[l]=n;return k}break;case "object":if("number"===typeof b.length)return t(b,e,0)}return[]}},{}],78:[function(b,h,q){h.exports=function(b,e){var a=b.length;if("number"!==typeof e){for(var n=e=0;n<a;++n){var k=b[n];e=Math.max(e,
k[0],k[1])}e=(e|0)+1}e|=0;for(var l=Array(e),n=0;n<e;++n)l[n]=[];for(n=0;n<a;++n)k=b[n],l[k[0]].push(k[1]),l[k[1]].push(k[0]);for(a=0;a<e;++a)t(l[a],function(a,b){return a-b});return l};var t=b("uniq")},{uniq:125}],79:[function(b,h,q){function t(a,d,b,e,m,n){this._color=a;this.key=d;this.value=b;this.left=e;this.right=m;this._count=n}function r(a){return new t(a._color,a.key,a.value,a.left,a.right,a._count)}function e(a,d){return new t(a,d.key,d.value,d.left,d.right,d._count)}function a(a){a._count=
1+(a.left?a.left._count:0)+(a.right?a.right._count:0)}function n(a,d){this._compare=a;this.root=d}function k(a,d){if(d.left){var b=k(a,d.left);if(b)return b}if(b=a(d.key,d.value))return b;if(d.right)return k(a,d.right)}function l(a,d,b,e){if(0>=d(a,e.key)){if(e.left){var m=l(a,d,b,e.left);if(m)return m}if(m=b(e.key,e.value))return m}if(e.right)return l(a,d,b,e.right)}function A(a,d,b,e,m){var n=b(a,m.key),k=b(d,m.key);if(0>=n&&(m.left&&(n=A(a,d,b,e,m.left))||0<k&&(n=e(m.key,m.value))))return n;if(0<
k&&m.right)return A(a,d,b,e,m.right)}function v(a,d){this.tree=a;this._stack=d}function u(a,d){a.key=d.key;a.value=d.value;a.left=d.left;a.right=d.right;a._color=d._color;a._count=d._count}function m(a,d){return a<d?-1:a>d?1:0}h.exports=function(a){return new n(a||m,null)};b=n.prototype;Object.defineProperty(b,"keys",{get:function(){var a=[];this.forEach(function(d,b){a.push(d)});return a}});Object.defineProperty(b,"values",{get:function(){var a=[];this.forEach(function(d,b){a.push(b)});return a}});
Object.defineProperty(b,"length",{get:function(){return this.root?this.root._count:0}});b.insert=function(b,d){for(var f=this._compare,p=this.root,m=[],k=[];p;){var l=f(b,p.key);m.push(p);k.push(l);p=0>=l?p.left:p.right}m.push(new t(0,b,d,null,null,1));for(l=m.length-2;0<=l;--l)p=m[l],m[l]=0>=k[l]?new t(p._color,p.key,p.value,m[l+1],p.right,p._count+1):new t(p._color,p.key,p.value,p.left,m[l+1],p._count+1);for(l=m.length-1;1<l;--l){k=m[l-1];p=m[l];if(1===k._color||1===p._color)break;var c=m[l-2];
if(c.left===k)if(k.left===p){var r=c.right;if(r&&0===r._color)k._color=1,c.right=e(1,r),c._color=0,--l;else{c._color=0;c.left=k.right;k._color=1;k.right=c;m[l-2]=k;m[l-1]=p;a(c);a(k);3<=l&&(l=m[l-3],l.left===c?l.left=k:l.right=k);break}}else if((r=c.right)&&0===r._color)k._color=1,c.right=e(1,r),c._color=0,--l;else{k.right=p.left;c._color=0;c.left=p.right;p._color=1;p.left=k;p.right=c;m[l-2]=p;m[l-1]=k;a(c);a(k);a(p);3<=l&&(l=m[l-3],l.left===c?l.left=p:l.right=p);break}else if(k.right===p)if((r=c.left)&&
0===r._color)k._color=1,c.left=e(1,r),c._color=0,--l;else{c._color=0;c.right=k.left;k._color=1;k.left=c;m[l-2]=k;m[l-1]=p;a(c);a(k);3<=l&&(l=m[l-3],l.right===c?l.right=k:l.left=k);break}else if((r=c.left)&&0===r._color)k._color=1,c.left=e(1,r),c._color=0,--l;else{k.left=p.right;c._color=0;c.right=p.left;p._color=1;p.right=k;p.left=c;m[l-2]=p;m[l-1]=k;a(c);a(k);a(p);3<=l&&(l=m[l-3],l.right===c?l.right=p:l.left=p);break}}m[0]._color=1;return new n(f,m[0])};b.forEach=function(a,d,b){if(this.root)switch(arguments.length){case 1:return k(a,
this.root);case 2:return l(d,this._compare,a,this.root);case 3:if(!(0<=this._compare(d,b)))return A(d,b,this._compare,a,this.root)}};Object.defineProperty(b,"begin",{get:function(){for(var a=[],d=this.root;d;)a.push(d),d=d.left;return new v(this,a)}});Object.defineProperty(b,"end",{get:function(){for(var a=[],d=this.root;d;)a.push(d),d=d.right;return new v(this,a)}});b.at=function(a){if(0>a)return new v(this,[]);for(var d=this.root,b=[];;){b.push(d);if(d.left){if(a<d.left._count){d=d.left;continue}a-=
d.left._count}if(!a)return new v(this,b);--a;if(d.right){if(a>=d.right._count)break;d=d.right}else break}return new v(this,[])};b.ge=function(a){for(var b=this._compare,e=this.root,p=[],m=0;e;){var k=b(a,e.key);p.push(e);0>=k&&(m=p.length);e=0>=k?e.left:e.right}p.length=m;return new v(this,p)};b.gt=function(a){for(var b=this._compare,e=this.root,p=[],m=0;e;){var k=b(a,e.key);p.push(e);0>k&&(m=p.length);e=0>k?e.left:e.right}p.length=m;return new v(this,p)};b.lt=function(a){for(var b=this._compare,
e=this.root,p=[],m=0;e;){var k=b(a,e.key);p.push(e);0<k&&(m=p.length);e=0>=k?e.left:e.right}p.length=m;return new v(this,p)};b.le=function(a){for(var b=this._compare,e=this.root,p=[],m=0;e;){var k=b(a,e.key);p.push(e);0<=k&&(m=p.length);e=0>k?e.left:e.right}p.length=m;return new v(this,p)};b.find=function(a){for(var b=this._compare,e=this.root,p=[];e;){var m=b(a,e.key);p.push(e);if(0===m)return new v(this,p);e=0>=m?e.left:e.right}return new v(this,[])};b.remove=function(a){return(a=this.find(a))?
a.remove():this};b.get=function(a){for(var b=this._compare,e=this.root;e;){var p=b(a,e.key);if(0===p)return e.value;e=0>=p?e.left:e.right}};b=v.prototype;Object.defineProperty(b,"valid",{get:function(){return 0<this._stack.length}});Object.defineProperty(b,"node",{get:function(){return 0<this._stack.length?this._stack[this._stack.length-1]:null},enumerable:!0});b.clone=function(){return new v(this.tree,this._stack.slice())};b.remove=function(){var b=this._stack;if(0===b.length)return this.tree;var d=
Array(b.length),f=b[b.length-1];d[d.length-1]=new t(f._color,f.key,f.value,f.left,f.right,f._count);for(var p=b.length-2;0<=p;--p)f=b[p],d[p]=f.left===b[p+1]?new t(f._color,f.key,f.value,d[p+1],f.right,f._count):new t(f._color,f.key,f.value,f.left,d[p+1],f._count);f=d[d.length-1];if(f.left&&f.right){b=d.length;for(f=f.left;f.right;)d.push(f),f=f.right;p=d[b-1];d.push(new t(f._color,p.key,p.value,f.left,f.right,f._count));d[b-1].key=f.key;d[b-1].value=f.value;for(p=d.length-2;p>=b;--p)f=d[p],d[p]=
new t(f._color,f.key,f.value,f.left,d[p+1],f._count);d[b-1].left=d[b]}f=d[d.length-1];if(0===f._color)for(p=d[d.length-2],p.left===f?p.left=null:p.right===f&&(p.right=null),d.pop(),p=0;p<d.length;++p)d[p]._count--;else if(f.left||f.right)for(f.left?u(f,f.left):f.right&&u(f,f.right),f._color=1,p=0;p<d.length-1;++p)d[p]._count--;else{if(1===d.length)return new n(this.tree._compare,null);for(p=0;p<d.length;++p)d[p]._count--;for(var p=d[d.length-2],m,k,l,c=d.length-1;0<=c;--c){b=d[c];if(0===c){b._color=
1;break}m=d[c-1];if(m.left===b){k=m.right;if(k.right&&0===k.right._color){k=m.right=r(k);l=k.right=r(k.right);m.right=k.left;k.left=m;k.right=l;k._color=m._color;b._color=1;m._color=1;l._color=1;a(m);a(k);if(1<c){var h=d[c-2];h.left===m?h.left=k:h.right=k}d[c-1]=k;break}else if(k.left&&0===k.left._color){k=m.right=r(k);l=k.left=r(k.left);m.right=l.left;k.left=l.right;l.left=m;l.right=k;l._color=m._color;m._color=1;k._color=1;b._color=1;a(m);a(k);a(l);1<c&&(h=d[c-2],h.left===m?h.left=l:h.right=l);
d[c-1]=l;break}if(1===k._color)if(0===m._color){m._color=1;m.right=e(0,k);break}else m.right=e(0,k);else k=r(k),m.right=k.left,k.left=m,k._color=m._color,m._color=0,a(m),a(k),1<c&&(h=d[c-2],h.left===m?h.left=k:h.right=k),d[c-1]=k,d[c]=m,c+1<d.length?d[c+1]=b:d.push(b),c+=2}else{k=m.left;if(k.left&&0===k.left._color){k=m.left=r(k);l=k.left=r(k.left);m.left=k.right;k.right=m;k.left=l;k._color=m._color;b._color=1;m._color=1;l._color=1;a(m);a(k);1<c&&(h=d[c-2],h.right===m?h.right=k:h.left=k);d[c-1]=k;
break}else if(k.right&&0===k.right._color){k=m.left=r(k);l=k.right=r(k.right);m.left=l.right;k.right=l.left;l.right=m;l.left=k;l._color=m._color;m._color=1;k._color=1;b._color=1;a(m);a(k);a(l);1<c&&(h=d[c-2],h.right===m?h.right=l:h.left=l);d[c-1]=l;break}if(1===k._color)if(0===m._color){m._color=1;m.left=e(0,k);break}else m.left=e(0,k);else k=r(k),m.left=k.right,k.right=m,k._color=m._color,m._color=0,a(m),a(k),1<c&&(h=d[c-2],h.right===m?h.right=k:h.left=k),d[c-1]=k,d[c]=m,c+1<d.length?d[c+1]=b:d.push(b),
c+=2}}p.left===f?p.left=null:p.right=null}return new n(this.tree._compare,d[0])};Object.defineProperty(b,"key",{get:function(){if(0<this._stack.length)return this._stack[this._stack.length-1].key},enumerable:!0});Object.defineProperty(b,"value",{get:function(){if(0<this._stack.length)return this._stack[this._stack.length-1].value},enumerable:!0});Object.defineProperty(b,"index",{get:function(){var a=0,b=this._stack;if(0===b.length)return(a=this.tree.root)?a._count:0;b[b.length-1].left&&(a=b[b.length-
1].left._count);for(var e=b.length-2;0<=e;--e)b[e+1]===b[e].right&&(++a,b[e].left&&(a+=b[e].left._count));return a},enumerable:!0});b.next=function(){var a=this._stack;if(0!==a.length){var b=a[a.length-1];if(b.right)for(b=b.right;b;)a.push(b),b=b.left;else for(a.pop();0<a.length&&a[a.length-1].right===b;)b=a[a.length-1],a.pop()}};Object.defineProperty(b,"hasNext",{get:function(){var a=this._stack;if(0===a.length)return!1;if(a[a.length-1].right)return!0;for(var b=a.length-1;0<b;--b)if(a[b-1].left===
a[b])return!0;return!1}});b.update=function(a){var b=this._stack;if(0===b.length)throw Error("Can't update empty node!");var e=Array(b.length),p=b[b.length-1];e[e.length-1]=new t(p._color,p.key,a,p.left,p.right,p._count);for(a=b.length-2;0<=a;--a)p=b[a],e[a]=p.left===b[a+1]?new t(p._color,p.key,p.value,e[a+1],p.right,p._count):new t(p._color,p.key,p.value,p.left,e[a+1],p._count);return new n(this.tree._compare,e[0])};b.prev=function(){var a=this._stack;if(0!==a.length){var b=a[a.length-1];if(b.left)for(b=
b.left;b;)a.push(b),b=b.right;else for(a.pop();0<a.length&&a[a.length-1].left===b;)b=a[a.length-1],a.pop()}};Object.defineProperty(b,"hasPrev",{get:function(){var a=this._stack;if(0===a.length)return!1;if(a[a.length-1].left)return!0;for(var b=a.length-1;0<b;--b)if(a[b-1].right===a[b])return!0;return!1}})},{}],80:[function(b,h,q){function t(a){if(0>a)return Number("0/0");for(var b=e[0],k=e.length-1;0<k;--k)b+=e[k]/(a+k);k=a+4.7421875+.5;return.5*Math.log(2*Math.PI)+(a+.5)*Math.log(k)-k+Math.log(b)-
Math.log(a)}var r=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9.984369578019572E-6,1.5056327351493116E-7],e=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3.399464998481189E-5,4.652362892704858E-5,-9.837447530487956E-5,1.580887032249125E-4,-2.1026444172410488E-4,2.1743961811521265E-4,-1.643181065367639E-4,8.441822398385275E-5,-2.6190838401581408E-5,3.6899182659531625E-6];
h.exports=function n(b){if(.5>b)return Math.PI/(Math.sin(Math.PI*b)*n(1-b));if(100<b)return Math.exp(t(b));--b;for(var e=r[0],h=1;9>h;h++)e+=r[h]/(b+h);h=b+7+.5;return Math.sqrt(2*Math.PI)*Math.pow(h,b+.5)*Math.exp(-h)*e};h.exports.log=t},{}],81:[function(b,h,q){h.exports=function(b){b[0]=1;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=1;b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=1;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b}},{}],82:[function(b,h,q){var t=b("./identity");h.exports=function(b,e,a,n){var k,l,h,q,u,
m,g,d,f=e[0],p=e[1];e=e[2];h=n[0];q=n[1];l=n[2];g=a[0];n=a[1];k=a[2];if(1E-6>Math.abs(f-g)&&1E-6>Math.abs(p-n)&&1E-6>Math.abs(e-k))return t(b);a=f-g;n=p-n;g=e-k;d=1/Math.sqrt(a*a+n*n+g*g);a*=d;n*=d;g*=d;k=q*g-l*n;l=l*a-h*g;h=h*n-q*a;(d=Math.sqrt(k*k+l*l+h*h))?(d=1/d,k*=d,l*=d,h*=d):h=l=k=0;q=n*h-g*l;u=g*k-a*h;m=a*l-n*k;(d=Math.sqrt(q*q+u*u+m*m))?(d=1/d,q*=d,u*=d,m*=d):m=u=q=0;b[0]=k;b[1]=q;b[2]=a;b[3]=0;b[4]=l;b[5]=u;b[6]=n;b[7]=0;b[8]=h;b[9]=m;b[10]=g;b[11]=0;b[12]=-(k*f+l*p+h*e);b[13]=-(q*f+u*p+
m*e);b[14]=-(a*f+n*p+g*e);b[15]=1;return b}},{"./identity":81}],83:[function(b,h,q){h.exports=function(b,h,e,a,n){h=1/Math.tan(h/2);var k=1/(a-n);b[0]=h/e;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=h;b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=(n+a)*k;b[11]=-1;b[12]=0;b[13]=0;b[14]=2*n*a*k;b[15]=0;return b}},{}],84:[function(b,h,q){q.read=function(b,h,e,a,n){var k;k=8*n-a-1;var l=(1<<k)-1,q=l>>1,v=-7;n=e?n-1:0;var u=e?-1:1,m=b[h+n];n+=u;e=m&(1<<-v)-1;m>>=-v;for(v+=k;0<v;e=256*e+b[h+n],n+=u,v-=8);k=e&(1<<-v)-1;e>>=-v;
for(v+=a;0<v;k=256*k+b[h+n],n+=u,v-=8);if(0===e)e=1-q;else{if(e===l)return k?NaN:Infinity*(m?-1:1);k+=Math.pow(2,a);e-=q}return(m?-1:1)*k*Math.pow(2,e-a)};q.write=function(b,h,e,a,n,k){var l,q=8*k-n-1,v=(1<<q)-1,u=v>>1,m=23===n?Math.pow(2,-24)-Math.pow(2,-77):0;k=a?0:k-1;var g=a?1:-1,d=0>h||0===h&&0>1/h?1:0;h=Math.abs(h);isNaN(h)||Infinity===h?(h=isNaN(h)?1:0,a=v):(a=Math.floor(Math.log(h)/Math.LN2),1>h*(l=Math.pow(2,-a))&&(a--,l*=2),h=1<=a+u?h+m/l:h+m*Math.pow(2,1-u),2<=h*l&&(a++,l/=2),a+u>=v?(h=
0,a=v):1<=a+u?(h=(h*l-1)*Math.pow(2,n),a+=u):(h=h*Math.pow(2,u-1)*Math.pow(2,n),a=0));for(;8<=n;b[e+k]=h&255,k+=g,h/=256,n-=8);a=a<<n|h;for(q+=n;0<q;b[e+k]=a&255,k+=g,a/=256,q-=8);b[e+k-g]|=128*d}},{}],85:[function(b,h,q){function t(a,b,d,e,g){this.mid=a;this.left=b;this.right=d;this.leftPoints=e;this.rightPoints=g;this.count=(b?b.count:0)+(d?d.count:0)+e.length}function r(a,b){a.mid=b.mid;a.left=b.left;a.right=b.right;a.leftPoints=b.leftPoints;a.rightPoints=b.rightPoints;a.count=b.count}function e(a,
b){var d=m(b);a.mid=d.mid;a.left=d.left;a.right=d.right;a.leftPoints=d.leftPoints;a.rightPoints=d.rightPoints;a.count=d.count}function a(a,b){var d=a.intervals([]),g=d.indexOf(b);if(0>g)return 0;d.splice(g,1);e(a,d);return 1}function n(a,b,d){for(var e=0;e<a.length&&a[e][0]<=b;++e){var g=d(a[e]);if(g)return g}}function k(a,b,d){for(var e=a.length-1;0<=e&&a[e][1]>=b;--e){var g=d(a[e]);if(g)return g}}function l(a,b){for(var d=0;d<a.length;++d){var e=b(a[d]);if(e)return e}}function A(a,b){return a-b}
function v(a,b){var d=a[0]-b[0];return d?d:a[1]-b[1]}function u(a,b){var d=a[1]-b[1];return d?d:a[0]-b[0]}function m(a){if(0===a.length)return null;for(var b=[],d=0;d<a.length;++d)b.push(a[d][0],a[d][1]);b.sort(A);for(var b=b[b.length>>1],e=[],g=[],c=[],d=0;d<a.length;++d){var k=a[d];k[1]<b?e.push(k):b<k[0]?g.push(k):c.push(k)}a=c.slice();c.sort(v);a.sort(u);return new t(b,m(e),m(g),c,a)}function g(a){this.root=a}var d=b("binary-search-bounds");h.exports=function(a){return a&&0!==a.length?new g(m(a)):
new g(null)};b=t.prototype;b.intervals=function(a){a.push.apply(a,this.leftPoints);this.left&&this.left.intervals(a);this.right&&this.right.intervals(a);return a};b.insert=function(a){var b=this.count-this.leftPoints.length;this.count+=1;if(a[1]<this.mid)this.left?4*(this.left.count+1)>3*(b+1)?(b=this.intervals([]),b.push(a),e(this,b)):this.left.insert(a):this.left=m([a]);else if(a[0]>this.mid)this.right?4*(this.right.count+1)>3*(b+1)?(b=this.intervals([]),b.push(a),e(this,b)):this.right.insert(a):
this.right=m([a]);else{var b=d.ge(this.leftPoints,a,v),g=d.ge(this.rightPoints,a,u);this.leftPoints.splice(b,0,a);this.rightPoints.splice(g,0,a)}};b.remove=function(b){var e=this.count-this.leftPoints;if(b[1]<this.mid){if(!this.left)return 0;if(4*(this.right?this.right.count:0)>3*(e-1))return a(this,b);e=this.left.remove(b);if(2===e)return this.left=null,--this.count,1;1===e&&--this.count;return e}if(b[0]>this.mid){if(!this.right)return 0;if(4*(this.left?this.left.count:0)>3*(e-1))return a(this,b);
e=this.right.remove(b);if(2===e)return this.right=null,--this.count,1;1===e&&--this.count;return e}if(1===this.count)return this.leftPoints[0]===b?2:0;if(1===this.leftPoints.length&&this.leftPoints[0]===b){if(this.left&&this.right){b=this;for(var g=this.left;g.right;)b=g,g=g.right;if(b===this)g.right=this.right;else{var m=this.left,e=this.right;b.count-=g.count;b.right=g.left;g.left=m;g.right=e}r(this,g);this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?
r(this,this.left):r(this,this.right);return 1}for(m=d.ge(this.leftPoints,b,v);m<this.leftPoints.length&&this.leftPoints[m][0]===b[0];++m)if(this.leftPoints[m]===b)for(--this.count,this.leftPoints.splice(m,1),e=d.ge(this.rightPoints,b,u);e<this.rightPoints.length&&this.rightPoints[e][1]===b[1];++e)if(this.rightPoints[e]===b)return this.rightPoints.splice(e,1),1;return 0};b.queryPoint=function(a,b){if(a<this.mid){if(this.left){var d=this.left.queryPoint(a,b);if(d)return d}return n(this.leftPoints,a,
b)}return a>this.mid?this.right&&(d=this.right.queryPoint(a,b))?d:k(this.rightPoints,a,b):l(this.leftPoints,b)};b.queryInterval=function(a,b,d){if(a<this.mid&&this.left){var e=this.left.queryInterval(a,b,d);if(e)return e}return b>this.mid&&this.right&&(e=this.right.queryInterval(a,b,d))?e:b<this.mid?n(this.leftPoints,b,d):a>this.mid?k(this.rightPoints,a,d):l(this.leftPoints,d)};b=g.prototype;b.insert=function(a){this.root?this.root.insert(a):this.root=new t(a[0],null,null,[a],[a])};b.remove=function(a){return this.root?
(a=this.root.remove(a),2===a&&(this.root=null),0!==a):!1};b.queryPoint=function(a,b){if(this.root)return this.root.queryPoint(a,b)};b.queryInterval=function(a,b,d){if(a<=b&&this.root)return this.root.queryInterval(a,b,d)};Object.defineProperty(b,"count",{get:function(){return this.root?this.root.count:0}});Object.defineProperty(b,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}})},{"binary-search-bounds":86}],86:[function(b,h,q){function t(b,a,n,k,l,h){b=["function ",b,"(a,l,h,",
k.join(","),"){",h?"":"var i=",n?"l-1":"h+1",";while(l<=h){var m=(l+h)>>>1,x=a",l?".get(m)":"[m]"];h?0>a.indexOf("c")?b.push(";if(x===y){return m}else if(x<=y){"):b.push(";var p=c(x,y);if(p===0){return m}else if(p<=0){"):b.push(";if(",a,"){i=m;");n?b.push("l=m+1}else{h=m-1}"):b.push("h=m-1}else{l=m+1}");b.push("}");h?b.push("return -1};"):b.push("return i};");return b.join("")}function r(b,a,n,k){return(new Function([t("A","x"+b+"y",a,["y"],!1,k),t("B","x"+b+"y",a,["y"],!0,k),t("P","c(x,y)"+b+"0",
a,["y","c"],!1,k),t("Q","c(x,y)"+b+"0",a,["y","c"],!0,k),"function dispatchBsearch",n,"(a,y,c,l,h){if(a.shape){if(typeof(c)==='function'){return Q(a,(l===undefined)?0:l|0,(h===undefined)?a.shape[0]-1:h|0,y,c)}else{return B(a,(c===undefined)?0:c|0,(l===undefined)?a.shape[0]-1:l|0,y)}}else{if(typeof(c)==='function'){return P(a,(l===undefined)?0:l|0,(h===undefined)?a.length-1:h|0,y,c)}else{return A(a,(c===undefined)?0:c|0,(l===undefined)?a.length-1:l|0,y)}}}return dispatchBsearch",n].join("")))()}h.exports=
{ge:r(">=",!1,"GE"),gt:r(">",!1,"GT"),lt:r("<",!0,"LT"),le:r("<=",!0,"LE"),eq:r("-",!0,"EQ",!0)}},{}],87:[function(b,h,q){h.exports=function(b,h){h=h||Array(b.length);for(var e=0;e<b.length;++e)h[b[e]]=e;return h}},{}],88:[function(b,h,q){h.exports=function(b){for(var h=Array(b),e=0;e<b;++e)h[e]=e;return h}},{}],89:[function(b,h,q){function t(b){return!!b.constructor&&"function"===typeof b.constructor.isBuffer&&b.constructor.isBuffer(b)}h.exports=function(b){return null!=b&&(t(b)||"function"===typeof b.readFloatLE&&
"function"===typeof b.slice&&t(b.slice(0,0))||!!b._isBuffer)}},{}],90:[function(b,h,q){var t={}.toString;h.exports=Array.isArray||function(b){return"[object Array]"==t.call(b)}},{}],91:[function(b,h,q){function t(a,b,e){for(var d=0,f=0;f<a;++f)b&1<<f&&(d|=1<<e[f]);return d}function r(b,m,g,d,f,p){function h(a,c){w.push("for(","i"+f[a],"=",c,";","i"+f[a],"<","s"+f[a],";","++","i"+f[a],"){")}function r(a){for(var c=0;c<y;++c)w.push("p"+c,"+=","u"+c+"_"+f[a],";");w.push("}")}function q(){for(var a=1;a<
1<<D;++a)w.push(v,"=","e"+a,";","e"+a,"=","y"+a,";","y"+a,"=",v,";")}function c(b,e){if(0>b){for(var g=0;g<y;++g)p[g]?w.push("c"+g+"_0","=","d"+g,".get(","p"+g,");"):w.push("c"+g+"_0","=","d"+g,"[","p"+g,"];");for(var m=[],g=0;g<y;++g)m.push("c"+g+"_0");for(g=0;g<d;++g)m.push("x"+g);w.push("b0","=",n,"[",A,"]=phase(",m.join(),");");for(m=1;m<1<<D;++m)w.push("b"+m,"=",n,"[",A,"+","e"+m,"];");g=[];for(m=1;m<1<<D;++m)g.push("(b0!==b"+m+")");w.push("if(",g.join("||"),"){");for(var l=[],g=0;g<D;++g)l.push("i"+
g);for(g=0;g<y;++g)for(l.push("c"+g+"_0"),m=1;m<1<<D;++m)p[g]?w.push("c"+g+"_"+m,"=","d"+g,".get(","p"+g,"+","d"+g+"_"+m,");"):w.push("c"+g+"_"+m,"=","d"+g,"[","p"+g,"+","d"+g+"_"+m,"];"),l.push("c"+g+"_"+m);for(g=0;g<1<<D;++g)l.push("b"+g);for(g=0;g<d;++g)l.push("x"+g);w.push("vertex(",l.join(),");","v0","=",a,"[",A,"]=",k,"++;");g=(1<<D)-1;l="b"+g;for(m=0;m<D;++m)if(0===(e&~(1<<m))){for(var u=g^1<<m,t="b"+u,v=[],B=u;0<B;B=B-1&u)v.push(a+"["+A+"+"+("e"+B)+"]");v.push("v0");for(B=0;B<y;++B)m&1?v.push("c"+
B+"_"+g,"c"+B+"_"+u):v.push("c"+B+"_"+u,"c"+B+"_"+g);m&1?v.push(l,t):v.push(t,l);for(B=0;B<d;++B)v.push("x"+B);w.push("if(",l,"!==",t,"){","face(",v.join(),")}")}w.push("}",A,"+=1;")}else{for(m=b-1;0<=m;--m)h(m,0);g=[];for(m=0;m<y;++m)p[m]?g.push("d"+m+".get("+("p"+m)+")"):g.push("d"+m+"["+("p"+m)+"]");for(m=0;m<d;++m)g.push("x"+m);w.push(n,"[",A,"++]=phase(",g.join(),");");for(m=0;m<b;++m)r(m);for(m=0;m<y;++m)w.push("p"+m,"+=","u"+m+"_"+f[b],";");w.push("if(","s"+f[b],">0){","i"+f[b],"=1;");c(b-
1,e|1<<f[b]);for(m=0;m<y;++m)w.push("p"+m,"+=","u"+m+"_"+f[b],";");b===D-1&&(w.push(A,"=0;"),q());h(b,2);c(b-1,e);b===D-1&&(w.push("if(","i"+f[D-1],"&1){",A,"=0;}"),q());r(b);w.push("}")}}var y=p.length,D=f.length;if(2>D)throw Error("ndarray-extract-contour: Dimension must be at least 2");for(var B="extractContour"+f.join("_"),w=[],E=[],N=[],G=0;G<y;++G)N.push("a"+G);for(G=0;G<d;++G)N.push("x"+G);for(G=0;G<D;++G)E.push("s"+G+"=a0.shape["+G+"]|0");for(G=0;G<y;++G){E.push("d"+G+"="+("a"+G)+".data",
"o"+G+"="+("a"+G)+".offset|0");for(var F=0;F<D;++F)E.push("t"+G+"_"+F+"="+("a"+G)+".stride["+F+"]|0")}for(G=0;G<y;++G)for(E.push("p"+G+"="+("o"+G)),E.push("c"+G+"_0"),F=1;F<1<<D;++F){for(var R=[],M=0;M<D;++M)F&1<<M&&R.push("-"+("t"+G+"_"+M));E.push("d"+G+"_"+F+"=("+R.join("")+")|0");E.push("c"+G+"_"+F+"=0")}for(G=0;G<y;++G)for(F=0;F<D;++F)M=["t"+G+"_"+f[F]],0<F&&M.push("t"+G+"_"+f[F-1]+"*"+("s"+f[F-1])),E.push("u"+G+"_"+f[F]+"=("+M.join("-")+")|0");for(G=0;G<D;++G)E.push("i"+G+"=0");E.push(k+"=0");
F=["2"];for(G=D-2;0<=G;--G)F.push("s"+f[G]);E.push(l+"=("+F.join("*")+")|0",n+"=mallocUint32("+l+")",a+"=mallocUint32("+l+")",A+"=0");E.push("b0=0");for(F=1;F<1<<D;++F){G=[];R=[];for(M=0;M<D;++M)F&1<<M&&(0===R.length?G.push("1"):G.unshift(R.join("*"))),R.push("s"+f[M]);M="";0>G[0].indexOf("s"+f[D-2])&&(M="-");R=t(D,F,f);E.push("e"+R+"=(-"+G.join("-")+")|0","y"+R+"=("+M+G.join("-")+")|0","b"+R+"=0")}E.push("v0=0",v+"=0");c(D-1,0);w.push("freeUint32(",a,");freeUint32(",n,");");B=["'use strict';function ",
B,"(",N.join(),"){var ",E.join(),";",w.join(""),"}return ",B].join("");return(new Function("vertex","face","phase","mallocUint32","freeUint32",B))(b,m,g,e.mallocUint32,e.freeUint32)}var e=b("typedarray-pool");h.exports=function(a){function b(a){throw Error("ndarray-extract-contour: "+a);}"object"!==typeof a&&b("Must specify arguments");var e=a.order;Array.isArray(e)||b("Must specify order");var d=a.arrayArguments||1;1>d&&b("Must have at least one array argument");var f=a.scalarArguments||0;0>f&&b("Scalar arg count must be > 0");
"function"!==typeof a.vertex&&b("Must specify vertex creation function");"function"!==typeof a.cell&&b("Must specify cell creation function");"function"!==typeof a.phase&&b("Must specify phase function");for(var p=a.getters||[],k=Array(d),l=0;l<d;++l)0<=p.indexOf(l)?k[l]=!0:k[l]=!1;return r(a.vertex,a.cell,a.phase,f,e,k)};var a="V",n="P",k="N",l="Q",A="X",v="T"},{"typedarray-pool":123}],92:[function(b,h,q){function t(a,b){return a[0]-b[0]}function r(){var a=this.stride,b=Array(a.length),e;for(e=0;e<
b.length;++e)b[e]=[Math.abs(a[e]),e];b.sort(t);a=Array(b.length);for(e=0;e<a.length;++e)a[e]=b[e][1];return a}function e(a,b){var e=["View",b,"d",a].join("");0>b&&(e="View_Nil"+a);var g="generic"===a;if(-1===b){var d,e=new Function("function "+e+"(a){this.data=a;};var proto="+e+".prototype;proto.dtype='"+a+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+e+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+
e+"(a){return new "+e+"(a);}");return e()}if(0===b)return e=new Function("TrivialArray","function "+e+"(a,d) {this.data = a;this.offset = d};var proto="+e+".prototype;proto.dtype='"+a+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+e+"_copy() {return new "+e+"(this.data,this.offset)};proto.pick=function "+e+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+
e+"_get(){return "+(g?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+e+"_set(v){return "+(g?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+e+"(a,b,c,d){return new "+e+"(a,d)}"),e(A[a][0]);d=["'use strict'"];var f=n(b),p=f.map(function(a){return"i"+a}),k="this.offset+"+f.map(function(a){return"this.stride["+a+"]*i"+a}).join("+"),l=f.map(function(a){return"b"+a}).join(","),h=f.map(function(a){return"c"+a}).join(",");d.push("function "+
e+"(a,"+l+","+h+",d){this.data=a","this.shape=["+l+"]","this.stride=["+h+"]","this.offset=d|0}","var proto="+e+".prototype","proto.dtype='"+a+"'","proto.dimension="+b);d.push("Object.defineProperty(proto,'size',{get:function "+e+"_size(){return "+f.map(function(a){return"this.shape["+a+"]"}).join("*"),"}})");1===b?d.push("proto.order=[0]"):(d.push("Object.defineProperty(proto,'order',{get:"),4>b?(d.push("function "+e+"_order(){"),2===b?d.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):
3===b&&d.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):d.push("ORDER})"));d.push("proto.set=function "+e+"_set("+p.join(",")+",v){");g?d.push("return this.data.set("+k+",v)}"):d.push("return this.data["+k+"]=v}");d.push("proto.get=function "+e+"_get("+p.join(",")+"){");g?d.push("return this.data.get("+
k+")}"):d.push("return this.data["+k+"]}");d.push("proto.index=function "+e+"_index(",p.join(),"){return "+k+"}");d.push("proto.hi=function "+e+"_hi("+p.join(",")+"){return new "+e+"(this.data,"+f.map(function(a){return["(typeof i",a,"!=='number'||i",a,"<0)?this.shape[",a,"]:i",a,"|0"].join("")}).join(",")+","+f.map(function(a){return"this.stride["+a+"]"}).join(",")+",this.offset)}");g=f.map(function(a){return"a"+a+"=this.shape["+a+"]"});k=f.map(function(a){return"c"+a+"=this.stride["+a+"]"});d.push("proto.lo=function "+
e+"_lo("+p.join(",")+"){var b=this.offset,d=0,"+g.join(",")+","+k.join(","));for(g=0;g<b;++g)d.push("if(typeof i"+g+"==='number'&&i"+g+">=0){d=i"+g+"|0;b+=c"+g+"*d;a"+g+"-=d}");d.push("return new "+e+"(this.data,"+f.map(function(a){return"a"+a}).join(",")+","+f.map(function(a){return"c"+a}).join(",")+",b)}");d.push("proto.step=function "+e+"_step("+p.join(",")+"){var "+f.map(function(a){return"a"+a+"=this.shape["+a+"]"}).join(",")+","+f.map(function(a){return"b"+a+"=this.stride["+a+"]"}).join(",")+
",c=this.offset,d=0,ceil=Math.ceil");for(g=0;g<b;++g)d.push("if(typeof i"+g+"==='number'){d=i"+g+"|0;if(d<0){c+=b"+g+"*(a"+g+"-1);a"+g+"=ceil(-a"+g+"/d)}else{a"+g+"=ceil(a"+g+"/d)}b"+g+"*=d}");d.push("return new "+e+"(this.data,"+f.map(function(a){return"a"+a}).join(",")+","+f.map(function(a){return"b"+a}).join(",")+",c)}");k=Array(b);l=Array(b);for(g=0;g<b;++g)k[g]="a[i"+g+"]",l[g]="b[i"+g+"]";d.push("proto.transpose=function "+e+"_transpose("+p+"){"+p.map(function(a,b){return a+"=("+a+"===undefined?"+
b+":"+a+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+e+"(this.data,"+k.join(",")+","+l.join(",")+",this.offset)}");d.push("proto.pick=function "+e+"_pick("+p+"){var a=[],b=[],c=this.offset");for(g=0;g<b;++g)d.push("if(typeof i"+g+"==='number'&&i"+g+">=0){c=(c+this.stride["+g+"]*i"+g+")|0}else{a.push(this.shape["+g+"]);b.push(this.stride["+g+"])}");d.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}");d.push("return function construct_"+e+"(data,shape,stride,offset){return new "+
e+"(data,"+f.map(function(a){return"shape["+a+"]"}).join(",")+","+f.map(function(a){return"stride["+a+"]"}).join(",")+",offset)}");e=new Function("CTOR_LIST","ORDER",d.join("\n"));return e(A[a],r)}function a(a){if(k(a))return"buffer";if(l)switch(Object.prototype.toString.call(a)){case "[object Float64Array]":return"float64";case "[object Float32Array]":return"float32";case "[object Int8Array]":return"int8";case "[object Int16Array]":return"int16";case "[object Int32Array]":return"int32";case "[object Uint8Array]":return"uint8";
case "[object Uint16Array]":return"uint16";case "[object Uint32Array]":return"uint32";case "[object Uint8ClampedArray]":return"uint8_clamped"}return Array.isArray(a)?"array":"generic"}var n=b("iota-array"),k=b("is-buffer"),l="undefined"!==typeof Float64Array,A={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};(function(){for(var a in A)A[a].push(e(a,-1))});h.exports=function(b,k,m,g){if(void 0===b){var d=A.array[0];return d([])}"number"===
typeof b&&(b=[b]);void 0===k&&(k=[b.length]);d=k.length;if(void 0===m){m=Array(d);for(var f=d-1,p=1;0<=f;--f)m[f]=p,p*=k[f]}if(void 0===g)for(f=g=0;f<d;++f)0>m[f]&&(g-=(k[f]-1)*m[f]);f=a(b);for(p=A[f];p.length<=d+1;)p.push(e(f,p.length-1));d=p[d+1];return d(b,k,m,g)}},{"iota-array":88,"is-buffer":89}],93:[function(b,h,q){var t=b("double-bits"),r=Math.pow(2,-1074);h.exports=function(b,a){if(isNaN(b)||isNaN(a))return NaN;if(b===a)return b;if(0===b)return 0>a?-r:r;var n=t.hi(b),k=t.lo(b);a>b===0<b?4294967295===
k?(n+=1,k=0):k+=1:0===k?(k=4294967295,--n):--k;return t.pack(k,n)}},{"double-bits":76}],94:[function(b,h,q){h.exports=function(b){var a=b.length;if(a<t)for(var n=1,k=0;k<a;++k)for(var l=0;l<k;++l)if(b[k]<b[l])n=-n;else{if(b[k]===b[l])return 0}else{for(var h=r.mallocUint8(a),k=0;k<a;++k)h[k]=0;n=1;for(k=0;k<a;++k)if(!h[k]){var q=1;h[k]=1;for(l=b[k];l!==k;l=b[l]){if(h[l])return r.freeUint8(h),0;q+=1;h[l]=1}q&1||(n=-n)}r.freeUint8(h)}return n};var t=32,r=b("typedarray-pool")},{"typedarray-pool":123}],
95:[function(b,h,q){var t=b("typedarray-pool"),r=b("invert-permutation");q.rank=function(b){var a=b.length;switch(a){case 0:case 1:return 0;case 2:return b[1]}var n=t.mallocUint32(a),k=t.mallocUint32(a),l=0,h;r(b,k);for(h=0;h<a;++h)n[h]=b[h];for(h=a-1;0<h;--h)a=k[h],b=n[h],n[h]=n[a],n[a]=b,k[h]=k[b],k[b]=a,l=(l+b)*h;t.freeUint32(k);t.freeUint32(n);return l};q.unrank=function(b,a,n){switch(b){case 0:return n?n:[];case 1:return n?(n[0]=0,n):[0];case 2:return n?(a?(n[0]=0,n[1]=1):(n[0]=1,n[1]=0),n):
a?[0,1]:[1,0]}n=n||Array(b);var k,l,h=1;n[0]=0;for(l=1;l<b;++l)n[l]=l,h=h*l|0;for(l=b-1;0<l;--l)b=a/h|0,a=a-b*h|0,h=h/l|0,k=n[l]|0,n[l]=n[b]|0,n[b]=k|0;return n}},{"invert-permutation":87,"typedarray-pool":123}],96:[function(b,h,q){h.exports=function(b,e){function a(a,b){var d=q[b][a[b]];d.splice(d.indexOf(a),1)}function n(b,d,g){var m,k,c;for(k=0;2>k;++k)if(0<q[k][d].length){m=q[k][d][0];c=k;break}k=m[c^1];for(var l=0;2>l;++l)for(var n=q[l][d],h=0;h<n.length;++h){var r=n[h],u=r[l^1];0<t(e[b],e[d],
e[k],e[u])&&(m=r,k=u,c=l)}if(g)return k;m&&a(m,c);return k}function k(b,d){var g=q[d][b][0],m=[b];a(g,d);for(g=g[d^1];;){for(;g!==b;)m.push(g),g=n(m[m.length-2],g,!1);if(0===q[0][b].length+q[1][b].length)break;var g=m[m.length-1],k=b,c=m[1],l=n(g,k,!0);if(0>t(e[g],e[k],e[c],e[l]))break;m.push(b);g=n(g,k)}return m}for(var l=e.length|0,h=b.length,q=[Array(l),Array(l)],u=0;u<l;++u)q[0][u]=[],q[1][u]=[];for(u=0;u<h;++u){var m=b[u];q[0][m[0]].push(m);q[1][m[1]].push(m)}h=[];for(u=0;u<l;++u)0===q[0][u].length+
q[1][u].length&&h.push([u]);for(u=0;u<l;++u)for(m=0;2>m;++m){for(var g=[];0<q[m][u].length;){var d=k(u,m);d[1]===d[d.length-1]?g.push.apply(g,d):(0<g.length&&h.push(g),g=d)}0<g.length&&h.push(g)}return h};var t=b("compare-angle")},{"compare-angle":70}],97:[function(b,h,q){h.exports=function(b,e){for(var a=t(b,e.length),n=Array(e.length),k=Array(e.length),l=[],h=0;h<e.length;++h){var q=a[h].length;k[h]=q;n[h]=!0;1>=q&&l.push(h)}for(;0<l.length;)for(q=l.pop(),n[q]=!1,q=a[q],h=0;h<q.length;++h){var u=
q[h];0===--k[u]&&l.push(u)}a=Array(e.length);k=[];for(h=0;h<e.length;++h)n[h]?(q=k.length,a[h]=q,k.push(e[h])):a[h]=-1;l=[];for(h=0;h<b.length;++h)q=b[h],n[q[0]]&&n[q[1]]&&l.push([a[q[0]],a[q[1]]]);return[l,k]};var t=b("edges-to-adjacency-list")},{"edges-to-adjacency-list":78}],98:[function(b,h,q){function t(a,b){for(var e=Array(a),d=0;d<a;++d)e[d]=b;return e}function r(a){for(var b=Array(a),e=0;e<a;++e)b[e]=[];return b}h.exports=function(b,m){function g(a){for(var c=a.length,b=0;b<c;++b)if(!F[a[b]])return!1;
return!0}var d=v(b,m);b=d[0];m=d[1];for(var f=m.length,p=e(b,m.length),h=0;h<f;++h)if(1===p[h].length%2)throw Error("planar-graph-to-polyline: graph must be manifold");for(var p=a(b,m),p=p.filter(function(a){for(var c=a.length,b=[0],d=0;d<c;++d)var e=m[a[d]],f=m[a[(d+1)%c]],g=k(-e[0],e[1]),p=k(-e[0],f[1]),e=k(f[0],e[1]),f=k(f[0],f[1]),b=l(b,l(l(g,p),l(e,f)));return 0<b[b.length-1]}),d=p.length,q=Array(d),C=Array(d),h=0;h<d;++h){q[h]=h;var c=Array(d),y=p[h].map(function(a){return m[a]}),D=n([y]),B=
0,w=0;a:for(;w<d;++w)if(c[w]=0,h!==w){for(var y=p[w],E=y.length,N=0;N<E;++N){var G=D(m[y[N]]);if(0!==G){0>G&&(c[w]=1,B+=1);continue a}}c[w]=1;B+=1}C[h]=[B,h,c]}C.sort(function(a,c){return c[0]-a[0]});for(h=0;h<d;++h)for(c=C[h],y=c[1],E=c[2],w=0;w<d;++w)E[w]&&(q[w]=y);C=r(d);for(h=0;h<d;++h)C[h].push(q[h]),C[q[h]].push(h);for(var c={},F=t(f,!1),h=0;h<d;++h)for(y=p[h],E=y.length,w=0;w<E;++w)f=y[w],D=y[(w+1)%E],B=Math.min(f,D)+":"+Math.max(f,D),B in c?(B=c[B],C[B].push(h),C[h].push(B),F[f]=F[D]=!0):
c[B]=h;w=[];f=t(d,-1);for(h=0;h<d;++h)q[h]!==h||g(p[h])?f[h]=-1:(w.push(h),f[h]=0);for(d=[];0<w.length;){h=w.pop();q=C[h];A(q,function(a,c){return a-c});var E=q.length,c=f[h],R;0===c&&(y=p[h],R=[y]);for(h=0;h<E;++h)y=q[h],0<=f[y]||(f[y]=c^1,w.push(y),0===c&&(y=p[y],g(y)||(y.reverse(),R.push(y))));0===c&&d.push(R)}return d};var e=b("edges-to-adjacency-list"),a=b("planar-dual"),n=b("point-in-big-polygon"),k=b("two-product"),l=b("robust-sum"),A=b("uniq"),v=b("./lib/trim-leaves")},{"./lib/trim-leaves":97,
"edges-to-adjacency-list":78,"planar-dual":96,"point-in-big-polygon":100,"robust-sum":111,"two-product":121,uniq:125}],99:[function(b,h,q){arguments[4][86][0].apply(q,arguments)},{dup:86}],100:[function(b,h,q){function t(){return!0}function r(a){return function(b,e){var m=a[b];return m?!!m.queryPoint(e,t):!1}}function e(a){for(var b={},e=0;e<a.length;++e){var m=a[e],k=m[0][0],l=m[0][1],m=m[1][1],l=[Math.min(l,m),Math.max(l,m)];k in b?b[k].push(l):b[k]=[l]}a={};k=Object.keys(b);for(e=0;e<k.length;++e)a[k[e]]=
u(b[k[e]]);return r(a)}function a(a,b){return function(e){var k=m.le(b,e[0]);if(0>k)return 1;var l=a[k];if(!l)if(0<k&&b[k]===e[0])l=a[k-1];else return 1;for(k=1;l;){var h=l.key,n=A(e,h[0],h[1]);if(h[0][0]<h[1][0])if(0>n)l=l.left;else if(0<n)k=-1,l=l.right;else return 0;else if(0<n)l=l.left;else if(0>n)k=1,l=l.right;else return 0}return k}}function n(a){return 1}function k(a){return function(b){return a(b[0],b[1])?0:1}}function l(a,b){return function(e){return a(e[0],e[1])?0:b(e)}}h.exports=function(b){for(var d=
b.length,f=[],m=[],h=0;h<d;++h)for(var r=b[h],u=r.length,c=u-1,t=0;t<u;c=t++){var c=r[c],q=r[t];c[0]===q[0]?m.push([c,q]):f.push([c,q])}if(0===f.length)return 0===m.length?n:k(e(m));b=v(f);b=a(b.slabs,b.coordinates);return 0===m.length?b:l(e(m),b)};var A=b("robust-orientation")[3],v=b("slab-decomposition"),u=b("interval-tree-1d"),m=b("binary-search-bounds")},{"binary-search-bounds":99,"interval-tree-1d":85,"robust-orientation":106,"slab-decomposition":118}],101:[function(b,h,q){var t=b("big-rat/add");
h.exports=function(b,e){for(var a=b.length,h=Array(a),k=0;k<a;++k)h[k]=t(b[k],e[k]);return h}},{"big-rat/add":36}],102:[function(b,h,q){h.exports=function(b){for(var e=Array(b.length),a=0;a<b.length;++a)e[a]=t(b[a]);return e};var t=b("big-rat")},{"big-rat":39}],103:[function(b,h,q){var t=b("big-rat"),r=b("big-rat/mul");h.exports=function(b,a){for(var h=t(a),k=b.length,l=Array(k),q=0;q<k;++q)l[q]=r(b[q],h);return l}},{"big-rat":39,"big-rat/mul":48}],104:[function(b,h,q){var t=b("big-rat/sub");h.exports=
function(b,e){for(var a=b.length,h=Array(a),k=0;k<a;++k)h[k]=t(b[k],e[k]);return h}},{"big-rat/sub":51}],105:[function(b,h,q){function t(a,b){for(var e=Array(a.length-1),g=1;g<a.length;++g)for(var m=e[g-1]=Array(a.length-1),k=0,c=0;k<a.length;++k)k!==b&&(m[c++]=a[g][k]);return e}function r(a){if(1===a.length)return a[0];if(2===a.length)return["sum(",a[0],",",a[1],")"].join("");var b=a.length>>1;return["sum(",r(a.slice(0,b)),",",r(a.slice(b)),")"].join("")}function e(a,b){if("m"===a.charAt(0)){if("w"===
b.charAt(0)){var g=a.split("[");return["w",b.substr(1),"m",g[0].substr(1)].join("")}return["prod(",a,",",b,")"].join("")}return e(b,a)}function a(b){if(2===b.length)return[["diff(",e(b[0][0],b[1][1]),",",e(b[1][0],b[0][1]),")"].join("")];for(var f=[],g=0;g<b.length;++g)f.push(["scale(",r(a(t(b,g))),",",g&1?"-":"",b[0][g],")"].join(""));return f}function n(a,b){for(var e=[],g=0;g<b-2;++g)e.push(["prod(m",a,"[",g,"],m",a,"[",g,"])"].join(""));return r(e)}function k(b){for(var e=[],g=[],k=Array(b),l=
0;l<b;++l){k[l]=Array(b);for(var h=0;h<b;++h)k[l][h]=["m",h,"[",b-l-2,"]"].join("")}for(l=0;l<b;++l)k[0][l]="1",k[b-1][l]="w"+l;for(l=0;l<b;++l)0===(l&1)?e.push.apply(e,a(t(k,l))):g.push.apply(g,a(t(k,l)));e=r(e);g=r(g);k="exactInSphere"+b;h=[];for(l=0;l<b;++l)h.push("m"+l);h=["function ",k,"(",h.join(),"){"];for(l=0;l<b;++l){h.push("var w",l,"=",n(l,b),";");for(var c=0;c<b;++c)c!==l&&h.push("var w",l,"m",c,"=scale(w",l,",m",c,"[0]);")}h.push("var p=",e,",n=",g,",d=diff(p,n);return d[d.length-1];}return ",
k);return(new Function("sum","diff","prod","scale",h.join("")))(v,u,A,m)}function l(a){var b=g[a.length];b||(b=g[a.length]=k(a.length));return b.apply(void 0,a)}var A=b("two-product"),v=b("robust-sum"),u=b("robust-subtract"),m=b("robust-scale"),g=[function(){return 0},function(){return 0},function(){return 0}];(function(){for(;6>=g.length;)g.push(k(g.length));for(var a=[],b=["slow"],e=0;6>=e;++e)a.push("a"+e),b.push("o"+e);for(var m=["function testInSphere(",a.join(),"){switch(arguments.length){case 0:case 1:return 0;"],
e=2;6>=e;++e)m.push("case ",e,":return o",e,"(",a.slice(0,e).join(),");");m.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return testInSphere");b.push(m.join(""));a=Function.apply(void 0,b);h.exports=a.apply(void 0,[l].concat(g));for(e=0;6>=e;++e)h.exports[e]=g[e]})()},{"robust-scale":108,"robust-subtract":110,"robust-sum":111,"two-product":121}],106:[function(b,h,q){function t(a,b){for(var e=Array(a.length-1),g=1;g<a.length;++g)for(var m=
e[g-1]=Array(a.length-1),k=0,c=0;k<a.length;++k)k!==b&&(m[c++]=a[g][k]);return e}function r(a){if(1===a.length)return a[0];if(2===a.length)return["sum(",a[0],",",a[1],")"].join("");var b=a.length>>1;return["sum(",r(a.slice(0,b)),",",r(a.slice(b)),")"].join("")}function e(a){if(2===a.length)return[["sum(prod(",a[0][0],",",a[1][1],"),prod(-",a[0][1],",",a[1][0],"))"].join("")];for(var b=[],g=0;g<a.length;++g)b.push(["scale(",r(e(t(a,g))),",",g&1?"-":"",a[0][g],")"].join(""));return b}function a(a){for(var b=
[],g=[],m=Array(a),h=0;h<a;++h){m[h]=Array(a);for(var n=0;n<a;++n)m[h][n]=["m",n,"[",a-h-1,"]"].join("")}h=[];for(n=0;n<a;++n)0===(n&1)?b.push.apply(b,e(t(m,n))):g.push.apply(g,e(t(m,n))),h.push("m"+n);b=r(b);g=r(g);a="orientation"+a+"Exact";a=["function ",a,"(",h.join(),"){var p=",b,",n=",g,",d=sub(p,n);return d[d.length-1];};return ",a].join("");return(new Function("sum","prod","scale","sub",a))(l,k,A,v)}function n(b){var e=g[b.length];e||(e=g[b.length]=a(b.length));return e.apply(void 0,b)}var k=
b("two-product"),l=b("robust-sum"),A=b("robust-scale"),v=b("robust-subtract"),u=a(3),m=a(4),g=[function(){return 0},function(){return 0},function(a,b){return b[0]-a[0]},function(a,b,e){var g=(a[1]-e[1])*(b[0]-e[0]),m=(a[0]-e[0])*(b[1]-e[1]),k=g-m;if(0<g){if(0>=m)return k;g+=m}else if(0>g){if(0<=m)return k;g=-(g+m)}else return k;g*=3.3306690738754716E-16;return k>=g||k<=-g?k:u(a,b,e)},function(a,b,e,g){var k=a[0]-g[0],l=b[0]-g[0],c=e[0]-g[0],h=a[1]-g[1],n=b[1]-g[1],r=e[1]-g[1],u=a[2]-g[2],t=b[2]-g[2],
q=e[2]-g[2],v=l*r,A=c*n,c=c*h,r=k*r,k=k*n,h=l*h,l=u*(v-A)+t*(c-r)+q*(k-h),u=7.771561172376103E-16*((Math.abs(v)+Math.abs(A))*Math.abs(u)+(Math.abs(c)+Math.abs(r))*Math.abs(t)+(Math.abs(k)+Math.abs(h))*Math.abs(q));return l>u||-l>u?l:m(a,b,e,g)}];(function(){for(;5>=g.length;)g.push(a(g.length));for(var b=[],e=["slow"],m=0;5>=m;++m)b.push("a"+m),e.push("o"+m);for(var k=["function getOrientation(",b.join(),"){switch(arguments.length){case 0:case 1:return 0;"],m=2;5>=m;++m)k.push("case ",m,":return o",
m,"(",b.slice(0,m).join(),");");k.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation");e.push(k.join(""));b=Function.apply(void 0,e);h.exports=b.apply(void 0,[n].concat(g));for(m=0;5>=m;++m)h.exports[m]=g[m]})()},{"robust-scale":108,"robust-subtract":110,"robust-sum":111,"two-product":121}],107:[function(b,h,q){var t=b("robust-sum"),r=b("robust-scale");h.exports=function(b,a){if(1===b.length)return r(a,b[0]);if(1===
a.length)return r(b,a[0]);if(0===b.length||0===a.length)return[0];var h=[0];if(b.length<a.length)for(var k=0;k<b.length;++k)h=t(h,r(a,b[k]));else for(k=0;k<a.length;++k)h=t(h,r(b,a[k]));return h}},{"robust-scale":108,"robust-sum":111}],108:[function(b,h,q){var t=b("two-product"),r=b("two-sum");h.exports=function(b,a){var h=b.length;if(1===h)return h=t(b[0],a),h[0]?h:[h[1]];var k=Array(2*h),l=[.1,.1],q=[.1,.1],v=0;t(b[0],a,l);l[0]&&(k[v++]=l[0]);for(var u=1;u<h;++u){t(b[u],a,q);r(l[1],q[0],l);l[0]&&
(k[v++]=l[0]);var m=q[1],g=l[1],d=m+g,m=g-(d-m);l[1]=d;m&&(k[v++]=m)}l[1]&&(k[v++]=l[1]);0===v&&(k[v++]=0);k.length=v;return k}},{"two-product":121,"two-sum":122}],109:[function(b,h,q){h.exports=function(b,e,a,h){var k=t(b,a,h),l=t(e,a,h);if(0<k&&0<l||0>k&&0>l)return!1;var q=t(a,b,e),v=t(h,b,e);if(0<q&&0<v||0>q&&0>v)return!1;if(0===k&&0===l&&0===q&&0===v){a:{for(k=0;2>k;++k){var l=b[k],q=e[k],v=Math.max(l,q),u=a[k],m=h[k],g=Math.min(u,m);if(Math.max(u,m)<Math.min(l,q)||v<g){b=!1;break a}}b=!0}return b}return!0};
var t=b("robust-orientation")[3]},{"robust-orientation":106}],110:[function(b,h,q){h.exports=function(b,h){var e=b.length|0,a=h.length|0;if(1===e&&1===a){var a=b[0],n=-h[0],e=a+n,k=e-a,e=(a=a-(e-k)+(n-k))?[a,e]:[e];return e}var n=Array(e+a),l=k=0,q=0,v=Math.abs,u=b[l],m=v(u),g=-h[q],d=v(g),f,p;m<d?(p=u,l+=1,l<e&&(u=b[l],m=v(u))):(p=g,q+=1,q<a&&(g=-h[q],d=v(g)));l<e&&m<d||q>=a?(f=u,l+=1,l<e&&(u=b[l],m=v(u))):(f=g,q+=1,q<a&&(g=-h[q],d=v(g)));var x=f+p;p-=x-f;for(var z=x,C;l<e&&q<a;)m<d?(f=u,l+=1,l<
e&&(u=b[l],m=v(u))):(f=g,q+=1,q<a&&(g=-h[q],d=v(g))),x=f+p,f=x-f,(f=p-f)&&(n[k++]=f),f=z+x,C=f-z,p=f-C,x-=C,z-=p,p=z+x,z=f;for(;l<e;)f=u,x=f+p,f=x-f,(f=p-f)&&(n[k++]=f),f=z+x,C=f-z,p=f-C,x-=C,z-=p,p=z+x,z=f,l+=1,l<e&&(u=b[l]);for(;q<a;)f=g,x=f+p,f=x-f,(f=p-f)&&(n[k++]=f),f=z+x,C=f-z,p=f-C,x-=C,z-=p,p=z+x,z=f,q+=1,q<a&&(g=-h[q]);p&&(n[k++]=p);z&&(n[k++]=z);k||(n[k++]=0);n.length=k;return n}},{}],111:[function(b,h,q){h.exports=function(b,h){var e=b.length|0,a=h.length|0;if(1===e&&1===a){var a=b[0],
n=h[0],e=a+n,k=e-a,e=(a=a-(e-k)+(n-k))?[a,e]:[e];return e}var n=Array(e+a),l=k=0,q=0,v=Math.abs,u=b[l],m=v(u),g=h[q],d=v(g),f,p;m<d?(p=u,l+=1,l<e&&(u=b[l],m=v(u))):(p=g,q+=1,q<a&&(g=h[q],d=v(g)));l<e&&m<d||q>=a?(f=u,l+=1,l<e&&(u=b[l],m=v(u))):(f=g,q+=1,q<a&&(g=h[q],d=v(g)));var x=f+p;p-=x-f;for(var z=x,C;l<e&&q<a;)m<d?(f=u,l+=1,l<e&&(u=b[l],m=v(u))):(f=g,q+=1,q<a&&(g=h[q],d=v(g))),x=f+p,f=x-f,(f=p-f)&&(n[k++]=f),f=z+x,C=f-z,p=f-C,x-=C,z-=p,p=z+x,z=f;for(;l<e;)f=u,x=f+p,f=x-f,(f=p-f)&&(n[k++]=f),f=
z+x,C=f-z,p=f-C,x-=C,z-=p,p=z+x,z=f,l+=1,l<e&&(u=b[l]);for(;q<a;)f=g,x=f+p,f=x-f,(f=p-f)&&(n[k++]=f),f=z+x,C=f-z,p=f-C,x-=C,z-=p,p=z+x,z=f,q+=1,q<a&&(g=h[q]);p&&(n[k++]=p);z&&(n[k++]=z);k||(n[k++]=0);n.length=k;return n}},{}],112:[function(b,h,q){arguments[4][54][0].apply(q,arguments)},{dup:54}],113:[function(b,h,q){function t(b){this.roots=Array(b);this.ranks=Array(b);for(var e=0;e<b;++e)this.roots[e]=e,this.ranks[e]=0}"use restrict";h.exports=t;t.prototype.length=function(){return this.roots.length};
t.prototype.makeSet=function(){var b=this.roots.length;this.roots.push(b);this.ranks.push(0);return b};t.prototype.find=function(b){for(var e=this.roots;e[b]!==b;){var a=e[b];e[b]=e[a];b=a}return b};t.prototype.link=function(b,e){var a=this.find(b),h=this.find(e);if(a!==h){var k=this.ranks,l=this.roots,q=k[a],t=k[h];q<t?l[a]=h:t<q?l[h]=a:(l[h]=a,++k[a])}}},{}],114:[function(b,h,q){function t(a,b){var e=a.length,d=a.length-b.length,f=Math.min;if(d)return d;switch(e){case 0:return 0;case 1:return a[0]-
b[0];case 2:return(e=a[0]+a[1]-b[0]-b[1])?e:f(a[0],a[1])-f(b[0],b[1]);case 3:var d=a[0]+a[1],k=b[0]+b[1];if(e=d+a[2]-(k+b[2]))return e;var l=f(a[0],a[1]),h=f(b[0],b[1]);return(e=f(l,a[2])-f(h,b[2]))?e:f(l+a[2],d)-f(h+b[2],k);default:f=a.slice(0);f.sort();k=b.slice(0);k.sort();for(l=0;l<e;++l)if(d=f[l]-k[l])return d;return 0}}function r(a,b){return t(a[0],b[0])}function e(a,b){if(b){for(var e=a.length,d=Array(e),f=0;f<e;++f)d[f]=[a[f],b[f]];d.sort(r);for(f=0;f<e;++f)a[f]=d[f][0],b[f]=d[f][1]}else a.sort(t);
return a}function a(a){if(0===a.length)return[];for(var b=1,e=a.length,d=1;d<e;++d){var f=a[d];t(f,a[d-1])&&(d===b?b++:a[b++]=f)}a.length=b;return a}function n(a,b){for(var e=0,d=a.length-1,f=-1;e<=d;){var k=e+d>>1,l=t(a[k],b);0>=l?(0===l&&(f=k),e=k+1):0<l&&(d=k-1)}return f}function k(a,b){for(var e=Array(a.length),d=0,f=e.length;d<f;++d)e[d]=[];for(var f=[],d=0,k=b.length;d<k;++d)for(var l=b[d],h=l.length,r=1,c=1<<h;r<c;++r){f.length=A.popCount(r);for(var q=0,v=0;v<h;++v)r&1<<v&&(f[q++]=l[v]);q=
n(a,f);if(!(0>q))for(;!(e[q++].push(d),q>=a.length||0!==t(a[q],f)););}return e}function l(a,b){if(0>b)return[];for(var g=[],d=(1<<b+1)-1,f=0;f<a.length;++f)for(var k=a[f],l=d;l<1<<k.length;l=A.nextCombination(l)){for(var h=Array(b+1),n=0,c=0;c<k.length;++c)l&1<<c&&(h[n++]=k[c]);g.push(h)}return e(g)}"use restrict";var A=b("bit-twiddle"),v=b("union-find");q.dimension=function(a){for(var b=0,e=Math.max,d=0,f=a.length;d<f;++d)b=e(b,a[d].length);return b-1};q.countVertices=function(a){for(var b=-1,e=
Math.max,d=0,f=a.length;d<f;++d)for(var k=a[d],l=0,h=k.length;l<h;++l)b=e(b,k[l]);return b+1};q.cloneCells=function(a){for(var b=Array(a.length),e=0,d=a.length;e<d;++e)b[e]=a[e].slice(0);return b};q.compareCells=t;q.normalize=e;q.unique=a;q.findCell=n;q.incidence=k;q.dual=function(b,e){if(!e)return k(a(l(b,0)),b,0);for(var g=Array(e),d=0;d<e;++d)g[d]=[];for(var d=0,f=b.length;d<f;++d)for(var h=b[d],n=0,r=h.length;n<r;++n)g[h[n]].push(d);return g};q.explode=function(a){for(var b=[],g=0,d=a.length;g<
d;++g)for(var f=a[g],k=f.length|0,l=1,h=1<<k;l<h;++l){for(var n=[],c=0;c<k;++c)l>>>c&1&&n.push(f[c]);b.push(n)}return e(b)};q.skeleton=l;q.boundary=function(a){for(var b=[],g=0,d=a.length;g<d;++g)for(var f=a[g],k=0,l=f.length;k<l;++k){for(var h=Array(f.length-1),n=0,c=0;n<l;++n)n!==k&&(h[c++]=f[n]);b.push(h)}return e(b)};q.connectedComponents=function(b,k){if(k){for(var g=new v(k),d=0;d<b.length;++d)for(var f=b[d],h=0;h<f.length;++h)for(var r=h+1;r<f.length;++r)g.link(f[h],f[r]);f=[];h=g.ranks;for(d=
0;d<h.length;++d)h[d]=-1;for(d=0;d<b.length;++d)r=g.find(b[d][0]),0>h[r]?(h[r]=f.length,f.push([b[d].slice(0)])):f[h[r]].push(b[d].slice(0));return f}g=a(e(l(b,0)));d=new v(g.length);for(f=0;f<b.length;++f)for(h=b[f],r=0;r<h.length;++r)for(var q=n(g,[h[r]]),t=r+1;t<h.length;++t)d.link(q,n(g,[h[t]]));h=[];r=d.ranks;for(f=0;f<r.length;++f)r[f]=-1;for(f=0;f<b.length;++f)q=d.find(n(g,[b[f][0]])),0>r[q]?(r[q]=h.length,h.push([b[f].slice(0)])):h[r[q]].push(b[f].slice(0));return h}},{"bit-twiddle":112,"union-find":113}],
115:[function(b,h,q){h.exports=function(b,a,h){function k(b){if(c[b])return Infinity;var d=x[b],e=z[b];if(0>d||0>e)return Infinity;d=a[d];e=a[e];return Math.abs(t(a[b],d,e))/Math.sqrt(Math.pow(d[0]-e[0],2)+Math.pow(d[1]-e[1],2))}function l(a,b){var c=w[a],d=w[b];w[a]=d;w[b]=c;E[c]=b;E[d]=a}function q(a){for(var b=C[w[a]];;){var c=b,d=2*a+1,e=2*(a+1),f=a;if(d<N){var g=C[w[d]];g<c&&(f=d,c=g)}e<N&&C[w[e]]<c&&(f=e);if(f===a)return a;l(a,f);a=f}}function v(a){for(var b=C[w[a]];0<a;){var c;c=a&1?a-1>>1:
(a>>1)-1;if(0<=c&&b<C[w[c]])l(a,c),a=c;else return a}}function u(){if(0<N){var a=w[0];l(0,N-1);--N;q(0);return a}return-1}function m(a,b){var c=w[a];if(C[c]===b)return a;C[c]=-Infinity;v(a);u();C[c]=b;N+=1;return v(N-1)}function g(a){if(!c[a]){c[a]=!0;var b=x[a];a=z[a];0<=x[a]&&(x[a]=b);0<=z[b]&&(z[b]=a);0<=E[b]&&m(E[b],k(b));0<=E[a]&&m(E[a],k(a))}}function d(a,b){if(0>a[b])return b;var d=b,e=b;do{var f=a[e];if(!c[e]||0>f||f===e)break;e=f;f=a[e];if(!c[e]||0>f||f===e)break;e=f;d=a[d]}while(d!==e);
for(d=b;d!==e;d=a[d])a[d]=e;return e}for(var f=a.length,p=b.length,x=Array(f),z=Array(f),C=Array(f),c=Array(f),y=0;y<f;++y)x[y]=z[y]=-1,C[y]=Infinity,c[y]=!1;for(y=0;y<p;++y){var D=b[y];if(2!==D.length)throw Error("Input must be a graph");var B=D[1],D=D[0];z[D]=-1!==z[D]?-2:B;x[B]=-1!==x[B]?-2:D}for(var w=[],E=Array(f),y=0;y<f;++y)Infinity>(C[y]=k(y))?(E[y]=w.length,w.push(y)):E[y]=-1;for(var N=w.length,y=N>>1;0<=y;--y)q(y);for(;;){y=u();if(0>y||C[y]>h)break;g(y)}h=[];for(y=0;y<f;++y)c[y]||(E[y]=
h.length,h.push(a[y].slice()));var G=[];b.forEach(function(a){var b=d(x,a[0]);a=d(z,a[1]);0<=b&&0<=a&&b!==a&&(b=E[b],a=E[a],b!==a&&G.push([b,a]))});r.unique(r.normalize(G));return{positions:h,edges:G}};var t=b("robust-orientation"),r=b("simplicial-complex")},{"robust-orientation":106,"simplicial-complex":114}],116:[function(b,h,q){function t(b,a){var h,k;if(a[0][0]<a[1][0])h=a[0],k=a[1];else if(a[0][0]>a[1][0])h=a[1],k=a[0];else{h=Math.min(b[0][1],b[1][1]);k=Math.max(b[0][1],b[1][1]);var l=Math.min(a[0][1],
a[1][1]),q=Math.max(a[0][1],a[1][1]);return k<l?k-l:h>q?h-q:k-q}b[0][1]<b[1][1]?(q=b[0],l=b[1]):(q=b[1],l=b[0]);return(q=r(k,h,q))?q:(q=r(k,h,l))?q:l-k}h.exports=function(b,a){var h,k;if(a[0][0]<a[1][0])h=a[0],k=a[1];else if(a[0][0]>a[1][0])h=a[1],k=a[0];else return t(a,b);var l,q;if(b[0][0]<b[1][0])l=b[0],q=b[1];else if(b[0][0]>b[1][0])l=b[1],q=b[0];else return-t(b,a);var v=r(h,k,q),u=r(h,k,l);if(0>v){if(0>=u)return v}else if(0<v){if(0<=u)return v}else if(u)return u;v=r(q,l,k);u=r(q,l,h);if(0>v){if(0>=
u)return v}else if(0<v){if(0<=u)return v}else if(u)return u;return k[0]-q[0]};var r=b("robust-orientation")},{"robust-orientation":106}],117:[function(b,h,q){arguments[4][86][0].apply(q,arguments)},{dup:86}],118:[function(b,h,q){function t(a,b,e){this.slabs=a;this.coordinates=b;this.horizontal=e}function r(a,b){return a.y-b}function e(a,b){for(var g=null;a;){var d=a.key,f,k;d[0][0]<d[1][0]?(f=d[0],k=d[1]):(f=d[1],k=d[0]);f=A(f,k,b);if(0>f)a=a.left;else if(0<f)if(b[0]!==d[1][0])g=a,a=a.right;else{if(d=
e(a.right,b))return d;a=a.left}else{if(b[0]!==d[1][0])return a;if(d=e(a.right,b))return d;a=a.left}}return g}function a(a,b,e,d){this.y=a;this.index=b;this.start=e;this.closed=d}function n(a,b,e,d){this.x=a;this.segment=b;this.create=e;this.index=d}h.exports=function(b){for(var e=b.length,g=2*e,d=Array(g),f=0;f<e;++f){var k=b[f],h=k[0][0]<k[1][0];d[2*f]=new n(k[0][0],k,h,f);d[2*f+1]=new n(k[1][0],k,!h,f)}d.sort(function(a,b){var c=a.x-b.x;return c?c:(c=a.create-b.create)?c:Math.min(a.segment[0][1],
a.segment[1][1])-Math.min(b.segment[0][1],b.segment[1][1])});b=l(v);e=[];k=[];h=[];for(f=0;f<g;){for(var r=d[f].x,q=[];f<g;){var c=d[f];if(c.x!==r)break;f+=1;c.segment[0][0]===c.x&&c.segment[1][0]===c.x?c.create&&(c.segment[0][1]<c.segment[1][1]?(q.push(new a(c.segment[0][1],c.index,!0,!0)),q.push(new a(c.segment[1][1],c.index,!1,!1))):(q.push(new a(c.segment[1][1],c.index,!0,!1)),q.push(new a(c.segment[0][1],c.index,!1,!0)))):b=c.create?b.insert(c.segment,c.index):b.remove(c.segment)}e.push(b.root);
k.push(r);h.push(q)}return new t(e,k,h)};var k=b("binary-search-bounds"),l=b("functional-red-black-tree"),A=b("robust-orientation"),v=b("./lib/order-segments");t.prototype.castUp=function(a){var b=k.le(this.coordinates,a[0]);if(0>b)return-1;var g=e(this.slabs[b],a),d=-1;g&&(d=g.value);if(this.coordinates[b]===a[0]){var f=null;g&&(f=g.key);0<b&&(g=e(this.slabs[b-1],a))&&(f?0<v(g.key,f)&&(f=g.key,d=g.value):(d=g.value,f=g.key));g=this.horizontal[b];if(0<g.length){var h=k.ge(g,a[1],r);if(h<g.length){b=
g[h];if(a[1]===b.y){if(b.closed)return b.index;for(;h<g.length-1&&g[h+1].y===a[1];)if(h+=1,b=g[h],b.closed)return b.index;if(b.y===a[1]&&!b.start){h+=1;if(h>=g.length)return d;b=g[h]}}b.start?f?(a=A(f[0],f[1],[a[0],b.y]),f[0][0]>f[1][0]&&(a=-a),0<a&&(d=b.index)):d=b.index:b.y!==a[1]&&(d=b.index)}}}return d}},{"./lib/order-segments":116,"binary-search-bounds":117,"functional-red-black-tree":79,"robust-orientation":106}],119:[function(b,h,q){function t(a,b){var h=a.length,n=["'use strict';"],q="surfaceNets"+
a.join("_")+"d"+b;n.push("var contour=genContour({","order:[",a.join(),"],","scalarArguments: 3,","phase:function phaseFunc(p,a,b,c) { return (p > c)|0 },");"generic"===b&&n.push("getters:[0],");for(var m=[],g=[],d=0;d<h;++d)m.push("d"+d),g.push("d"+d);for(d=0;d<1<<h;++d)m.push("v"+d),g.push("v"+d);for(d=0;d<1<<h;++d)m.push("p"+d),g.push("p"+d);m.push("a","b","c");g.push("a","c");n.push("vertex:function vertexFunc(",m.join(),"){");m=[];for(d=0;d<1<<h;++d)m.push("(p"+d+"<<"+d+")");n.push("var m=(",
m.join("+"),")|0;if(m===0||m===",(1<<(1<<h))-1,"){return}");var m=[],f=[];128>=1<<(1<<h)?(n.push("switch(m){"),f=n):n.push("switch(m>>>7){");for(d=0;d<1<<(1<<h);++d){128<1<<(1<<h)&&0===d%128&&(0<m.length&&f.push("}}"),f="vExtra"+m.length,n.push("case ",d>>>7,":",f,"(m&0x7f,",g.join(),");break;"),f=["function ",f,"(m,",g.join(),"){switch(m){"],m.push(f));f.push("case ",d&127,":");for(var p=Array(h),t=Array(h),z=Array(h),C=Array(h),c=0,y=0;y<h;++y)p[y]=[],t[y]=[],z[y]=0,C[y]=0;for(y=0;y<1<<h;++y)for(var D=
0;D<h;++D){var B=y^1<<D;if(!(B>y)&&!(d&1<<B)!==!(d&1<<y)){var w=1;d&1<<B?t[D].push("v"+B+"-v"+y):(t[D].push("v"+y+"-v"+B),w=-w);0>w?(p[D].push("-v"+y+"-v"+B),z[D]+=2):(p[D].push("v"+y+"+v"+B),z[D]-=2);c+=1;for(w=0;w<h;++w)w!==D&&(B&1<<w?C[w]+=1:--C[w])}}y=[];for(D=0;D<h;++D)0===p[D].length?y.push("d"+D+"-0.5"):(B="",0>z[D]?B=z[D]+"*c":0<z[D]&&(B="+"+z[D]+"*c"),y.push("d"+D+"-"+(.5+C[D]/c*.5)+"-"+p[D].length/c*.5+"*("+p[D].join("+")+B+")/("+t[D].join("+")+")"));f.push("a.push([",y.join(),"]);","break;")}n.push("}},");
0<m.length&&f.push("}}");g=[];for(d=0;d<1<<h-1;++d)g.push("v"+d);g.push("c0","c1","p0","p1","a","b","c");n.push("cell:function cellFunc(",g.join(),"){");h=e(h-1);n.push("if(p0){b.push(",h.map(function(a){return"["+a.map(function(a){return"v"+a})+"]"}).join(),")}else{b.push(",h.map(function(a){a=a.slice();a.reverse();return"["+a.map(function(a){return"v"+a})+"]"}).join(),")}}});function ",q,"(array,level){var verts=[],cells=[];contour(array,verts,cells,level);return {positions:verts,cells:cells};} return ",
q,";");for(d=0;d<m.length;++d)n.push(m[d].join(""));return(new Function("genContour",n.join("")))(r)}h.exports=function(b,e){if(0>=b.dimension)return{positions:[],cells:[]};if(1===b.dimension){for(var h=a(b,e),q=h.length,r=Array(q),m=Array(q),g=0;g<q;++g)r[g]=[h[g]],m[g]=[g];return{positions:r,cells:m}}h=b.order.join()+"-"+b.dtype;q=n[h];e=+e||0;q||(q=n[h]=t(b.order,b.dtype));return q(b,e)};var r=b("ndarray-extract-contour"),e=b("triangulate-hypercube"),a=b("zero-crossings"),n={}},{"ndarray-extract-contour":91,
"triangulate-hypercube":120,"zero-crossings":129}],120:[function(b,h,q){h.exports=function(a){if(0>a)return[];if(0===a)return[[0]];for(var b=Math.round(e(a+1))|0,k=[],h=0;h<b;++h){for(var q=t.unrank(a,h),v=[0],u=0,m=0;m<q.length;++m)u+=1<<q[m],v.push(u);1>r(q)&&(v[0]=u,v[a]=0);k.push(v)}return k};var t=b("permutation-rank"),r=b("permutation-parity"),e=b("gamma")},{gamma:80,"permutation-parity":94,"permutation-rank":95}],121:[function(b,h,q){h.exports=function(b,e,a){var h=b*e,k=t*b,k=k-(k-b);b-=k;
var l=t*e,l=l-(l-e);e-=l;e=b*e-(h-k*l-b*l-k*e);return a?(a[0]=e,a[1]=h,a):[e,h]};var t=+(Math.pow(2,27)+1)},{}],122:[function(b,h,q){h.exports=function(b,h,e){var a=b+h,n=a-b;h-=n;b-=a-n;return e?(e[0]=b+h,e[1]=a,e):[b+h,a]}},{}],123:[function(b,h,q){(function(h,r){function e(a){if(a){var b=x.log2(a.length||a.byteLength);y[b].push(a)}}function a(a){a=x.nextPow2(a);var b=x.log2(a),b=y[b];return 0<b.length?b.pop():new ArrayBuffer(a)}function n(b){return new Uint8Array(a(b),0,b)}function k(b){return new Uint16Array(a(2*
b),0,b)}function l(b){return new Uint32Array(a(4*b),0,b)}function A(b){return new Int8Array(a(b),0,b)}function v(b){return new Int16Array(a(2*b),0,b)}function u(b){return new Int32Array(a(4*b),0,b)}function m(b){return new Float32Array(a(4*b),0,b)}function g(b){return new Float64Array(a(8*b),0,b)}function d(b){return C?new Uint8ClampedArray(a(b),0,b):n(b)}function f(b){return new DataView(a(b),0,b)}function p(a){a=x.nextPow2(a);var b=x.log2(a),b=D[b];return 0<b.length?b.pop():new r(a)}var x=b("bit-twiddle"),
z=b("dup");h.__TYPEDARRAY_POOL||(h.__TYPEDARRAY_POOL={UINT8:z([32,0]),UINT16:z([32,0]),UINT32:z([32,0]),INT8:z([32,0]),INT16:z([32,0]),INT32:z([32,0]),FLOAT:z([32,0]),DOUBLE:z([32,0]),DATA:z([32,0]),UINT8C:z([32,0]),BUFFER:z([32,0])});var C="undefined"!==typeof Uint8ClampedArray,c=h.__TYPEDARRAY_POOL;c.UINT8C||(c.UINT8C=z([32,0]));c.BUFFER||(c.BUFFER=z([32,0]));var y=c.DATA,D=c.BUFFER;q.free=function(a){if(r.isBuffer(a))D[x.log2(a.length)].push(a);else if("[object ArrayBuffer]"!==Object.prototype.toString.call(a)&&
(a=a.buffer),a){var b=x.log2(a.length||a.byteLength)|0;y[b].push(a)}};q.freeUint8=q.freeUint16=q.freeUint32=q.freeInt8=q.freeInt16=q.freeInt32=q.freeFloat32=q.freeFloat=q.freeFloat64=q.freeDouble=q.freeUint8Clamped=q.freeDataView=function(a){e(a.buffer)};q.freeArrayBuffer=e;q.freeBuffer=function(a){D[x.log2(a.length)].push(a)};q.malloc=function(b,c){if(void 0===c||"arraybuffer"===c)return a(b);switch(c){case "uint8":return n(b);case "uint16":return k(b);case "uint32":return l(b);case "int8":return A(b);
case "int16":return v(b);case "int32":return u(b);case "float":case "float32":return m(b);case "double":case "float64":return g(b);case "uint8_clamped":return d(b);case "buffer":return p(b);case "data":case "dataview":return f(b);default:return null}};q.mallocArrayBuffer=a;q.mallocUint8=n;q.mallocUint16=k;q.mallocUint32=l;q.mallocInt8=A;q.mallocInt16=v;q.mallocInt32=u;q.mallocFloat32=q.mallocFloat=m;q.mallocFloat64=q.mallocDouble=g;q.mallocUint8Clamped=d;q.mallocDataView=f;q.mallocBuffer=p;q.clearCache=
function(){for(var a=0;32>a;++a)c.UINT8[a].length=0,c.UINT16[a].length=0,c.UINT32[a].length=0,c.INT8[a].length=0,c.INT16[a].length=0,c.INT32[a].length=0,c.FLOAT[a].length=0,c.DOUBLE[a].length=0,c.UINT8C[a].length=0,y[a].length=0,D[a].length=0}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{},b("buffer").Buffer)},{"bit-twiddle":54,buffer:62,dup:77}],124:[function(b,h,q){function t(b){this.roots=Array(b);this.ranks=Array(b);for(var e=
0;e<b;++e)this.roots[e]=e,this.ranks[e]=0}"use restrict";h.exports=t;b=t.prototype;Object.defineProperty(b,"length",{get:function(){return this.roots.length}});b.makeSet=function(){var b=this.roots.length;this.roots.push(b);this.ranks.push(0);return b};b.find=function(b){for(var e=b,a=this.roots;a[b]!==b;)b=a[b];for(;a[e]!==b;){var h=a[e];a[e]=b;e=h}return b};b.link=function(b,e){var a=this.find(b),h=this.find(e);if(a!==h){var k=this.ranks,l=this.roots,q=k[a],t=k[h];q<t?l[a]=h:t<q?l[h]=a:(l[h]=a,
++k[a])}}},{}],125:[function(b,h,q){h.exports=function(b,h,e){if(0===b.length)return b;if(h){e||b.sort(h);e=1;for(var a=b.length,n=b[0],k=b[0],l=1;l<a;++l)k=n,n=b[l],h(n,k)&&(l===e?e++:b[e++]=n);b.length=e;return b}e||b.sort();h=1;e=b.length;a=b[0];n=b[0];for(k=1;k<e;++k)n=a,a=b[k],a!==n&&(k===h?h++:b[h++]=a);b.length=h;return b}},{}],126:[function(b,h,q){h.exports=function(a,b){if("object"!==typeof b||null===b)b={};return t(a,b.canvas||r,b.context||e,b)};var t=b("./lib/vtext"),r=null,e=null;"undefined"!==
typeof document&&(r=document.createElement("canvas"),r.width=8192,r.height=1024,e=r.getContext("2d"))},{"./lib/vtext":127}],127:[function(b,h,q){function t(a,b,e){for(var d=b.textAlign||"start",f=b.textBaseline||"alphabetic",h=[1073741824,1073741824],k=[0,0],l=a.length,n=0;n<l;++n)for(var c=a[n],q=0;2>q;++q)h[q]=Math.min(h[q],c[q])|0,k[q]=Math.max(k[q],c[q])|0;var r=0;switch(d){case "center":r=-.5*(h[0]+k[0]);break;case "right":case "end":r=-k[0];break;case "left":case "start":r=-h[0];break;default:throw Error("vectorize-text: Unrecognized textAlign: '"+
d+"'");}var t=0;switch(f){case "hanging":case "top":t=-h[1];break;case "middle":t=-.5*(h[1]+k[1]);break;case "alphabetic":case "ideographic":t=-3*e;break;case "bottom":t=-k[1];break;default:throw Error("vectorize-text: Unrecoginized textBaseline: '"+f+"'");}var v=1/e;"lineHeight"in b?v*=+b.lineHeight:"width"in b?v=b.width/(k[0]-h[0]):"height"in b&&(v=b.height/(k[1]-h[1]));return a.map(function(a){return[v*(a[0]+r),v*(a[1]+t)]})}function r(b,e,g,d){b=a(b,128);d=d?k(b.cells,b.positions,.25):{edges:b.cells,
positions:b.positions};g=t(d.positions,e,g);b=d.edges;d="ccw"===e.orientation;l(g,b);if(e.polygons||e.polygon||e.polyline){e=v(b,g);b=Array(e.length);for(var f=0;f<e.length;++f){for(var h=e[f],n=Array(h.length),q=0;q<h.length;++q){for(var r=h[q],c=Array(r.length),y=0;y<r.length;++y)c[y]=g[r[y]].slice();d&&c.reverse();n[q]=c}b[f]=n}return b}return e.triangles||e.triangulate||e.triangle?{cells:A(g,b,{delaunay:!1,exterior:!1,interior:!0}),positions:g}:{edges:b,positions:g}}function e(a,b,e){try{return r(a,
b,e,!0)}catch(d){}try{return r(a,b,e,!1)}catch(d){}return b.polygons||b.polyline||b.polygon?[]:b.triangles||b.triangulate||b.triangle?{cells:[],positions:[]}:{edges:[],positions:[]}}h.exports=function(a,b,g,d){var f=d.size||64;g.font=f+"px "+(d.font||"normal");g.textAlign="start";g.textBaseline="alphabetic";g.direction="ltr";var h;h=Math.ceil(g.measureText(a).width+2*f)|0;if(8192<h)throw Error("vectorize-text: String too long (sorry, this will get fixed later)");var k=3*f;b.height<k&&(b.height=k);
g.fillStyle="#000";g.fillRect(0,0,b.width,b.height);g.fillStyle="#fff";g.fillText(a,f,2*f);a=g.getImageData(0,0,h,k);h=n(a.data,[k,h,4]).pick(-1,-1,0).transpose(1,0);return e(h,d,f)};h.exports.processPixels=e;var a=b("surface-nets"),n=b("ndarray"),k=b("simplify-planar-graph"),l=b("clean-pslg"),A=b("cdt2d"),v=b("planar-graph-to-polyline")},{cdt2d:63,"clean-pslg":68,ndarray:92,"planar-graph-to-polyline":98,"simplify-planar-graph":115,"surface-nets":119}],128:[function(b,h,q){h.exports=b("cwise-compiler")({args:["array",
{offset:[1],array:0},"scalar","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{\n        var _inline_1_da = _inline_1_arg0_ - _inline_1_arg3_\n        var _inline_1_db = _inline_1_arg1_ - _inline_1_arg3_\n        if((_inline_1_da >= 0) !== (_inline_1_db >= 0)) {\n          _inline_1_arg2_.push(_inline_1_arg4_[0] + 0.5 + 0.5 * (_inline_1_da + _inline_1_db) / (_inline_1_da - _inline_1_db))\n        }\n      }",args:[{name:"_inline_1_arg0_",
lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg2_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg3_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg4_",lvalue:!1,rvalue:!0,count:1}],thisVars:[],localVars:["_inline_1_da","_inline_1_db"]},funcName:"zeroCrossings"})},{"cwise-compiler":73}],129:[function(b,h,q){h.exports=function(b,e){var a=[];e=+e||0;t(b.hi(b.shape[0]-1),a,e);return a};var t=b("./lib/zc-core")},{"./lib/zc-core":128}],130:[function(b,
h,q){function t(a,b){for(var c=0;c<a.length;++c)if(a[c]===b)return c;return-1}var r=b("./lib/util/check"),e=b("./lib/util/extend"),a=b("./lib/dynamic"),n=b("./lib/util/raf"),k=b("./lib/util/clock"),l=b("./lib/strings"),A=b("./lib/webgl"),v=b("./lib/extension"),u=b("./lib/limits"),m=b("./lib/buffer"),g=b("./lib/elements"),d=b("./lib/texture"),f=b("./lib/renderbuffer"),p=b("./lib/framebuffer"),x=b("./lib/attribute"),z=b("./lib/shader"),C=b("./lib/read"),c=b("./lib/core"),y=b("./lib/stats"),D=b("./lib/timer");
h.exports=function(b){function h(){if(0===V.length)P&&P.update(),ka=null;else{ka=n.next(h);L();for(var a=V.length-1;0<=a;--a){var b=V[a];b&&b(Y,null,0)}I.flush();P&&P.update()}}function q(){!ka&&0<V.length&&(ka=n.next(h))}function N(){ka&&(n.cancel(h),ka=null)}function G(a){a.preventDefault();Z=!0;N();fa.forEach(function(a){a()})}function F(a){I.getError();Z=!1;aa.restore();na.restore();la.restore();oa.restore();sa.restore();ca.restore();P&&P.restore();ea.procs.refresh();q();ia.forEach(function(a){a()})}
function R(b){function c(b){var d={},e={};Object.keys(b).forEach(function(c){var f=b[c];a.isDynamic(f)?e[c]=a.unbox(f,c):d[c]=f});return{dynamic:e,"static":d}}function d(a){for(;p.length<a;)p.push(null);return p}r(!!b,"invalid args to regl({...})");r.type(b,"object","invalid args to regl({...})");var f=c(b.context||{}),g=c(b.uniforms||{}),h=c(b.attributes||{}),k=c(function(a){function b(a){if(a in c){var d=c[a];delete c[a];Object.keys(d).forEach(function(b){c[a+"."+b]=d[b]})}}var c=e({},a);delete c.uniforms;
delete c.attributes;delete c.context;"stencil"in c&&c.stencil.op&&(c.stencil.opBack=c.stencil.opFront=c.stencil.op,delete c.stencil.op);b("blend");b("depth");b("cull");b("stencil");b("polygonOffset");b("scissor");b("sample");return c}(b));b={gpuTime:0,cpuTime:0,count:0};var f=ea.compile(k,h,g,f,b),l=f.draw,m=f.batch,n=f.scope,p=[];return e(function(a,b){var c;Z&&r.raise("context lost");if("function"===typeof a)return n.call(this,null,a,0);if("function"===typeof b)if("number"===typeof a)for(c=0;c<
a;++c)n.call(this,null,b,c);else if(Array.isArray(a))for(c=0;c<a.length;++c)n.call(this,a[c],b,c);else return n.call(this,a,b,0);else if("number"===typeof a){if(0<a)return m.call(this,d(a|0),a|0)}else if(Array.isArray(a)){if(a.length)return m.call(this,a,a.length)}else return l.call(this,a)},{stats:b})}function M(a,b){var c=0;ea.procs.poll();var d=b.color;d&&(I.clearColor(+d[0]||0,+d[1]||0,+d[2]||0,+d[3]||0),c|=16384);"depth"in b&&(I.clearDepth(+b.depth),c|=256);"stencil"in b&&(I.clearStencil(b.stencil|
0),c|=1024);r(!!c,"called regl.clear with no buffer specified");I.clear(c)}function K(a){r.type(a,"function","regl.frame() callback must be a function");V.push(a);q();return{cancel:function(){function b(){var a=t(V,b);V[a]=V[V.length-1];--V.length;0>=V.length&&N()}var c=t(V,a);r(0<=c,"cannot cancel a frame twice");V[c]=b}}}function J(){var a=ja.viewport,b=ja.scissor_box;a[0]=a[1]=b[0]=b[1]=0;Y.viewportWidth=Y.framebufferWidth=Y.drawingBufferWidth=a[2]=b[2]=I.drawingBufferWidth;Y.viewportHeight=Y.framebufferHeight=
Y.drawingBufferHeight=a[3]=b[3]=I.drawingBufferHeight}function L(){Y.tick+=1;Y.time=Q();J();ea.procs.poll()}function H(){J();ea.procs.refresh();P&&P.update()}function Q(){return(k()-W)/1E3}b=A(b);if(!b)return null;var I=b.gl,U=I.getContextAttributes(),Z=I.isContextLost(),aa=v(I,b);if(!aa)return null;var X=l(),T=y(),O=aa.extensions,P=D(I,O),W=k(),S=I.drawingBufferWidth,da=I.drawingBufferHeight,Y={tick:0,time:0,viewportWidth:S,viewportHeight:da,framebufferWidth:S,framebufferHeight:da,drawingBufferWidth:S,
drawingBufferHeight:da,pixelRatio:b.pixelRatio},ha=u(I,O),la=m(I,T,b),ma=g(I,O,la,T),S=x(I,O,ha,la,X),na=z(I,X,T,b),oa=d(I,O,ha,function(){ea.procs.poll()},Y,T,b),sa=f(I,O,ha,T,b),ca=p(I,O,ha,oa,sa,T),ea=c(I,X,O,ha,la,ma,oa,ca,{},S,na,{elements:null,primitive:4,count:-1,offset:0,instances:-1},Y,P,b),X=C(I,ca,ea.procs.poll,Y,U,O),ja=ea.next,ba=I.canvas,V=[],fa=[],ia=[],ta=[b.onDestroy],ka=null;ba&&(ba.addEventListener("webglcontextlost",G,!1),ba.addEventListener("webglcontextrestored",F,!1));var qa=
ca.setFBO=R({framebuffer:a.define.call(null,1,"framebuffer")});H();U=e(R,{clear:function(a){r("object"===typeof a&&a,"regl.clear() takes an object as input");if("framebuffer"in a)if(a.framebuffer&&"framebufferCube"===a.framebuffer_reglType)for(var b=0;6>b;++b)qa(e({framebuffer:a.framebuffer.faces[b]},a),M);else qa(a,M);else M(null,a)},prop:a.define.bind(null,1),context:a.define.bind(null,2),"this":a.define.bind(null,3),draw:R({}),buffer:function(a){return la.create(a,34962,!1,!1)},elements:function(a){return ma.create(a,
!1)},texture:oa.create2D,cube:oa.createCube,renderbuffer:sa.create,framebuffer:ca.create,framebufferCube:ca.createCube,attributes:U,frame:K,on:function(a,b){r.type(b,"function","listener callback must be a function");var c;switch(a){case "frame":return K(b);case "lost":c=fa;break;case "restore":c=ia;break;case "destroy":c=ta;break;default:r.raise("invalid event, must be one of frame,lost,restore,destroy")}c.push(b);return{cancel:function(){for(var a=0;a<c.length;++a)if(c[a]===b){c[a]=c[c.length-1];
c.pop();break}}}},limits:ha,hasExtension:function(a){return 0<=ha.extensions.indexOf(a.toLowerCase())},read:X,destroy:function(){V.length=0;N();ba&&(ba.removeEventListener("webglcontextlost",G),ba.removeEventListener("webglcontextrestored",F));na.clear();ca.clear();sa.clear();oa.clear();ma.clear();la.clear();P&&P.clear();ta.forEach(function(a){a()})},_gl:I,_refresh:H,poll:function(){L();P&&P.update()},now:Q,stats:T});b.onDone(null,U);return U}},{"./lib/attribute":2,"./lib/buffer":3,"./lib/core":8,
"./lib/dynamic":9,"./lib/elements":10,"./lib/extension":11,"./lib/framebuffer":12,"./lib/limits":13,"./lib/read":14,"./lib/renderbuffer":15,"./lib/shader":16,"./lib/stats":17,"./lib/strings":18,"./lib/texture":19,"./lib/timer":20,"./lib/util/check":21,"./lib/util/clock":22,"./lib/util/extend":24,"./lib/util/raf":31,"./lib/webgl":34}]},{},[1]);
